!function(a,b){"use strict";function c(){function a(a,c){return b.extend(Object.create(a),c)}function c(a,b){var c=b.caseInsensitiveMatch,d={originalPath:a,regexp:a},e=d.keys=[];return a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(a,b,c,d){var f="?"===d?d:null,g="*"===d?d:null;return e.push({name:c,optional:!!f}),b=b||"",""+(f?"":b)+"(?:"+(f?b:"")+(g&&"(.+?)"||"([^/]+)")+(f||"")+")"+(f||"")}).replace(/([\/$\*])/g,"\\$1"),d.regexp=new RegExp("^"+a+"$",c?"i":""),d}var d={};this.when=function(a,e){var f=b.copy(e);if(b.isUndefined(f.reloadOnSearch)&&(f.reloadOnSearch=!0),b.isUndefined(f.caseInsensitiveMatch)&&(f.caseInsensitiveMatch=this.caseInsensitiveMatch),d[a]=b.extend(f,a&&c(a,f)),a){var g="/"==a[a.length-1]?a.substr(0,a.length-1):a+"/";d[g]=b.extend({redirectTo:a},c(g,f))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(a){return"string"==typeof a&&(a={redirectTo:a}),this.when(null,a),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function(c,e,f,g,i,j,k){function l(a,b){var c=b.keys,d={};if(!b.regexp)return null;var e=b.regexp.exec(a);if(!e)return null;for(var f=1,g=e.length;g>f;++f){var h=c[f-1],i=e[f];h&&i&&(d[h.name]=i)}return d}function m(a){var d=t.current;q=o(),r=q&&d&&q.$$route===d.$$route&&b.equals(q.pathParams,d.pathParams)&&!q.reloadOnSearch&&!s,r||!d&&!q||c.$broadcast("$routeChangeStart",q,d).defaultPrevented&&a&&a.preventDefault()}function n(){var a=t.current,d=q;r?(a.params=d.params,b.copy(a.params,f),c.$broadcast("$routeUpdate",a)):(d||a)&&(s=!1,t.current=d,d&&d.redirectTo&&(b.isString(d.redirectTo)?e.path(p(d.redirectTo,d.params)).search(d.params).replace():e.url(d.redirectTo(d.pathParams,e.path(),e.search())).replace()),g.when(d).then(function(){if(d){var a,c,e=b.extend({},d.resolve);return b.forEach(e,function(a,c){e[c]=b.isString(a)?i.get(a):i.invoke(a,null,null,c)}),b.isDefined(a=d.template)?b.isFunction(a)&&(a=a(d.params)):b.isDefined(c=d.templateUrl)&&(b.isFunction(c)&&(c=c(d.params)),b.isDefined(c)&&(d.loadedTemplateUrl=k.valueOf(c),a=j(c))),b.isDefined(a)&&(e.$template=a),g.all(e)}}).then(function(e){d==t.current&&(d&&(d.locals=e,b.copy(d.params,f)),c.$broadcast("$routeChangeSuccess",d,a))},function(b){d==t.current&&c.$broadcast("$routeChangeError",d,a,b)}))}function o(){var c,f;return b.forEach(d,function(d){!f&&(c=l(e.path(),d))&&(f=a(d,{params:b.extend({},e.search(),c),pathParams:c}),f.$$route=d)}),f||d[null]&&a(d[null],{params:{},pathParams:{}})}function p(a,c){var d=[];return b.forEach((a||"").split(":"),function(a,b){if(0===b)d.push(a);else{var e=a.match(/(\w+)(?:[?*])?(.*)/),f=e[1];d.push(c[f]),d.push(e[2]||""),delete c[f]}}),d.join("")}var q,r,s=!1,t={routes:d,reload:function(){s=!0,c.$evalAsync(function(){m(),n()})},updateParams:function(a){if(!this.current||!this.current.$$route)throw h("norout","Tried updating route when with no current route");a=b.extend({},this.current.params,a),e.path(p(this.current.$$route.originalPath,a)),e.search(a)}};return c.$on("$locationChangeStart",m),c.$on("$locationChangeSuccess",n),t}]}function d(){this.$get=function(){return{}}}function e(a,c,d){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(e,f,g,h,i){function j(){n&&(d.cancel(n),n=null),l&&(l.$destroy(),l=null),m&&(n=d.leave(m),n.then(function(){n=null}),m=null)}function k(){var g=a.current&&a.current.locals,h=g&&g.$template;if(b.isDefined(h)){var k=e.$new(),n=a.current,q=i(k,function(a){d.enter(a,null,m||f).then(function(){!b.isDefined(o)||o&&!e.$eval(o)||c()}),j()});m=q,l=n.scope=k,l.$emit("$viewContentLoaded"),l.$eval(p)}else j()}var l,m,n,o=g.autoscroll,p=g.onload||"";e.$on("$routeChangeSuccess",k),k()}}}function f(a,b,c){return{restrict:"ECA",priority:-400,link:function(d,e){var f=c.current,g=f.locals;e.html(g.$template);var h=a(e.contents());if(f.controller){g.$scope=d;var i=b(f.controller,g);f.controllerAs&&(d[f.controllerAs]=i),e.data("$ngControllerController",i),e.children().data("$ngControllerController",i)}h(d)}}}var g=b.module("ngRoute",["ng"]).provider("$route",c),h=b.$$minErr("ngRoute");g.provider("$routeParams",d),g.directive("ngView",e),g.directive("ngView",f),e.$inject=["$route","$anchorScroll","$animate"],f.$inject=["$compile","$controller","$route"]}(window,window.angular),angular.module("wix",[]),angular.module("wix").factory("$wix",["$location",function(a){var b=a.absUrl();return Wix.Utils.getInstance=function(){var a=/.*instance=([\[\]a-zA-Z0-9\.\-_]*?)(&|$|#).*/g,c=a.exec(b);return c&&c[1]?c[1]:void 0},Wix}]),angular.module("wix").factory("buttonSizeService",["defaultWidgetSizes",function(a){function b(b,c){var d=a[b][c];f.frameH=d.frameH,f.frameW=d.frameW+1,f.iconH=d.iconH,f.iconW=d.iconW,f.top=d.top,f.bottom=d.bottom}function c(a,b){f.marginBorders="icon-text"===a?b:0}function d(a){var b=document.getElementById("test").clientWidth+2;b+2*g>f.frameW&&"icon"!==a&&(f.frameW=b+2*g)}function e(a){var b=document.getElementById("test").clientHeight;"icon-text"===a&&(b+=f.iconH,b+=f.top,b+=f.bottom,b+=8),b>f.frameH&&"icon"!==a&&(f.frameH=b)}var f={},g=3,h=function(a){return b(a.size,a.iconStyle),c(a.iconStyle,a.borderWidth),d(a.iconStyle),e(a.iconStyle),f};return{getSizes:h,defaultMargins:g}}]),angular.module("wix").factory("debounce",["$timeout","$q",function(a,b){return function(c,d,e){var f,g=b.defer();return function(){var h=this,i=arguments,j=function(){f=null,e||(g.resolve(c.apply(h,i)),g=b.defer())},k=e&&!f;return f&&a.cancel(f),f=a(j,d),k&&(g.resolve(c.apply(h,i)),g=b.defer()),g.promise}}}]),angular.module("wix").factory("settingsService",["$http","$location","$timeout","$q","$wix",function(a,b,c,d,e){var f=null,g="localhost"!==b.host()?b.host():"localhost:8080";return g=b.protocol()+"://"+g,{getSettings:function(b,c){return a.get(g+"/load?instance="+e.Utils.getInstance()+"&isSite="+c+"&compId="+b)},saveSettings:function(b,h,i,j){var k=d.defer();return f&&c.cancel(f),f=c(function(){a.post(g+"/save?instance="+e.Utils.getInstance()+"&isSite="+i,{compId:h,settings:b}).then(k.resolve,k.reject),f=null},j),k.promise}}}]),angular.module("wix").factory("buttonTexts",function(){function a(a){var d=c[Wix.Utils.getLocale()]?c[Wix.Utils.getLocale()]:c[b];return"defaultText"===a?d:a}var b="en",c={da:"Øverst",de:"Oben",en:"Top",es:"Arriba",fr:"Haut",it:"Inizio",ja:"トップ",ko:"Top",nl:"Boven",no:"Øverst",pl:"Góra",pt:"Topo",ru:"Наверх",sv:"Top",tr:"Üst"};return{getText:a}}),angular.module("wix").directive("backToTop",["$wix","easingFunctions","scrollingTime","frameCount",function(a,b,c,d){return{restrict:"A",link:function(e,f){var g=function(){a.getBoundingRectAndOffsets(function(f){var g,h,i=0;g="site"===a.Utils.getViewMode()?f.offsets.y-f.rect.top:f.offsets.y,0!==g&&(h=function j(){if(0===i&&"site"===a.Utils.getViewMode())e.scrollingUp=!0,e.hideButton(400);else if(i>d-1)return void(e.scrollingUp=!1);i++,a.scrollTo(0,g-b.easeOutQuart(i/d)*g),setTimeout(j,c/d)},setTimeout(h,0))})};f.bind("click",g)}}}]),angular.module("wixApp",["ngRoute","wix"]).constant("defaultFont","normal normal normal normal 16px/normal 'Times New Roman'").constant("scrollingTime",500).constant("frameCount",24).constant("defaultWidgetSizes",{small:{icon:{frameH:52,frameW:52,iconH:30,iconW:25},text:{frameH:37,frameW:53},"icon-text":{frameH:74,frameW:53,iconH:30,iconW:25,top:11,bottom:13}},medium:{icon:{frameH:68,frameW:68,iconH:39,iconW:32},text:{frameH:44,frameW:68},"icon-text":{frameH:89,frameW:68,iconH:39,iconW:32,top:15,bottom:13}},large:{icon:{frameH:82,frameW:82,iconH:47,iconW:39},text:{frameH:52,frameW:82},"icon-text":{frameH:104,frameW:82,iconH:47,iconW:39,top:18,bottom:12}}}).constant("easingFunctions",{linear:function(a){return a},easeInQuad:function(a){return a*a},easeOutQuad:function(a){return a*(2-a)},easeInOutQuad:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},easeInCubic:function(a){return a*a*a},easeOutCubic:function(a){return--a*a*a+1},easeInOutCubic:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},easeInQuart:function(a){return a*a*a*a},easeOutQuart:function(a){return 1- --a*a*a*a},easeInOutQuart:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},easeInQuint:function(a){return a*a*a*a*a},easeOutQuint:function(a){return 1+--a*a*a*a*a},easeInOutQuint:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}}).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/app.html",controller:"MainCtrl",resolve:{settings:["settingsService","$wix",function(a,b){var c="site"===b.Utils.getViewMode();return a.getSettings(b.Utils.getCompId(),c.toString()).then(function(a){return a.data})}]}}).otherwise({redirectTo:"/"})}]),angular.module("wixApp").controller("MainCtrl",["$scope","$wix","$timeout","settingsService","buttonSizeService","buttonTexts","debounce","settings",function(a,b,c,d,e,f,g,h){function i(){j(),k(),l(),m(),o(),p()}function j(){a.iconImageSrc=a.params.iconImage?"views/icons/"+a.params.iconImage+".html":"views/icons/icon1.html"}function k(){a.text=f.getText(a.params.text)}function l(){c(function(){a.sizes=e.getSizes(a.params),b.resizeWindow(a.sizes.frameW+2*a.params.borderWidth,a.sizes.frameH+2*a.params.borderWidth)})}function m(){"site"===b.Utils.getViewMode()&&b.getCurrentPageId(function(b){-1===a.params.selectedPages.indexOf(b)&&-1===a.params.selectedPages.indexOf("all")?(a.buttonIsVisible=!1,n()):a.hideButton(0)})}function n(){b.resizeWindow(1,1)}function o(){a.inactive="editor"===b.Utils.getViewMode()?-1===a.params.selectedPages.indexOf("all")&&-1===a.params.selectedPages.indexOf(y):!1}function p(){b.addEventListener(b.Events.SETTINGS_UPDATED,q),b.addEventListener(b.Events.SITE_PUBLISHED,r),"site"===b.Utils.getViewMode()&&b.addEventListener(b.Events.SCROLL,s),b.addEventListener(b.Events.STYLE_PARAMS_CHANGE,t),b.addEventListener(b.Events.EDIT_MODE_CHANGE,u),b.addEventListener(b.Events.PAGE_NAVIGATION,v)}function q(b){a.$apply(function(){var c=Object.keys(b)[0];a.params[c]=b[c],j(),k(),l(),o()})}function r(){d.saveSettings(a.params,b.Utils.getCompId(),"true",0)}function s(b){!a.scrollingUp&&a.buttonIsVisible&&(b.scrollTop>200?a.showButton():a.hideButton(400))}function t(){c(function(){l()},200)}function u(b){a.$apply(function(){a.buttonIsVisible="editor"===b.editMode?!0:-1!==a.params.selectedPages.indexOf("all")||-1!==a.params.selectedPages.indexOf(y),w(),o()})}function v(c){var d=b.Utils.getViewMode();y=c.toPage,a.$apply(function(){"editor"===d?o():(a.buttonIsVisible=-1!==a.params.selectedPages.indexOf("all")||-1!==a.params.selectedPages.indexOf(c.toPage),w(),"site"===d&&a.hideButton(0))})}function w(){a.buttonIsVisible?l():n()}a.params=h,a.buttonIsVisible=!0,a.scrollingUp=!1,a.defaultMargins=e.defaultMargins;var x,y="mainPage";a.showButton=function(){x?(x(),angular.element("#main").fadeIn(400)):x=g(l,50,!1)},a.hideButton=function(a){angular.element("#main").fadeOut(a,n)},i()}]);