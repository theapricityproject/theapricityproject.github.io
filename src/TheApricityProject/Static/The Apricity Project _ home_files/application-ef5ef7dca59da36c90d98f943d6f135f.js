function select_all(obj){var text_val=eval(obj);text_val.focus(),text_val.select()}function setDefault(e,t){return"undefined"==typeof e||null==e||""===e?t:e}function loadFonts(e){var t=["Courier New","Georgia","Palatino Linotype","Times New Roman","Arial","Arial Black","Comic Sans","Tahoma","Verdana","Lucida Sans Unicode","Lucida Console","Comic sans ms","Impact"],i=[];for(a in e)0!=e[a].length&&-1==$.inArray(e[a],t)&&-1==e[a].search(",")&&i.push(e[a]);for(e=i,a=0;a<e.length;a++)e[a]=replaceAll("-"," ",e[a]);"undefined"==typeof ALL_FONTS&&(ALL_FONTS=[]);var n=!1;for(var a in e){var r=e[a];-1==$.inArray(r,ALL_FONTS)&&(ALL_FONTS.push(r),n=!0)}0!=n&&"undefined"!=typeof WebFont&&(debug("Calling webfont for fonts: ",e),WebFont.load({google:{families:e}}))}function replaceAll(e,t,i){return"undefined"==typeof i?i:i.replace(new RegExp(e,"g"),t)}function ajaxController(e,t){var i=this;i.url=e.url,i.data=e.data,"undefined"!=typeof e.errorsElement&&(i.errorsElement=e.errorsElement,i.err=new errorHandler(i.errorsElement),i.err.clearErrors()),"undefined"!=typeof e.buttonElement&&(i.buttonElement=e.buttonElement,i.buttonElement.toggleButton()),"undefined"!=typeof e.successElement&&(i.successElement=e.successElement,i.successElement.fadeOut("fast")),i.type="undefined"==typeof e.type?"POST":e.type,i.flashSuccess="undefined"==typeof e.flashSuccess?!0:e.flashSuccess;var n=$.ajax({url:i.url,type:i.type,data:i.data,beforeSend:e.skipCSRF?function(){}:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},dataType:"json"});n.done(function(e){if(debug("Ajax Response:",e),1==e.success)"undefined"!=typeof i.successElement&&(i.successElement.fadeIn("fast"),i.flashSuccess&&setTimeout(function(){i.successElement.fadeOut("fast")},2e3));else if("undefined"!=typeof i.errorsElement&&"undefined"!=typeof e.errors&&e.errors.length>0){for(var n=0;n<e.errors.length;n++)i.err.addError(e.errors[n]);i.err.displayErrors()}"undefined"!=typeof i.buttonElement&&i.buttonElement.toggleButton(),"undefined"!=typeof t&&t(e)}),n.fail(function(){if("undefined"!=typeof i.errorsElement&&(i.err.addError('Difficulty contacting server. Please try again or contact <a href="mailto:support@powr.io"><u>support</u></a>'),i.err.displayErrors()),"undefined"!=typeof i.buttonElement&&i.buttonElement.toggleButton(),"undefined"!=typeof t){var e={success:!1};t(e)}})}function errorHandler(e){var t=this;t.errors=[],t.element=e,t.addError=function(e){t.errors.push(e)},t.displayErrors=function(){if(t.errors.length>0){text="",text+="<ul>";for(var e=0;e<t.errors.length;e++)text+="<li>"+t.errors[e]+"</li>";text+="</ul>",t.element.html(text),t.element.fadeIn("slow")}},t.clearErrors=function(){t.errors=[],t.element.hide().html("")}}function flashMessage(e,t){t=setDefault(t,3e3),e.fadeIn("fast"),setTimeout(function(){e.fadeOut("fast")},t)}function htmlSafe(e){return e=replaceAll("'","&#x27;",e),e=replaceAll('"',"&quot;",e)}function unHtmlSafe(e){return e=replaceAll("&#x27;","'",e),e=replaceAll("&quot;",'"',e)}function convertSecondsToComponents(e){var t=e,i=Math.max(0,Math.floor(t/86400));t-=86400*i;var n=Math.max(0,Math.floor(t/3600));t-=3600*n;var a=Math.max(0,Math.floor(t/60));return t=Math.max(0,t-60*a),{days:i,hours:n,minutes:a,seconds:t}}function flashSale(){$("#userNotification").modal()}function debug(){if(!("undefined"!=typeof ENVIRONMENT&&"production"!=ENVIRONMENT||"undefined"!=typeof APP_MODEL&&1615711==APP_MODEL.meta.id))return!1;for(var e=0;e<arguments.length;e++)window.console&&console.log(arguments[e])}function imageThumbUrl(e){var t=["large","medium","original"],i=e;for(var n in t)i=i.replace("/"+t[n]+"/","/thumb/");return i}function imageUrl(e,t){var i=["thumb","large","medium","original"],n=e;for(var a in i)n=n.replace("/"+i[a]+"/","/"+t+"/");return n}function baseUri(){var e=document.location;return e.protocol+"//"+e.host}function nodeUri(){var e=ENVIRONMENT;switch(e){case"development":return"http://localhost:3001";case"staging":return"https://powr-outlet-staging.herokuapp.com";case"production":return"https://powr-outlet.herokuapp.com"}return"https://powr-outlet-staging.herokuapp.com"}function counterUri(){var e=ENVIRONMENT;switch(e){case"development":return"http://localhost:4567";case"staging":return"https://powr-counter.herokuapp.com";case"production":return"https://powr-counter.herokuapp.com"}}function cloudfrontNodeUri(){var e=ENVIRONMENT;switch(e){case"development":return nodeUri();case"staging":return"";case"production":return""}return"https://powr-outlet-staging.herokuapp.com"}function validateUrl(e){var t=e.find(".urlValidationError"),i=e.find("input"),n=i.val(),a=/^http([s]?):\/\/.*/;a.test(n)===!0||0==n.length?(t.hide(),debug("Url is valid")):(t.html("Url is not valid!").fadeIn(),debug("Url is not valid"))}function parseVideo(e){var t=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/,i=e.match(t);return i&&11==i[2].length?{valid:!0,type:"youtube",id:i[2]}:(t=/http(s)?:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/,i=e.match(t),i?{valid:!0,type:"vimeo",id:i[3]}:{valid:!1})}function urlFormat(e){return e=$.trim(e),e.match(/^http([s]?):\/\/.*/)||e.match(/^mailto:.*/)||e.match(/^tel:.*/)?e:"http://"+e}function isValidUrl(e){return/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}function collapse(e,t,i){var n=parseInt(APP_MODEL.get("pluginWidth")),a=parseInt($("#appView").outerWidth());return e>n||e>a?i:t}function testStringWidth(e,t,i){var n=t+"px "+i,a=$("<div>"+e+"</div>").css({position:"absolute","float":"left","white-space":"nowrap",visibility:"hidden",font:n}).appendTo($("body")),r=a.width();return a.remove(),r}function fitText(e){e.each(function(){var e=$(this).data("orig-font-size");if(void 0==e){var e=parseInt($(this).css("fontSize"));$(this).data("orig-font-size",e)}var t=0,i=parseInt($(this).data("fit-text-width"));t=i?i:$(this).parents(".fitTextParent").length>0?$(this).parents(".fitTextParent").width():$(this).parent().width();var n=$(this).css("fontFamily"),a=$(this).text();if($(this).find("br").length>0){var r=$(this).clone();r.find("br").replaceWith(" "),a=r.text()}var o=$.trim(a);"undefined"==typeof LONGEST_WORDS&&(LONGEST_WORDS={}),null==LONGEST_WORDS[n]&&(LONGEST_WORDS[n]={}),"undefined"==typeof TOO_LONG_WORDS&&(TOO_LONG_WORDS={}),null==TOO_LONG_WORDS[n]&&(TOO_LONG_WORDS[n]={});var s="",l=TOO_LONG_WORDS[n].hasOwnProperty(o)||!1;if(null==LONGEST_WORDS[n][o]){for(var c=o.split(/\s/),d=[],u=0,f=25,p=0;p<c.length;p++)c[p].length>=s.length-5?(c[p].length>s.length&&c[p].length<f&&(s=c[p]),d.push(c[p])):c[p].length>=f&&(l=!0,(!TOO_LONG_WORDS[n].hasOwnProperty(o)||TOO_LONG_WORDS[n][o].length<c[p].length)&&(TOO_LONG_WORDS[n][o]=c[p]));for(var p=0;p<d.length;p++)if(d[p].length>=s.length-5&&d[p].length<f){var h=computeWidth(d[p],100,n);h>u&&(s=d[p],u=h)}else d[p].length>=f&&(l=!0,TOO_LONG_WORDS[n][o]=TOO_LONG_WORDS[n][o]||d[p]);LONGEST_WORDS[n][o]=s}else s=LONGEST_WORDS[n][o];$(this).hasClass("fitTextNoWrap")&&(s=" "+o+" ");var m=computeMaxFontSize(s,t,n);if(l){var g=computeWidth(TOO_LONG_WORDS[n][o],Math.min(m,parseInt(e)),n);l=g>=t}var v="inline-block"==$(this).css("display")||"block"==$(this).css("display"),y=l?{"-ms-word-break":"break-all","word-wrap":"break-word","word-break":v?"":"break-all","-webkit-hyphens":"auto","-moz-hyphens":"auto",hyphens:"auto"}:{};m<parseInt(e)?($(this).css($.extend({},{fontSize:m+"px"},y)),$(this).children().css($.extend({},{fontSize:m+"px"},y))):($(this).css($.extend({},{fontSize:e+"px"},y)),$(this).children().css($.extend({},{fontSize:e+"px"},y)))})}function computeMaxFontSize(e,t,i){"undefined"==typeof FONT_WIDTHS&&(FONT_WIDTHS={}),void 0==FONT_WIDTHS[i]&&(FONT_WIDTHS[i]={});var n=computeWidth(e,100,i),a=Math.floor(t/(FONT_FUDGE_FACTOR*n));return a>100&&(a=100),a}function computeWidth(e,t,i){return 55*e.length*FONT_FUDGE_FACTOR*t}function isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:!1}function isMobileSafari(){return navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/)}function isWebview(){var e=window.navigator.userAgent.toLowerCase(),t=/safari/.test(e),i=/iphone|ipod|ipad/.test(e),n=/version/.test(e);return i&&!t||i&&t&&n?!0:!1}function supportedVideoFormats(){if(window.SUPPORTED_VIDEO_FORMATS)return window.SUPPORTED_VIDEO_FORMATS;var e=document.createElement("video"),t={mpeg4:!1,h264:!1,ogg:!1,webm:!1};return e.canPlayType&&(t.mpeg4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=""!==e.canPlayType('video/webm; codecs="vp8, vorbis"')),window.SUPPORTED_VIDEO_FORMATS=t,t}function stripHTML(e){return e.replace(/<(?:.|\n)*?>/gm,"")}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function analyticsEvent(e,t,i){_gaq.push(["powr._trackEvent",e,t,i])}function parseQuery(e){if(""==e)return{};e=e.split("&");for(var t={},i=0;i<e.length;++i){var n=e[i].split("=",2);t[n[0]]=1==n.length?"":decodeURIComponent(n[1].replace(/\+/g," "))}return t}function getCookie(e){var t,i,n,a=document.cookie.split(";");for(t=0;t<a.length;t++)if(i=a[t].substr(0,a[t].indexOf("=")),n=a[t].substr(a[t].indexOf("=")+1),i=i.replace(/^\s+|\s+$/g,""),i==e)return unescape(n)}function isEmpty(e){return"number"==typeof e?!1:_.isEmpty(e)}function setCookie(e,t,i){var n=new Date;n.setDate(n.getDate()+i);var a=escape(t)+(null==i?"":"; expires="+n.toUTCString());document.cookie=e+"="+a}function originalQuery(){return document.location.search.replace("?","")}function getURLParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function pluginIcon(e){return"https://s3-us-west-1.amazonaws.com/powr/plugins/"+e+"/318x318.jpg"}function truncate(e,t){return e.length>t?e.substring(0,t-3)+"...":e}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function replaceAffiliates(){var e={"1&1":"//ad2.adfarm1.adition.com/click?sid=2570306&clickurl=http://www.1and1.com/?ac=OM.US.US469K02463T2103a",godaddy:"//www.godaddy.com/tlds/gtld.aspx?isc=cjcgtld&utm_campaign=affiliates_cjgtld_v&utm_source=Commission%20Junction&utm_medium=External%2BAffil&utm_content=cjcgtld","3dcart":"//www.3dcart.com/1618.html",weebly:"//shareasale.com/r.cfm?b=366125&u=923171&m=37723&urllink=&afftrack=","web.com":"//www.web.com/landing/websitehosting.aspx?trkID=AFFm33DB7W&src=/affiliate/cj/","webs.com":"//www.webs.com/?referer=aff_cj_%zi_1_11715111_",moonfruit:"//www.moonfruit.com?cc=71007",shopify:"//www.shopify.com/?ref=powr",spacecraft:"//www.kqzyfj.com/click-7471947-12053050",mozello:"//www.shareasale.com/r.cfm?B=640491&U=923171&M=54444&urllink=",jimdo:"http://www.jimdo.com/#ref=a1004837"},t=Object.keys(e);$("body").find(":not(a,.affiliateReplaced,iframe,script,textarea,input)").each(function(){$(this).contents().filter(function(){return 3==this.nodeType}).filter(function(){for(var e=0;e<t.length;e++){var i=t[e];if(-1!==$(this).text().toLowerCase().indexOf(i.toLowerCase()))return!0}return!1}).each(function(){$(this).wrap('<span class="affiliateReplaced"></span>').parent().html($(this).text().replace(new RegExp(t.join("|"),"ig"),function(t){return"<a href='"+e[t.toLowerCase()]+"' target='_blank'>"+t+"</a>"}))})})}function loadNodeImages(e){"undefined"==typeof e&&(e=$(document)),e.find("[data-node-image]").each(function(){var e=$(this).data("node-image");if(-1==e.search("amazonaws"))var t=e;else{if(e=e.replace(/[\+#]/g,function(e){return"%25"+encodeURIComponent(e).substr(1)}),$(this).parents(".nodeImageParent").length>0)var i=$(this).parents(".nodeImageParent");else var i=$(this).parent();var n=i.width();size=void 0==n||0==n?"large":n>=600?"large":n>=150?"medium":"small",debug("loading image, width: "+n+"; size: "+size),e=encodeURIComponent(e),e=replaceAll("\\.","%2E",e);var t=nodeUri()+"/resize-image?url="+e+"&size="+size}$(this).attr("src",t)})}function loadCrypto(){if("undefined"==typeof CRYPTO_LOADED){debug("Loading crypto");var e=document.createElement("script");e.async=!0,e.src="/public-assets/crypto.min.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),CRYPTO_LOADED=!0}else"undefined"!=typeof CURRENT_USER&&CURRENT_USER&&deliverHash(CURRENT_USER.email)}function hashEmail(e){return"string"!=typeof e||-1==e.search("@")?"":(res="",res+="H1:"+CryptoJS.SHA1(e.toLowerCase()).toString(CryptoJS.enc.Hex),res+=",H2:"+CryptoJS.SHA1(e.toUpperCase()).toString(CryptoJS.enc.Hex),res+=",H3:"+CryptoJS.SHA1(e.split("@")[1].toLowerCase()).toString(CryptoJS.enc.Hex),res+=",H4:"+CryptoJS.MD5(e.toLowerCase()).toString(CryptoJS.enc.Hex),res+=",H5:"+CryptoJS.MD5(e.toUpperCase()).toString(CryptoJS.enc.Hex),res+=",H6:"+CryptoJS.SHA256(e.toLowerCase()).toString(CryptoJS.enc.Hex),res+=",H7:"+CryptoJS.SHA256(e.toUpperCase()).toString(CryptoJS.enc.Hex))}function deliverHash(e){if(void 0==getCookie("anonymized_user")){setCookie("anonymized_user",!0,1);var t=hashEmail(e);SMInformation={sid:"85rqyk",hema:t};var i=document.createElement("script");i.async=!0,i.src=("https:"==document.location.protocol?"https://data-secure":"http://data")+".circulate.com/dapi/collect";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n)}}!function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var i,n=e(document);e.rails=i={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var i=e('meta[name="csrf-token"]').attr("content");i&&t.setRequestHeader("X-CSRF-Token",i)},refreshCSRFTokens:function(){var t=e("meta[name=csrf-token]").attr("content"),i=e("meta[name=csrf-param]").attr("content");e('form input[name="'+i+'"]').val(t)},fire:function(t,i,n){var a=e.Event(i);return t.trigger(a,n),a.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(n){var a,r,o,s,l,c,d,u;if(i.fire(n,"ajax:before")){if(s=n.data("cross-domain"),l=s===t?null:s,c=n.data("with-credentials")||null,d=n.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,n.is("form")){a=n.attr("method"),r=n.attr("action"),o=n.serializeArray();var f=n.data("ujs:submit-button");f&&(o.push(f),n.data("ujs:submit-button",null))}else n.is(i.inputChangeSelector)?(a=n.data("method"),r=n.data("url"),o=n.serialize(),n.data("params")&&(o=o+"&"+n.data("params"))):n.is(i.buttonClickSelector)?(a=n.data("method")||"get",r=n.data("url"),o=n.serialize(),n.data("params")&&(o=o+"&"+n.data("params"))):(a=n.data("method"),r=i.href(n),o=n.data("params")||null);u={type:a||"GET",data:o,dataType:d,beforeSend:function(e,a){return a.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+a.accepts.script),i.fire(n,"ajax:beforeSend",[e,a])},success:function(e,t,i){n.trigger("ajax:success",[e,t,i])},complete:function(e,t){n.trigger("ajax:complete",[e,t])},error:function(e,t,i){n.trigger("ajax:error",[e,t,i])},crossDomain:l},c&&(u.xhrFields={withCredentials:c}),r&&(u.url=r);var p=i.ajax(u);return n.trigger("ajax:send",p),p}return!1},handleMethod:function(n){var a=i.href(n),r=n.data("method"),o=n.attr("target"),s=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),c=e('<form method="post" action="'+a+'"></form>'),d='<input name="_method" value="'+r+'" type="hidden" />';l!==t&&s!==t&&(d+='<input name="'+l+'" value="'+s+'" type="hidden" />'),o&&c.attr("target",o),c.hide().append(d).appendTo("body"),c.submit()},disableFormElements:function(t){t.find(i.disableSelector).each(function(){var t=e(this),i=t.is("button")?"html":"val";t.data("ujs:enable-with",t[i]()),t[i](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(i.enableSelector).each(function(){var t=e(this),i=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[i](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t,n=e.data("confirm"),a=!1;return n?(i.fire(e,"confirm")&&(a=i.confirm(n),t=i.fire(e,"confirm:complete",[a])),a&&t):!0},blankInputs:function(t,i,n){var a,r,o=e(),s=i||"input,textarea",l=t.find(s);return l.each(function(){if(a=e(this),r=a.is("input[type=checkbox],input[type=radio]")?a.is(":checked"):a.val(),!r==!n){if(a.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+a.attr("name")+'"]').length)return!0;o=o.add(a)}}),o.length?o:!1},nonBlankInputs:function(e,t){return i.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return i.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},i.fire(n,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,n){e.crossDomain||i.CSRFProtection(n)}),n.delegate(i.linkDisableSelector,"ajax:complete",function(){i.enableElement(e(this))}),n.delegate(i.linkClickSelector,"click.rails",function(n){var a=e(this),r=a.data("method"),o=a.data("params"),s=n.metaKey||n.ctrlKey;if(!i.allowAction(a))return i.stopEverything(n);if(!s&&a.is(i.linkDisableSelector)&&i.disableElement(a),a.data("remote")!==t){if(s&&(!r||"GET"===r)&&!o)return!0;var l=i.handleRemote(a);return l===!1?i.enableElement(a):l.error(function(){i.enableElement(a)}),!1}return a.data("method")?(i.handleMethod(a),!1):void 0}),n.delegate(i.buttonClickSelector,"click.rails",function(t){var n=e(this);return i.allowAction(n)?(i.handleRemote(n),!1):i.stopEverything(t)}),n.delegate(i.inputChangeSelector,"change.rails",function(t){var n=e(this);return i.allowAction(n)?(i.handleRemote(n),!1):i.stopEverything(t)}),n.delegate(i.formSubmitSelector,"submit.rails",function(n){var a=e(this),r=a.data("remote")!==t,o=i.blankInputs(a,i.requiredInputSelector),s=i.nonBlankInputs(a,i.fileInputSelector);if(!i.allowAction(a))return i.stopEverything(n);if(o&&a.attr("novalidate")==t&&i.fire(a,"ajax:aborted:required",[o]))return i.stopEverything(n);if(r){if(s){setTimeout(function(){i.disableFormElements(a)},13);var l=i.fire(a,"ajax:aborted:file",[s]);return l||setTimeout(function(){i.enableFormElements(a)},13),l}return i.handleRemote(a),!1}setTimeout(function(){i.disableFormElements(a)},13)}),n.delegate(i.formInputClickSelector,"click.rails",function(t){var n=e(this);if(!i.allowAction(n))return i.stopEverything(t);var a=n.attr("name"),r=a?{name:a,value:n.val()}:null;n.closest("form").data("ujs:submit-button",r)}),n.delegate(i.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&i.disableFormElements(e(this))}),n.delegate(i.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&i.enableFormElements(e(this))}),e(function(){i.refreshCSRFTokens()}))}(jQuery),function(){var e,t=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};!function(i,n){var a;a=function(e,t){this.elem=e,this.$elem=i(e),this.options=t,this.cb_timer_id=null,this.stop_requested=!1},a.prototype={defaults:{event_name:"css-change",data_attr_name:"css-watch-data",use_event:!0,callback:null,props:"",props_functions:{}},init:function(){return this.config=i.extend({},this.defaults,this.options,this.metadata),this.config.props=this.splitAndTrimProps(this.config.props),this.config.props.length>0&&(this.setInitialData(),this.start()),this},splitAndTrimProps:function(e){var t,i,n;for(t=e.split(","),n=[],i=0;i<t.length;)n.push(t[i].trim()),i++;return n},setInitialData:function(){var e;for(e=0;e<this.config.props.length;)this.setData(this.config.props[e],this.getPropertyValue(this.config.props[e])),e++},setData:function(e,t){return this.$elem.data(""+this.config.data_attr_name+"-"+e,t)},updateDataFromChanges:function(e){var t,i,n,a,r;for(r=Object.keys(e),i=n=0,a=r.length;a>n;i=++n)t=r[i],this.setData(t,e[t])},getDataValue:function(e){return this.$elem.data(""+this.config.data_attr_name+"-"+e)},getPropertyValue:function(i){var a;if(0===Object.keys(this.config.props_functions).length)return this.$elem.css(i);if(a=null,t.call(Object.keys(this.config.props_functions),i)>=0&&(a=this.config.props_functions[i]),null!==a){if(n.ExecuteMethod)return e.executeMethodByFunctionName(a,this.$elem);console.log("You are missing the ExecuteMethod library.")}return this.$elem.css(i)},changedProperties:function(){var e,t;for(e=0,t={};e<this.config.props.length;)this.getPropertyValue(this.config.props[e])!==this.getDataValue(this.config.props[e])&&(t[this.config.props[e]]=this.getPropertyValue(this.config.props[e])),e++;return t},stop:function(){var e;if("undefined"!=typeof this.config&&null!==this.config)return e=!0,n.cssWatchCancelAnimationFrame(this.cb_timer_id)},start:function(){var e=this;"undefined"!=typeof this.config&&null!==this.config&&(this.stop_requested=!1,this.cb_timer_id=n.cssWatchRequestAnimationFrame(function(){e.check()}))},check:function(){var e,t=this;return"undefined"==typeof this.config||null===this.config?!1:this.stop_requested===!0?!1:(e=this.changedProperties(),Object.keys(e).length>0&&(this.config.use_event&&this.$elem.trigger(this.config.event_name,e),null!==this.config.callback&&this.config.callback.apply(null,[e]),this.updateDataFromChanges(e)),this.cb_timer_id=n.cssWatchRequestAnimationFrame(function(){t.check()}),!1)},destroy:function(){return this.stop(),this.$elem.removeData("css-watch-object"),this.$elem.removeData(this.config.data_attr_name),null}},a.defaults=a.prototype.defaults,i.fn.csswatch=function(e){return this.each(function(){var t,n;if("object"!=typeof e&&e){if("string"==typeof e&&(n=i(this).data("css-watch-object"),n&&n[e]))return n[e].apply(this)}else t=i(this).data("css-watch-object"),t||(n=new a(this,e),i(this).data("css-watch-object",n),n.init())})}}(jQuery,window,document),Object.keys||(Object.keys=function(e){var t,i;if(e!==Object(e))throw new TypeError("Object.keys called on non-object");i=[],t=void 0;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.push(t);return i}),window.cssWatchRequestAnimationFrame||(window.cssWatchRequestAnimationFrame=function(){return window.webkitAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.requestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}}()),window.cssWatchCancelAnimationFrame||(window.cssWatchCancelAnimationFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||function(e){return window.clearTimeout(e)}}()),e={getFunctionsAndProperties:function(t){var i,n,a;for(i=t.split("."),n=0,a=[];n<i.length;)a.push(e.getFunctionAndParameters(i[n])),n++;return a},getFunctionAndParameters:function(t){var i,n,a;return e.isFunction(t)?(a=t.substring(t.indexOf("(")+1,t.indexOf(")")),a=a.length>0?e.splitAndTypeCastParameters(a):[],i=t.substring(0,t.indexOf("(")),n=!0):(i=t,a=null,n=!1),{func:i,params:a,isfunc:n}},splitAndTypeCastParameters:function(t){var i,n,a;for(i=t.split(","),a=[],n=0,a=[];n<i.length;)a.push(e.typecastParameter(i[n])),n++;return a},isFunction:function(t){return-1!==e.regexIndexOf(t,/(\([\d|\D]+\))|(\(\))/,0)?!0:!1},regexIndexOf:function(e,t,i){var n;return n=e.substring(i||0).search(t),n>=0?n+(i||0):n},typecastParameter:function(e){return e=e.trim(),e=e.replace(/^"/,""),e=e.replace(/"$/m,""),0===e.search(/^\d+$/)?parseInt(e):0===e.search(/^\d+\.\d+$/)?parseFloat(e):"false"===e?!1:"true"===e?!0:e},executeSingleFunction:function(e,t,i,n){return i[e].apply(n,t)},getSingleProperty:function(e,t){return t[e]},executeMethodByFunctionName:function(t,i){var n,a,r,o;for(r=e.getFunctionsAndProperties(t),o=0,n=i,a=null;o<r.length;)n=r[o].isfunc===!0?e.executeSingleFunction(r[o].func,r[o].params,n,i):e.getSingleProperty(r[o].func,n),o++;return n}},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),("undefined"===window.ExecuteMethod||null===window.ExecuteMethod||void 0===window.ExecuteMethod)&&(window.ExecuteMethod=e)}.call(this),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,a,r,o,s=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,i=0;r>i;i+=1)o[i]=str(i,l)||"null";return a=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,a}if(rep&&"object"==typeof rep)for(r=rep.length,i=0;r>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],a=str(n,l),a&&o.push(quote(n)+(gap?": ":":")+a));else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(a=str(n,l),a&&o.push(quote(n)+(gap?": ":":")+a));return a=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var i,n,a=e[t];if(a&&"object"==typeof a)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n=walk(a,i),void 0!==n?a[i]=n:delete a[i]);return reviver.call(e,t,a)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){var e=this,t=e._,i={},n=Array.prototype,a=Object.prototype,r=Function.prototype,o=n.push,s=n.slice,l=n.concat,c=a.toString,d=a.hasOwnProperty,u=n.forEach,f=n.map,p=n.reduce,h=n.reduceRight,m=n.filter,g=n.every,v=n.some,y=n.indexOf,b=n.lastIndexOf,w=Array.isArray,S=Object.keys,$=r.bind,_=function(e){return e instanceof _?e:this instanceof _?void(this._wrapped=e):new _(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):e._=_,_.VERSION="1.5.2";var x=_.each=_.forEach=function(e,t,n){if(null!=e)if(u&&e.forEach===u)e.forEach(t,n);else if(e.length===+e.length){for(var a=0,r=e.length;r>a;a++)if(t.call(n,e[a],a,e)===i)return}else for(var o=_.keys(e),a=0,r=o.length;r>a;a++)if(t.call(n,e[o[a]],o[a],e)===i)return};_.map=_.collect=function(e,t,i){var n=[];return null==e?n:f&&e.map===f?e.map(t,i):(x(e,function(e,a,r){n.push(t.call(i,e,a,r))}),n)};var E="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=_.bind(t,n)),a?e.reduce(t,i):e.reduce(t);if(x(e,function(e,r,o){a?i=t.call(n,i,e,r,o):(i=e,a=!0)}),!a)throw new TypeError(E);return i},_.reduceRight=_.foldr=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),h&&e.reduceRight===h)return n&&(t=_.bind(t,n)),a?e.reduceRight(t,i):e.reduceRight(t);var r=e.length;if(r!==+r){var o=_.keys(e);r=o.length}if(x(e,function(s,l,c){l=o?o[--r]:--r,a?i=t.call(n,i,e[l],l,c):(i=e[l],a=!0)}),!a)throw new TypeError(E);return i},_.find=_.detect=function(e,t,i){var n;return T(e,function(e,a,r){return t.call(i,e,a,r)?(n=e,!0):void 0}),n},_.filter=_.select=function(e,t,i){var n=[];return null==e?n:m&&e.filter===m?e.filter(t,i):(x(e,function(e,a,r){t.call(i,e,a,r)&&n.push(e)}),n)},_.reject=function(e,t,i){return _.filter(e,function(e,n,a){return!t.call(i,e,n,a)},i)},_.every=_.all=function(e,t,n){t||(t=_.identity);var a=!0;return null==e?a:g&&e.every===g?e.every(t,n):(x(e,function(e,r,o){return(a=a&&t.call(n,e,r,o))?void 0:i}),!!a)};var T=_.some=_.any=function(e,t,n){t||(t=_.identity);var a=!1;return null==e?a:v&&e.some===v?e.some(t,n):(x(e,function(e,r,o){return a||(a=t.call(n,e,r,o))?i:void 0}),!!a)};_.contains=_.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):T(e,function(e){return e===t})},_.invoke=function(e,t){var i=s.call(arguments,2),n=_.isFunction(t);return _.map(e,function(e){return(n?t:e[t]).apply(e,i)})},_.pluck=function(e,t){return _.map(e,function(e){return e[t]})},_.where=function(e,t,i){return _.isEmpty(t)?i?void 0:[]:_[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},_.findWhere=function(e,t){return _.where(e,t,!0)},_.max=function(e,t,i){if(!t&&_.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&_.isEmpty(e))return-1/0;var n={computed:-1/0,value:-1/0};return x(e,function(e,a,r){var o=t?t.call(i,e,a,r):e;o>n.computed&&(n={value:e,computed:o})}),n.value},_.min=function(e,t,i){if(!t&&_.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&_.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return x(e,function(e,a,r){var o=t?t.call(i,e,a,r):e;o<n.computed&&(n={value:e,computed:o})}),n.value},_.shuffle=function(e){var t,i=0,n=[];return x(e,function(e){t=_.random(i++),n[i-1]=n[t],n[t]=e}),n},_.sample=function(e,t,i){return arguments.length<2||i?e[_.random(e.length-1)]:_.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return _.isFunction(e)?e:function(t){return t[e]
}};_.sortBy=function(e,t,i){var n=k(t);return _.pluck(_.map(e,function(e,t,a){return{value:e,index:t,criteria:n.call(i,e,t,a)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index-t.index}),"value")};var C=function(e){return function(t,i,n){var a={},r=null==i?_.identity:k(i);return x(t,function(i,o){var s=r.call(n,i,o,t);e(a,s,i)}),a}};_.groupBy=C(function(e,t,i){(_.has(e,t)?e[t]:e[t]=[]).push(i)}),_.indexBy=C(function(e,t,i){e[t]=i}),_.countBy=C(function(e,t){_.has(e,t)?e[t]++:e[t]=1}),_.sortedIndex=function(e,t,i,n){i=null==i?_.identity:k(i);for(var a=i.call(n,t),r=0,o=e.length;o>r;){var s=r+o>>>1;i.call(n,e[s])<a?r=s+1:o=s}return r},_.toArray=function(e){return e?_.isArray(e)?s.call(e):e.length===+e.length?_.map(e,_.identity):_.values(e):[]},_.size=function(e){return null==e?0:e.length===+e.length?e.length:_.keys(e).length},_.first=_.head=_.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:s.call(e,0,t)},_.initial=function(e,t,i){return s.call(e,0,e.length-(null==t||i?1:t))},_.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},_.rest=_.tail=_.drop=function(e,t,i){return s.call(e,null==t||i?1:t)},_.compact=function(e){return _.filter(e,_.identity)};var P=function(e,t,i){return t&&_.every(e,_.isArray)?l.apply(i,e):(x(e,function(e){_.isArray(e)||_.isArguments(e)?t?o.apply(i,e):P(e,t,i):i.push(e)}),i)};_.flatten=function(e,t){return P(e,t,[])},_.without=function(e){return _.difference(e,s.call(arguments,1))},_.uniq=_.unique=function(e,t,i,n){_.isFunction(t)&&(n=i,i=t,t=!1);var a=i?_.map(e,i,n):e,r=[],o=[];return x(a,function(i,n){(t?n&&o[o.length-1]===i:_.contains(o,i))||(o.push(i),r.push(e[n]))}),r},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(e){var t=s.call(arguments,1);return _.filter(_.uniq(e),function(e){return _.every(t,function(t){return _.indexOf(t,e)>=0})})},_.difference=function(e){var t=l.apply(n,s.call(arguments,1));return _.filter(e,function(e){return!_.contains(t,e)})},_.zip=function(){for(var e=_.max(_.pluck(arguments,"length").concat(0)),t=new Array(e),i=0;e>i;i++)t[i]=_.pluck(arguments,""+i);return t},_.object=function(e,t){if(null==e)return{};for(var i={},n=0,a=e.length;a>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},_.indexOf=function(e,t,i){if(null==e)return-1;var n=0,a=e.length;if(i){if("number"!=typeof i)return n=_.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,a+i):i}if(y&&e.indexOf===y)return e.indexOf(t,i);for(;a>n;n++)if(e[n]===t)return n;return-1},_.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(b&&e.lastIndexOf===b)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var a=n?i:e.length;a--;)if(e[a]===t)return a;return-1},_.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),a=0,r=new Array(n);n>a;)r[a++]=e,e+=i;return r};var I=function(){};_.bind=function(e,t){var i,n;if($&&e.bind===$)return $.apply(e,s.call(arguments,1));if(!_.isFunction(e))throw new TypeError;return i=s.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,i.concat(s.call(arguments)));I.prototype=e.prototype;var a=new I;I.prototype=null;var r=e.apply(a,i.concat(s.call(arguments)));return Object(r)===r?r:a}},_.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},_.bindAll=function(e){var t=s.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return x(t,function(t){e[t]=_.bind(e[t],e)}),e},_.memoize=function(e,t){var i={};return t||(t=_.identity),function(){var n=t.apply(this,arguments);return _.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},_.delay=function(e,t){var i=s.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},_.defer=function(e){return _.delay.apply(_,[e,1].concat(s.call(arguments,1)))},_.throttle=function(e,t,i){var n,a,r,o=null,s=0;i||(i={});var l=function(){s=i.leading===!1?0:new Date,o=null,r=e.apply(n,a)};return function(){var c=new Date;s||i.leading!==!1||(s=c);var d=t-(c-s);return n=this,a=arguments,0>=d?(clearTimeout(o),o=null,s=c,r=e.apply(n,a)):o||i.trailing===!1||(o=setTimeout(l,d)),r}},_.debounce=function(e,t,i){var n,a,r,o,s;return function(){r=this,a=arguments,o=new Date;var l=function(){var c=new Date-o;t>c?n=setTimeout(l,t-c):(n=null,i||(s=e.apply(r,a)))},c=i&&!n;return n||(n=setTimeout(l,t)),c&&(s=e.apply(r,a)),s}},_.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},_.wrap=function(e,t){return function(){var i=[e];return o.apply(i,arguments),t.apply(this,i)}},_.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},_.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},_.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)_.has(e,i)&&t.push(i);return t},_.values=function(e){for(var t=_.keys(e),i=t.length,n=new Array(i),a=0;i>a;a++)n[a]=e[t[a]];return n},_.pairs=function(e){for(var t=_.keys(e),i=t.length,n=new Array(i),a=0;i>a;a++)n[a]=[t[a],e[t[a]]];return n},_.invert=function(e){for(var t={},i=_.keys(e),n=0,a=i.length;a>n;n++)t[e[i[n]]]=i[n];return t},_.functions=_.methods=function(e){var t=[];for(var i in e)_.isFunction(e[i])&&t.push(i);return t.sort()},_.extend=function(e){return x(s.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},_.pick=function(e){var t={},i=l.apply(n,s.call(arguments,1));return x(i,function(i){i in e&&(t[i]=e[i])}),t},_.omit=function(e){var t={},i=l.apply(n,s.call(arguments,1));for(var a in e)_.contains(i,a)||(t[a]=e[a]);return t},_.defaults=function(e){return x(s.call(arguments,1),function(t){if(t)for(var i in t)void 0===e[i]&&(e[i]=t[i])}),e},_.clone=function(e){return _.isObject(e)?_.isArray(e)?e.slice():_.extend({},e):e},_.tap=function(e,t){return t(e),e};var O=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof _&&(e=e._wrapped),t instanceof _&&(t=t._wrapped);var a=c.call(e);if(a!=c.call(t))return!1;switch(a){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var r=i.length;r--;)if(i[r]==e)return n[r]==t;var o=e.constructor,s=t.constructor;if(o!==s&&!(_.isFunction(o)&&o instanceof o&&_.isFunction(s)&&s instanceof s))return!1;i.push(e),n.push(t);var l=0,d=!0;if("[object Array]"==a){if(l=e.length,d=l==t.length)for(;l--&&(d=O(e[l],t[l],i,n)););}else{for(var u in e)if(_.has(e,u)&&(l++,!(d=_.has(t,u)&&O(e[u],t[u],i,n))))break;if(d){for(u in t)if(_.has(t,u)&&!l--)break;d=!l}}return i.pop(),n.pop(),d};_.isEqual=function(e,t){return O(e,t,[],[])},_.isEmpty=function(e){if(null==e)return!0;if(_.isArray(e)||_.isString(e))return 0===e.length;for(var t in e)if(_.has(e,t))return!1;return!0},_.isElement=function(e){return!(!e||1!==e.nodeType)},_.isArray=w||function(e){return"[object Array]"==c.call(e)},_.isObject=function(e){return e===Object(e)},x(["Arguments","Function","String","Number","Date","RegExp"],function(e){_["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),_.isArguments(arguments)||(_.isArguments=function(e){return!(!e||!_.has(e,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(e){return"function"==typeof e}),_.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},_.isNaN=function(e){return _.isNumber(e)&&e!=+e},_.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},_.isNull=function(e){return null===e},_.isUndefined=function(e){return void 0===e},_.has=function(e,t){return d.call(e,t)},_.noConflict=function(){return e._=t,this},_.identity=function(e){return e},_.times=function(e,t,i){for(var n=Array(Math.max(0,e)),a=0;e>a;a++)n[a]=t.call(i,a);return n},_.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};A.unescape=_.invert(A.escape);var R={escape:new RegExp("["+_.keys(A.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(A.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(e){_[e]=function(t){return null==t?"":(""+t).replace(R[e],function(t){return A[e][t]})}}),_.result=function(e,t){if(null==e)return void 0;var i=e[t];return _.isFunction(i)?i.call(e):i},_.mixin=function(e){x(_.functions(e),function(t){var i=_[t]=e[t];_.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),j.call(this,i.apply(_,e))}})};var F=0;_.uniqueId=function(e){var t=++F+"";return e?e+t:t},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(e,t,i){var n;i=_.defaults({},i,_.templateSettings);var a=new RegExp([(i.escape||M).source,(i.interpolate||M).source,(i.evaluate||M).source].join("|")+"|$","g"),r=0,o="__p+='";e.replace(a,function(t,i,n,a,s){return o+=e.slice(r,s).replace(N,function(e){return"\\"+D[e]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),a&&(o+="';\n"+a+"\n__p+='"),r=s+t.length,t}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(s){throw s.source=o,s}if(t)return n(t,_);var l=function(e){return n.call(this,e,_)};return l.source="function("+(i.variable||"obj")+"){\n"+o+"}",l},_.chain=function(e){return _(e).chain()};var j=function(e){return this._chain?_(e).chain():e};_.mixin(_),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];_.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],j.call(this,i)}}),x(["concat","join","slice"],function(e){var t=n[e];_.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){{var e,t=this,i=t.Backbone,n=[],a=(n.push,n.slice);n.splice}e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.1.0";var r=t._;r||"undefined"==typeof require||(r=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var o=e.Events={on:function(e,t,i){if(!l(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,i){if(!l(this,"once",e,[t,i])||!t)return this;var n=this,a=r.once(function(){n.off(e,a),t.apply(this,arguments)});return a._callback=t,this.on(e,a,i)},off:function(e,t,i){var n,a,o,s,c,d,u,f;if(!this._events||!l(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(s=e?[e]:r.keys(this._events),c=0,d=s.length;d>c;c++)if(e=s[c],o=this._events[e]){if(this._events[e]=n=[],t||i)for(u=0,f=o.length;f>u;u++)a=o[u],(t&&t!==a.callback&&t!==a.callback._callback||i&&i!==a.context)&&n.push(a);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!l(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&c(i,t),n&&c(n,arguments),this},stopListening:function(e,t,i){var n=this._listeningTo;if(!n)return this;var a=!t&&!i;i||"object"!=typeof t||(i=this),e&&((n={})[e._listenId]=e);for(var o in n)e=n[o],e.off(t,i,this),(a||r.isEmpty(e._events))&&delete this._listeningTo[o];return this}},s=/\s+/,l=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var a in i)e[t].apply(e,[a,i[a]].concat(n));return!1}if(s.test(i)){for(var r=i.split(s),o=0,l=r.length;l>o;o++)e[t].apply(e,[r[o]].concat(n));return!1}return!0},c=function(e,t){var i,n=-1,a=e.length,r=t[0],o=t[1],s=t[2];switch(t.length){case 0:for(;++n<a;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<a;)(i=e[n]).callback.call(i.ctx,r);return;case 2:for(;++n<a;)(i=e[n]).callback.call(i.ctx,r,o);return;case 3:for(;++n<a;)(i=e[n]).callback.call(i.ctx,r,o,s);return;default:for(;++n<a;)(i=e[n]).callback.apply(i.ctx,t)}},d={listenTo:"on",listenToOnce:"once"};r.each(d,function(e,t){o[t]=function(t,i,n){var a=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=r.uniqueId("l"));return a[o]=t,n||"object"!=typeof i||(n=this),t[e](i,n,this),this}}),o.bind=o.on,o.unbind=o.off,r.extend(e,o);var u=e.Model=function(e,t){var i=e||{};t||(t={}),this.cid=r.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=r.defaults({},i,r.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};r.extend(u.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return r.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return r.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var n,a,o,s,l,c,d,u;if(null==e)return this;if("object"==typeof e?(a=e,i=t):(a={})[e]=t,i||(i={}),!this._validate(a,i))return!1;o=i.unset,l=i.silent,s=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=r.clone(this.attributes),this.changed={}),u=this.attributes,d=this._previousAttributes,this.idAttribute in a&&(this.id=a[this.idAttribute]);for(n in a)t=a[n],r.isEqual(u[n],t)||s.push(n),r.isEqual(d[n],t)?delete this.changed[n]:this.changed[n]=t,o?delete u[n]:u[n]=t;if(!l){s.length&&(this._pending=!0);for(var f=0,p=s.length;p>f;f++)this.trigger("change:"+s[f],this,u[s[f]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,r.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,r.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!r.isEmpty(this.changed):r.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?r.clone(this.changed):!1;var t,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var a in e)r.isEqual(n[a],t=e[a])||((i||(i={}))[a]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(e){e=e?r.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},D(this,e),this.sync("read",this,e)},save:function(e,t,i){var n,a,o,s=this.attributes;if(null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,i=r.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=r.extend({},s,n)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=s;var t=l.parse(e,i);return i.wait&&(t=r.extend(n||{},t)),r.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),void l.trigger("sync",l,e,i))},D(this,i),a=this.isNew()?"create":i.patch?"patch":"update","patch"===a&&(i.attrs=n),o=this.sync(a,this,i),n&&i.wait&&(this.attributes=s),o},destroy:function(e){e=e?r.clone(e):{};var t=this,i=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(a){(e.wait||t.isNew())&&n(),i&&i(t,a,e),t.isNew()||t.trigger("sync",t,a,e)},this.isNew())return e.success(),!1;D(this,e);var a=this.sync("delete",this,e);return e.wait||n(),a},url:function(){var e=r.result(this,"urlRoot")||r.result(this.collection,"url")||M();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},r.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=r.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,r.extend(t,{validationError:i})),!1):!0}});var f=["keys","values","pairs","invert","pick","omit"];r.each(f,function(e){u.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.attributes),r[e].apply(r,t)}});var p=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,r.extend({silent:!0},t))},h={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};r.extend(p.prototype,o,{model:u,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,r.extend({merge:!1},t,m))},remove:function(e,t){var i=!r.isArray(e);e=i?[e]:r.clone(e),t||(t={});var n,a,o,s;for(n=0,a=e.length;a>n;n++)s=e[n]=this.get(e[n]),s&&(delete this._byId[s.id],delete this._byId[s.cid],o=this.indexOf(s),this.models.splice(o,1),this.length--,t.silent||(t.index=o,s.trigger("remove",s,this,t)),this._removeReference(s));return i?e[0]:e},set:function(e,t){t=r.defaults({},t,h),t.parse&&(e=this.parse(e,t));var i=!r.isArray(e);e=i?e?[e]:[]:r.clone(e);var n,a,o,s,l,c,d,f=t.at,p=this.model,m=this.comparator&&null==f&&t.sort!==!1,g=r.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},w=t.add,S=t.merge,$=t.remove,_=!m&&w&&$?[]:!1;for(n=0,a=e.length;a>n;n++){if(l=e[n],o=l instanceof u?s=l:l[p.prototype.idAttribute],c=this.get(o))$&&(b[c.cid]=!0),S&&(l=l===s?s.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),m&&!d&&c.hasChanged(g)&&(d=!0)),e[n]=c;else if(w){if(s=e[n]=this._prepareModel(l,t),!s)continue;v.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)}_&&_.push(c||s)}if($){for(n=0,a=this.length;a>n;++n)b[(s=this.models[n]).cid]||y.push(s);y.length&&this.remove(y,t)}if(v.length||_&&_.length)if(m&&(d=!0),this.length+=v.length,null!=f)for(n=0,a=v.length;a>n;n++)this.models.splice(f+n,0,v[n]);else{_&&(this.models.length=0);var x=_||v;for(n=0,a=x.length;a>n;n++)this.models.push(x[n])}if(d&&this.sort({silent:!0}),!t.silent){for(n=0,a=v.length;a>n;n++)(s=v[n]).trigger("add",s,this,t);(d||_&&_.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),e=this.add(e,r.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,r.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,r.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return a.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e.id]||this._byId[e.cid]||this._byId[e]},at:function(e){return this.models[e]},where:function(e,t){return r.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),r.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(r.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return r.invoke(this.models,"get",e)},fetch:function(e){e=e?r.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var a=e.reset?"reset":"set";i[a](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},D(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?r.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,n=t.success;return t.success=function(e,t,a){a.wait&&i.add(e,a),n&&n(e,t,a)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof u)return e.collection||(e.collection=this),e;t=t?r.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];r.each(g,function(e){p.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),r[e].apply(r,t)}});var v=["groupBy","countBy","sortBy"];r.each(v,function(e){p.prototype[e]=function(t,i){var n=r.isFunction(t)?t:function(e){return e.get(t)};return r[e](this.models,n,i)}});var y=e.View=function(e){this.cid=r.uniqueId("view"),e||(e={}),r.extend(this,r.pick(e,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];r.extend(y.prototype,o,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=r.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(r.isFunction(i)||(i=this[e[t]]),i){var n=t.match(b),a=n[1],o=n[2];i=r.bind(i,this),a+=".delegateEvents"+this.cid,""===o?this.$el.on(a,i):this.$el.on(a,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(r.result(this,"el"),!1);else{var t=r.extend({},r.result(this,"attributes"));this.id&&(t.id=r.result(this,"id")),this.className&&(t["class"]=r.result(this,"className"));var i=e.$("<"+r.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,n){var a=$[t];r.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:a,dataType:"json"};if(n.url||(o.url=r.result(i,"url")||M()),null!=n.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){o.type="POST",n.emulateJSON&&(o.data._method=a);var s=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",a),s?s.apply(this,arguments):void 0}}"GET"===o.type||n.emulateJSON||(o.processData=!1),"PATCH"===o.type&&S&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=e.ajax(r.extend(o,n));return i.trigger("request",i,l,n),l};var S=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),$={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var _=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},x=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,T=/\*\w+/g,k=/[\-{}\[\]+?.,\\\^$|#\s]/g;r.extend(_.prototype,o,{initialize:function(){},route:function(t,i,n){r.isRegExp(t)||(t=this._routeToRegExp(t)),r.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var a=this;return e.history.route(t,function(r){var o=a._extractParameters(t,r);n&&n.apply(a,o),a.trigger.apply(a,["route:"+i].concat(o)),a.trigger("route",i,o),e.history.trigger("route",a,i,o)}),this},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=r.result(this,"routes");for(var e,t=r.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(k,"\\$&").replace(x,"(?:$1)?").replace(E,function(e,t){return t?e:"([^/]+)"}).replace(T,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return r.map(i,function(e){return e?decodeURIComponent(e):null})}});var C=e.History=function(){this.handlers=[],r.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},P=/^[#\/]|\s+$/g,I=/^\/+|\/+$/g,O=/msie [\w.]+/,A=/\/$/,R=/[?#].*$/;C.started=!1,r.extend(C.prototype,o,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(A,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(P,"")},start:function(t){if(C.started)throw new Error("Backbone.history has already been started");C.started=!0,this.options=r.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,a=O.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(I,"/"),a&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!a?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var o=this.location,s=o.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&s&&o.hash&&(this.fragment=this.getHash().replace(P,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),C.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),r.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!C.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(R,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),e.history=new C;var F=function(e,t){var i,n=this;i=e&&r.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},r.extend(i,n,t);var a=function(){this.constructor=i};return a.prototype=n.prototype,i.prototype=new a,e&&r.extend(i.prototype,e),i.__super__=n.prototype,i};u.extend=p.extend=_.extend=y.extend=C.extend=F;var M=function(){throw new Error('A "url" property or function must be specified')},D=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}}}.call(this),jQuery.fn.addPrototype=function(e,t){var i=$(this[0]),n=i.children(".prototype"),a=(n.outerHeight(!0)+"px",n.clone().removeClass("prototype"));return 0==n.length?(debug&&console.log("No prototype length"),"function"==typeof e&&e(a),a):("undefined"!=typeof id&&a.attr("id",id),t&&"instant"==t.speed?(a.appendTo(i),"function"==typeof e&&e(a),a):(a.hide().appendTo(i).hide().slideDown(200,function(){"function"==typeof e&&e(a)}),a))},jQuery.fn.deleteAnimate=function(e){var t=$(this[0]);t.slideUp(200,function(){t.remove(),"function"==typeof e&&e()})},jQuery.fn.formToObject=function(e){if(e&&e.ignoreWithParent)var t=e.ignoreWithParent;else var t=!1;if(e&&e.ignoreWithClass)var i=e.ignoreWithClass;else var i=!1;var n=$(this),a=new Object,r=n.find('input[type="text"], input[type="date"], input[type="email"], input[type="password"], input[type="hidden"], textarea, select, input[type="radio"]:checked, input[type="checkbox"]');return r.each(function(){if(!(i&&$(this).hasClass(i)||t&&$(this).parents(t).length>0)){var e=$(this).attr("name"),n=$(this).val(),r=$(this).attr("type");"undefined"!=typeof e&&(a[e]="checkbox"==r?$(this).prop("checked")?!0:!1:n)}}),a},jQuery.fn.objectToForm=function(e){var t=$(this);for(var i in e){var n=e[i];if("string"==typeof n||"number"==typeof n||"boolean"==typeof n){var a='[name="'+i+'"]',r='input[type="text"]'+a+', input[type="email"]'+a+', input[type="date"]'+a+', input[type="hidden"]'+a+", textarea"+a+", select"+a;if(t.find(r).val(n),"string"==typeof n)var o=n.replace(/\\/g,"").replace(/(['"])/g,"\\$1");else var o="";a='[name="'+i+'"][value="'+o+'"]',r='input[type="radio"]'+a,t.find(r).prop("checked",!0),1==e[i]&&(a='[name="'+i+'"]',r='input[type="checkbox"]'+a,t.find(r).prop("checked",!0)),0==e[i]&&(a='[name="'+i+'"]',r='input[type="checkbox"]'+a,t.find(r).prop("checked",!1))}}},jQuery.fn.reloadHtml=function(){var e=$(this);e.each(function(){var e=$(this).html();$(this).html(e)})},jQuery.fn.computeMaxHeight=function(){var e=$(this),t=0;return e.each(function(){$(this).height()>t&&(t=$(this).height())}),t},jQuery.fn.transition=function(e,t,i){var n=$(this[0]),a=n.css("width"),r=n.css("height");switch(e){case"fadeOut":n.fadeOut(t,i);break;case"fadeIn":n.fadeIn(t,i);break;case"slideLeft":n.show().animate({left:"-="+a},t,i);break;case"slideRight":n.show().animate({left:"+="+a},t,i);break;case"slideUp":n.show().animate({top:"+="+r},t,i);break;case"slideDown":n.show().animate({top:"-="+r},t,i);break;case"slideInLeft":n.css("left","+="+a).animate({left:"-="+a},t,i);break;case"slideInRight":n.css("left","-="+a).animate({left:"+="+a},t,i);break;case"slideInUp":n.css("top","-="+r).animate({top:"+="+r},t,i);break;case"slideInDown":n.css("top","+="+r).animate({top:"-="+r},t,i)}},jQuery.fn.toggleButton=function(){var e=$(this);e.each(function(){this.disabled=!this.disabled,$(this).toggleClass("loading")})},jQuery.fn.clearInputs=function(){$(this).find('input:not([type="submit"]), textarea').val("")},window.Modernizr=function(e,t,i){function n(e){y.cssText=e}function a(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var n in e){var a=e[n];if(!r(a,"-")&&y[a]!==i)return"pfx"==t?a:!0}return!1}function s(e,t,n){for(var r in e){var o=t[e[r]];if(o!==i)return n===!1?e[r]:a(o,"function")?o.bind(n||t):o}return!1}function l(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+_.join(n+" ")+n).split(" ");return a(t,"string")||a(t,"undefined")?o(r,t):(r=(e+" "+x.join(n+" ")+n).split(" "),s(r,t,i))
}function c(){p.input=function(i){for(var n=0,a=i.length;a>n;n++)k[i[n]]=i[n]in b;return k.list&&(k.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),k}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),p.inputtypes=function(e){for(var n,a,r,o=0,s=e.length;s>o;o++)b.setAttribute("type",a=e[o]),n="text"!==b.type,n&&(b.value=w,b.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(a)&&b.style.WebkitAppearance!==i?(m.appendChild(b),r=t.defaultView,n=r.getComputedStyle&&"textfield"!==r.getComputedStyle(b,null).WebkitAppearance&&0!==b.offsetHeight,m.removeChild(b)):/^(search|tel)$/.test(a)||(n=/^(url|email)$/.test(a)?b.checkValidity&&b.checkValidity()===!1:b.value!=w)),T[e[o]]=!!n;return T}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d,u,f="2.7.1",p={},h=!0,m=t.documentElement,g="modernizr",v=t.createElement(g),y=v.style,b=t.createElement("input"),w=":)",S=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),$="Webkit Moz O ms",_=$.split(" "),x=$.toLowerCase().split(" "),E={},T={},k={},C=[],P=C.slice,I=function(e,i,n,a){var r,o,s,l,c=t.createElement("div"),d=t.body,u=d||t.createElement("body");if(parseInt(n,10))for(;n--;)s=t.createElement("div"),s.id=a?a[n]:g+(n+1),c.appendChild(s);return r=["&#173;",'<style id="s',g,'">',e,"</style>"].join(""),c.id=g,(d?c:u).innerHTML+=r,u.appendChild(c),d||(u.style.background="",u.style.overflow="hidden",l=m.style.overflow,m.style.overflow="hidden",m.appendChild(u)),o=i(c,e),d?c.parentNode.removeChild(c):(u.parentNode.removeChild(u),m.style.overflow=l),!!o},O={}.hasOwnProperty;u=a(O,"undefined")||a(O.call,"undefined")?function(e,t){return t in e&&a(e.constructor.prototype[t],"undefined")}:function(e,t){return O.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=P.call(arguments,1),n=function(){if(this instanceof n){var a=function(){};a.prototype=t.prototype;var r=new a,o=t.apply(r,i.concat(P.call(arguments)));return Object(o)===o?o:r}return t.apply(e,i.concat(P.call(arguments)))};return n}),E.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},E.geolocation=function(){return"geolocation"in navigator},E.csstransforms3d=function(){var e=!!l("perspective");return e&&"webkitPerspective"in m.style&&I("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e},E.csstransitions=function(){return l("transition")},E.video=function(){var e=t.createElement("video"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),i.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),i.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(n){}return i},E.audio=function(){var e=t.createElement("audio"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),i.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),i.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return i};for(var A in E)u(E,A)&&(d=A.toLowerCase(),p[d]=E[A](),C.push((p[d]?"":"no-")+d));return p.input||c(),p.addTest=function(e,t){if("object"==typeof e)for(var n in e)u(e,n)&&p.addTest(n,e[n]);else{if(e=e.toLowerCase(),p[e]!==i)return p;t="function"==typeof t?t():t,"undefined"!=typeof h&&h&&(m.className+=" "+(t?"":"no-")+e),p[e]=t}return p},n(""),v=b=null,function(e,t){function i(e,t){var i=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return i.innerHTML="x<style>"+t+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var e=y.elements;return"string"==typeof e?e.split(" "):e}function a(e){var t=v[e[m]];return t||(t={},g++,e[m]=g,v[g]=t),t}function r(e,i,n){if(i||(i=t),d)return i.createElement(e);n||(n=a(i));var r;return r=n.cache[e]?n.cache[e].cloneNode():h.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),!r.canHaveChildren||p.test(e)||r.tagUrn?r:n.frag.appendChild(r)}function o(e,i){if(e||(e=t),d)return e.createDocumentFragment();i=i||a(e);for(var r=i.frag.cloneNode(),o=0,s=n(),l=s.length;l>o;o++)r.createElement(s[o]);return r}function s(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(i){return y.shivMethods?r(i,e,t):t.createElem(i)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(y,t.frag)}function l(e){e||(e=t);var n=a(e);return y.shivCSS&&!c&&!n.hasCSS&&(n.hasCSS=!!i(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),d||s(e,n),e}var c,d,u="3.7.0",f=e.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,h=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",g=0,v={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",c="hidden"in e,d=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(i){c=!0,d=!0}}();var y={elements:f.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:u,shivCSS:f.shivCSS!==!1,supportsUnknownElements:d,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:l,createElement:r,createDocumentFragment:o};e.html5=y,l(t)}(this,t),p._version=f,p._prefixes=S,p._domPrefixes=x,p._cssomPrefixes=_,p.testProp=function(e){return o([e])},p.testAllProps=l,p.testStyles=I,p.prefixed=function(e,t,i){return t?l(e,t,i):l(e,"pfx")},m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(h?" js "+C.join(" "):""),p}(this,this.document),function(e,t,i){function n(e){return"[object Function]"==g.call(e)}function a(e){return"string"==typeof e}function r(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function s(){var e=v.shift();y=1,e?e.t?h(function(){("c"==e.t?f.injectCss:f.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),s()):y=0}function l(e,i,n,a,r,l,c){function d(t){if(!p&&o(u.readyState)&&(b.r=p=1,!y&&s(),u.onload=u.onreadystatechange=null,t)){"img"!=e&&h(function(){S.removeChild(u)},50);for(var n in T[i])T[i].hasOwnProperty(n)&&T[i][n].onload()}}var c=c||f.errorTimeout,u=t.createElement(e),p=0,g=0,b={t:n,s:i,e:r,a:l,x:c};1===T[i]&&(g=1,T[i]=[]),"object"==e?u.data=i:(u.src=i,u.type=e),u.width=u.height="0",u.onerror=u.onload=u.onreadystatechange=function(){d.call(this,g)},v.splice(a,0,b),"img"!=e&&(g||2===T[i]?(S.insertBefore(u,w?null:m),h(d,c)):T[i].push(u))}function c(e,t,i,n,r){return y=0,t=t||"j",a(e)?l("c"==t?_:$,e,t,this.i++,i,n,r):(v.splice(this.i++,0,e),1==v.length&&s()),this}function d(){var e=f;return e.loader={load:c,i:0},e}var u,f,p=t.documentElement,h=e.setTimeout,m=t.getElementsByTagName("script")[0],g={}.toString,v=[],y=0,b="MozAppearance"in p.style,w=b&&!!t.createRange().compareNode,S=w?p:m.parentNode,p=e.opera&&"[object Opera]"==g.call(e.opera),p=!!t.attachEvent&&!p,$=b?"object":p?"script":"img",_=p?"script":$,x=Array.isArray||function(e){return"[object Array]"==g.call(e)},E=[],T={},k={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};f=function(e){function t(e){var t,i,n,e=e.split("!"),a=E.length,r=e.pop(),o=e.length,r={url:r,origUrl:r,prefixes:e};for(i=0;o>i;i++)n=e[i].split("="),(t=k[n.shift()])&&(r=t(r,n));for(i=0;a>i;i++)r=E[i](r);return r}function o(e,a,r,o,s){var l=t(e),c=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(a&&(a=n(a)?a:a[e]||a[o]||a[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,a,r,o,s):(T[l.url]?l.noexec=!0:T[l.url]=1,r.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":i,l.noexec,l.attrs,l.timeout),(n(a)||n(c))&&r.load(function(){d(),a&&a(l.origUrl,s,o),c&&c(l.origUrl,s,o),T[l.url]=2})))}function s(e,t){function i(e,i){if(e){if(a(e))i||(u=function(){var e=[].slice.call(arguments);f.apply(this,e),p()}),o(e,u,t,0,c);else if(Object(e)===e)for(l in s=function(){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i}(),e)e.hasOwnProperty(l)&&(!i&&!--s&&(n(u)?u=function(){var e=[].slice.call(arguments);f.apply(this,e),p()}:u[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),p()}}(f[l])),o(e[l],u,t,l,c))}else!i&&p()}var s,l,c=!!e.test,d=e.load||e.both,u=e.callback||r,f=u,p=e.complete||r;i(c?e.yep:e.nope,!!d),d&&i(d)}var l,c,u=this.yepnope.loader;if(a(e))o(e,0,u,0);else if(x(e))for(l=0;l<e.length;l++)c=e[l],a(c)?o(c,0,u,0):x(c)?f(c):Object(c)===c&&s(c,u);else Object(e)===e&&s(e,u)},f.addPrefix=function(e,t){k[e]=t},f.addFilter=function(e){E.push(e)},f.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",u=function(){t.removeEventListener("DOMContentLoaded",u,0),t.readyState="complete"},0)),e.yepnope=d(),e.yepnope.executeStack=s,e.yepnope.injectJs=function(e,i,n,a,l,c){var d,u,p=t.createElement("script"),a=a||f.errorTimeout;p.src=e;for(u in n)p.setAttribute(u,n[u]);i=c?s:i||r,p.onreadystatechange=p.onload=function(){!d&&o(p.readyState)&&(d=1,i(),p.onload=p.onreadystatechange=null)},h(function(){d||(d=1,i(1))},a),l?p.onload():m.parentNode.insertBefore(p,m)},e.yepnope.injectCss=function(e,i,n,a,o,l){var c,a=t.createElement("link"),i=l?s:i||r;a.href=e,a.rel="stylesheet",a.type="text/css";for(c in n)a.setAttribute(c,n[c]);o||(m.parentNode.insertBefore(a,m),h(i,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},function(e){"undefined"==typeof WSDEBUG&&(window.WSDEBUG=!0);var t=function(){window.asyncWebshims||(window.asyncWebshims={cfg:[],ready:[]})},i=function(){window.jQuery&&(e(jQuery),e=function(){return window.webshims})};window.webshims={setOptions:function(){t(),window.asyncWebshims.cfg.push(arguments)},ready:function(){t(),window.asyncWebshims.ready.push(arguments)},activeLang:function(e){t(),window.asyncWebshims.lang=e},polyfill:function(e){t(),window.asyncWebshims.polyfill=e},_curScript:function(){var e,t,i,n=document.currentScript;if(WSDEBUG&&(n=!1),!n){try{throw new Error("")}catch(a){i=(a.sourceURL||a.stack||"").split("\n"),i=((i[i.length-1]||i[i.length-2]||"").match(/(?:fil|htt|wid|abo|app|res)(.)+/i)||[""])[0].replace(/[\:\s\(]+[\d\:\)\(\s]+$/,"")}for(e=document.scripts||document.getElementsByTagName("script"),t=0;t<e.length;t++)if(e[t].getAttribute("src")&&(n=e[t],"interactive"==e[t].readyState||i==e[t].src)){WSDEBUG&&(n.wsFoundCurrent=!0);break}}return n}()},window.webshim=window.webshims,window.webshims.timer=setInterval(i,0),i(),"function"==typeof define&&define.amd&&define.amd.jQuery&&define("polyfiller",["jquery"],e)}(function(e){"use strict";var t,i,n=window.webshims,a="dom-support",r=e.event.special,o=e([]),s=window.Modernizr,l=window.asyncWebshims,c=s.addTest,d=window.Object,u=function(e){return e+"\n//# sourceURL="+this.url};s.advancedObjectProperties=s.objectAccessor=s.ES5=!!("create"in d&&"seal"in d),!s.ES5||"toJSON"in Date.prototype||(s.ES5=!1),clearInterval(n.timer),i=e.support.hrefNormalized===!1?n._curScript.getAttribute("src",4):n._curScript.src,i=i.split("?")[0].slice(0,i.lastIndexOf("/")+1)+"shims/",e.extend(n,{version:"1.12.4",cfg:{waitReady:!0,loadStyles:!0,wsdoc:document,wspopover:{appendTo:"auto",hideOnBlur:!0},ajax:{},loadScript:function(t,i){e.ajax(e.extend({},f.ajax,{url:t,success:i,dataType:"script",cache:!0,global:!1,dataFilter:u}))},basePath:i},bugs:{},modules:{},features:{},featureList:[],setOptions:function(t,i){"string"==typeof t&&arguments.length>1?f[t]=e.isPlainObject(i)?e.extend(!0,f[t]||{},i):i:"object"==typeof t&&e.extend(!0,f,t)},addPolyfill:function(t,i){i=i||{};var a=i.f||t;p[a]||(p[a]=[],n.featureList.push(a),f[a]={}),!p[a].failedM&&i.nM&&e.each(i.nM.split(" "),function(e,t){return t in s?void 0:(p[a].failedM=t,!1)}),p[a].failedM&&(i.test=WSDEBUG?function(){return n.error("webshims needs Modernizr."+p[a].failedM+" to implement feature: "+a),!0}:!0),p[a].push(t),i.options=e.extend(f[a],i.options),w(t,i),i.methodNames&&e.each(i.methodNames,function(e,t){n.addMethodName(t)})},polyfill:function(){var e={};return function(t){if(t||(t=n.featureList,WSDEBUG&&n.warn("loading all features without specifing might be bad for performance")),"string"==typeof t&&(t=t.split(" ")),WSDEBUG)for(var i=0;i<t.length;i++)e[t[i]],e[t[i]]=!0;return n._polyfill(t)}}(),_polyfill:function(i){var a=[];t(),-1==e.inArray("forms",i)&&-1!==e.inArray("forms-ext",i)&&(i.push("forms"),WSDEBUG&&n.error("need to load forms feature to use forms-ext feature.")),f.waitReady&&(e.readyWait++,m(i,function(){e.ready(!0)})),e.each(i,function(e,t){return p[t]?(t!==p[t][0]&&m(p[t],function(){h(t,!0)}),void(a=a.concat(p[t]))):(WSDEBUG&&n.error("could not find webshims-feature (aborted): "+t),void h(t,!0))}),f.loadStyles&&y.loadCSS("styles/shim.css"),b(a)},reTest:function(){var t,i=function(i,n){var a,o=v[n],s=n+"Ready";!o||o.loaded||(o.test&&e.isFunction(o.test)?o.test([]):o.test)||(r[s]&&delete r[s],a=p[o.f],t.push(n))};return function(n){"string"==typeof n&&(n=n.split(" ")),t=[],e.each(n,i),b(t)}}(),isReady:function(t,i){if(t+="Ready",i){if(r[t]&&r[t].add)return!0;r[t]=e.extend(r[t]||{},{add:function(e){e.handler.call(this,t)}}),e(document).triggerHandler(t)}return!(!r[t]||!r[t].add)||!1},ready:function(t,i){var a=arguments[2];if("string"==typeof t&&(t=t.split(" ")),a||(t=e.map(e.grep(t,function(e){return!h(e)}),function(e){return e+"Ready"})),!t.length)return void i(e,n,window,document);var r=t.shift(),o=function(){m(t,i,!0)};e(document).one(r,o)},capturingEvents:function(t,i){document.addEventListener&&("string"==typeof t&&(t=[t]),e.each(t,function(t,a){var o=function(t){return t=e.event.fix(t),i&&n.capturingEventPrevented&&n.capturingEventPrevented(t),e.event.dispatch.call(this,t)};r[a]=r[a]||{},r[a].setup||r[a].teardown||e.extend(r[a],{setup:function(){this.addEventListener(a,o,!0)},teardown:function(){this.removeEventListener(a,o,!0)}})}))},register:function(t,i){var a=v[t];if(!a)return void n.error("can't find module: "+t);a.loaded=!0;var r=function(){i(e,n,window,document,void 0,a.options),h(t,!0)};a.d&&a.d.length?m(a.d,r):r()},c:{},loader:{addModule:function(t,i){v[t]=i,i.name=i.name||t,i.c||(i.c=[]),e.each(i.c,function(e,i){n.c[i]||(n.c[i]=[]),n.c[i].push(t)})},loadList:function(){var t=[],i=function(i,n){"string"==typeof n&&(n=[n]),e.merge(t,n),y.loadScript(i,!1,n)},a=function(i,n){if(h(i)||-1!=e.inArray(i,t))return!0;{var a,r=v[i];f[r.f||i]||{}}return r?(a=r.test&&e.isFunction(r.test)?r.test(n):r.test,a?(h(i,!0),!0):!1):!0},r=function(t,i){if(t.d&&t.d.length){var n=function(t,n){a(n,i)||-1!=e.inArray(n,i)||i.push(n)};e.each(t.d,function(t,i){v[i]?v[i].loaded||n(t,i):p[i]&&(e.each(p[i],n),m(p[i],function(){h(i,!0)}))}),t.noAutoCallback||(t.noAutoCallback=!0)}};return function(o){var s,l,c,d,u=[],p=function(a,r){return d=r,e.each(n.c[r],function(i,n){return-1==e.inArray(n,u)||-1!=e.inArray(n,t)?(d=!1,!1):void 0}),d?(i("combos/"+d,n.c[d]),!1):void 0};for(l=0;l<o.length;l++)s=v[o[l]],s&&!a(s.name,o)?(s.css&&f.loadStyles&&y.loadCSS(s.css),s.loadInit&&s.loadInit(),r(s,o),s.loaded||u.push(s.name),s.loaded=!0):WSDEBUG&&!s&&n.warn("could not find: "+o[l]);for(l=0,c=u.length;c>l;l++)d=!1,s=u[l],-1==e.inArray(s,t)&&("noCombo"!=f.debug&&e.each(v[s].c,p),d||i(v[s].src||s,s))}}(),makePath:function(e){return-1!=e.indexOf("//")||0===e.indexOf("/")?e:(-1==e.indexOf(".")&&(e+=".js"),f.addCacheBuster&&(e+=f.addCacheBuster),f.basePath+e)},loadCSS:function(){var t,i={};return function(n){n=this.makePath(n),i[n]||(t=t||e("link, style")[0]||e("script")[0],i[n]=1,e('<link rel="stylesheet" />').insertBefore(t).attr({href:n}))}}(),loadScript:function(){var t={};return function(i,n,a,r){if(r||(i=y.makePath(i)),!t[i]){var o=function(){n&&n(),a&&("string"==typeof a&&(a=a.split(" ")),e.each(a,function(e,t){v[t]&&(v[t].afterLoad&&v[t].afterLoad(),h(v[t].noAutoCallback?t+"FileLoaded":t,!0))}))};t[i]=1,f.loadScript(i,o,e.noop)}}}()}}),e.webshims=n;var f=n.cfg,p=n.features,h=n.isReady,m=n.ready,g=n.addPolyfill,v=n.modules,y=n.loader,b=y.loadList,w=y.addModule,S=n.bugs,$=[],_={warn:1,error:1};return n.addMethodName=function(t){t=t.split(":");var i=t[1];1==t.length?(i=t[0],t=t[0]):t=t[0],e.fn[t]=function(){return this.callProp(i,arguments)}},e.fn.callProp=function(t,i){var a;return i||(i=[]),this.each(function(){var r=e.prop(this,t);if(r&&r.apply){if(a=r.apply(this,i),void 0!==a)return!1}else n.warn(t+" is not a method of "+this)}),void 0!==a?a:this},n.activeLang=function(){var t=e("html").attr("lang")||navigator.browserLanguage||navigator.language||"";return m("webshimLocalization",function(){n.activeLang(t)}),function(e){if(e)if("string"==typeof e)t=e;else if("object"==typeof e){var i=arguments,a=this;m("webshimLocalization",function(){n.activeLang.apply(a,i)})}return t}}(),n.errorLog=[],e.each(["log","error","warn","info"],function(e,t){n[t]=function(e){(_[t]&&f.debug!==!1||f.debug)&&(n.errorLog.push(e),window.console&&console.log&&console[console[t]?t:"log"](e))}}),WSDEBUG&&(n._curScript.wsFoundCurrent||n.error("Could not detect currentScript! Use basePath to set script path.")),function(){e.isDOMReady=e.isReady;var i=function(){e.isDOMReady=!0,h("DOM",!0),setTimeout(function(){h("WINDOWLOAD",!0)},9999)};t=function(){if(!t.run){if((f.debug||!("crossDomain"in f.ajax)&&location.protocol.indexOf("http"))&&(f.ajax.crossDomain=!0),e.mobile&&(e.mobile.textinput||e.mobile.rangeslider||e.mobile.button)&&(WSDEBUG&&n.warn('jQM textinput/rangeslider/button detected waitReady was set to false. Use webshims.ready("featurename") to script against polyfilled methods/properties'),f.readyEvt||(f.readyEvt="pageinit"),f.waitReady=!1),WSDEBUG&&f.waitReady&&e.isReady&&n.warn("Call webshims.polyfill before DOM-Ready or set waitReady to false."),!e.isDOMReady&&f.waitReady){var a=e.ready;e.ready=function(t){return t!==!0&&document.body&&(i(),e.ready=a),a.apply(this,arguments)},e.ready.promise=a.promise}f.readyEvt?e(document).one(f.readyEvt,i):e(i)}t.run=!0},e(window).on("load",function(){i(),setTimeout(function(){h("WINDOWLOAD",!0)},9)});var a=[],r=function(){1==this.nodeType&&n.triggerDomUpdate(this)};e.extend(n,{addReady:function(e){var t=function(t,i){n.ready("DOM",function(){e(t,i)})};a.push(t),f.wsdoc&&t(f.wsdoc,o)},triggerDomUpdate:function(t){if(!t||!t.nodeType)return void(t&&t.jquery&&t.each(function(){n.triggerDomUpdate(this)}));var i=t.nodeType;if(1==i||9==i){var r=t!==document?e(t):o;e.each(a,function(e,i){i(t,r)})}}}),e.fn.htmlPolyfill=function(t){var i=e.fn.html.call(this,t);return i===this&&e.isDOMReady&&this.each(r),i},e.fn.jProp=function(){return this.pushStack(e(e.fn.prop.apply(this,arguments)||[]))},e.each(["after","before","append","prepend","replaceWith"],function(t,i){e.fn[i+"Polyfill"]=function(t){return t=e(t),e.fn[i].call(this,t),e.isDOMReady&&t.each(r),this}}),e.each(["insertAfter","insertBefore","appendTo","prependTo","replaceAll"],function(t,i){e.fn[i.replace(/[A-Z]/,function(e){return"Polyfill"+e})]=function(){return e.fn[i].apply(this,arguments),e.isDOMReady&&n.triggerDomUpdate(this),this}}),e.fn.updatePolyfill=function(){return e.isDOMReady&&n.triggerDomUpdate(this),this},e.each(["getNativeElement","getShadowElement","getShadowFocusElement"],function(t,i){e.fn[i]=function(){return this.pushStack(this)}})}(),WSDEBUG&&(f.debug=!0),function(){var t="defineProperty",i=d.prototype.hasOwnProperty,a=["configurable","enumerable","writable"],r=function(e){for(var t=0;3>t;t++)void 0!==e[a[t]]||"writable"===a[t]&&void 0===e.value||(e[a[t]]=!0)},o=function(e){if(e)for(var t in e)i.call(e,t)&&r(e[t])};d.create&&(n.objectCreate=function(t,i,n){o(i);var a=d.create(t,i);return n&&(a.options=e.extend(!0,{},a.options||{},n),n=a.options),a._create&&e.isFunction(a._create)&&a._create(n),a}),d[t]&&(n[t]=function(e,i,n){return r(n),d[t](e,i,n)}),d.defineProperties&&(n.defineProperties=function(e,t){return o(t),d.defineProperties(e,t)}),n.getOwnPropertyDescriptor=d.getOwnPropertyDescriptor,n.getPrototypeOf=d.getPrototypeOf}(),w("swfmini",{test:function(){return window.swfobject&&!window.swfmini&&(window.swfmini=window.swfobject),"swfmini"in window},c:[16,7,2,8,1,12,19,25,23,27]}),v.swfmini.test(),w("sizzle",{test:e.expr.filters}),w("jajax",{test:e.ajax}),g("es5",{test:!(!s.ES5||!Function.prototype.bind),c:[18,19,25,20,32]}),g("dom-extend",{f:a,noAutoCallback:!0,d:["es5"],c:[16,7,2,15,30,3,8,4,9,10,25,19,20,26,31]}),g("geolocation",{test:s.geolocation,options:{destroyWrite:!0},d:["json-storage"],c:[21],nM:"geolocation"}),function(){g("canvas",{src:"excanvas",test:s.canvas,options:{type:"flash"},noAutoCallback:!0,loadInit:function(){var e=this.options.type;!e||-1===e.indexOf("flash")||v.swfmini.test()&&!swfmini.hasFlashPlayerVersion("9.0.0")||(this.src="flash"==e?"FlashCanvas/flashcanvas":"FlashCanvasPro/flashcanvas")},methodNames:["getContext"],d:[a],nM:"canvas"})}(),function(){var t,i,r,o="form-shim-extend",l=s.input,d=s.inputtypes,u="formvalidation",p="form-number-date-api",h=!1,m=!1,y=function(){var i,n;if(!y.run){if(n=e('<fieldset><textarea required="" /></fieldset>')[0],c(u,!(!l.required||!l.pattern)),c("fieldsetelements",i="elements"in n),"disabled"in n){if(!i)try{e("textarea",n).is(":invalid")&&(n.disabled=!0,i=e("textarea",n).is(":valid"))}catch(a){}c("fieldsetdisabled",i)}s[u]?(m=!(s.fieldsetdisabled&&s.fieldsetelements&&"value"in document.createElement("progress")&&"value"in document.createElement("output")),S.bustedValidity=h=window.opera||S.bustedValidity||m||!l.list):S.bustedValidity=!1,t=s[u]&&!h?"form-native-extend":o}return y.run=!0,!1};document.createElement("datalist"),n.validationMessages=n.validityMessages={langSrc:"i18n/formcfg-",availableLangs:["ar","cs","el","es","fr","he","hi","hu","it","ja","lt","nl","pl","pt","pt-BR","pt-PT","ru","sv","zh-CN"]},n.formcfg=e.extend({},n.validationMessages),n.inputTypes={},g("form-core",{f:"forms",d:["es5"],test:y,options:{placeholderType:"value",messagePopover:{},list:{popover:{constrainWidth:!0}},iVal:{sel:".ws-validate",handleBubble:"hide",recheckDelay:400}},methodNames:["setCustomValidity","checkValidity","setSelectionRange"],c:[16,7,2,8,1,15,30,3,31],nM:"input"}),i=f.forms,g("form-native-extend",{f:"forms",test:function(t){return!s[u]||h||-1==e.inArray(p,t||[])||v[p].test()},d:["form-core",a,"form-message"],c:[6,5,14,29]}),g(o,{f:"forms",test:function(){return s[u]&&!h},d:["form-core",a,"sizzle"],c:[16,15,24,28]}),g(o+"2",{f:"forms",test:function(){return s[u]&&!m},d:[o],c:[24]}),g("form-message",{f:"forms",test:function(e){return!(i.customMessages||!s[u]||h||!v[t].test(e))},d:[a],c:[16,7,15,30,3,8,4,14,28]}),r={noAutoCallback:!0,options:i},w("form-validation",e.extend({d:["form-message","form-core"]},r)),w("form-validators",e.extend({},r)),g(p,{f:"forms-ext",options:{types:"date time range number"},test:function(){var t=!0,i=this.options;return i._types||(i._types=i.types.split(" ")),y(),e.each(i._types,function(e,i){return i in d&&!d[i]?(t=!1,!1):void 0}),t},methodNames:["stepUp","stepDown"],d:["forms",a],c:[6,5,18,17,14,28,29,32,33],nM:"input inputtypes"}),w("range-ui",{options:{},noAutoCallback:!0,test:function(){return!!e.fn.rangeUI},d:["es5"],c:[6,5,9,10,18,17,11]}),g("form-number-date-ui",{f:"forms-ext",test:function(){var e=this.options;return y(),m&&!e.replaceUI&&/Android/i.test(navigator.userAgent)&&(e.replaceUI=!0),!e.replaceUI&&v[p].test()},d:["forms",a,p,"range-ui"],css:"styles/forms-ext.css",options:{widgets:{calculateWidth:!0,animate:!0}},c:[6,5,9,10,18,17,11]}),g("form-datalist",{f:"forms",test:function(){return y(),l.list&&!i.fD},d:["form-core",a],c:[16,7,6,2,9,15,30,31,28,32,33]})}(),g("filereader",{test:"FileReader"in window,d:["swfmini",a],c:[25,26,27]}),"details"in s||c("details",function(){return"open"in document.createElement("details")}),g("details",{test:s.details,d:[a],options:{text:"Details"},c:[21,22]}),function(){n.mediaelement={},c({texttrackapi:"addTextTrack"in document.createElement("video"),track:"kind"in document.createElement("track")}),g("mediaelement-core",{f:"mediaelement",noAutoCallback:!0,options:{preferFlash:!1,vars:{},params:{},attrs:{},changeSWF:e.noop},methodNames:["play","pause","canPlayType","mediaLoad:load"],d:["swfmini"],c:[16,7,2,8,1,12,13,19,25,20,23],nM:"audio video"}),g("mediaelement-jaris",{f:"mediaelement",d:["mediaelement-core","swfmini",a],test:function(){var e=this.options;return s.audio&&s.video&&!n.mediaelement.loadSwf?(e.preferFlash&&!v.swfmini.test()&&(e.preferFlash=!1),!(e.preferFlash&&swfmini.hasFlashPlayerVersion("10.0.3"))):!1},c:[21,19,25,20]}),S.track=!window.TextTrackCue||!s.texttrackapi,g("track",{options:{positionDisplay:!0,override:S.track},test:function(){return!this.options.override&&!S.track},d:["mediaelement",a],methodNames:["addTextTrack"],c:[21,12,13,22]}),w("track-ui",{d:["track",a]})}(),g("feature-dummy",{test:!0,loaded:!0,c:$}),n.$=e,n.M=s,window.webshims=n,n.callAsync=function(){n.callAsync=e.noop,e(document.scripts||"script").filter("[data-polyfill-cfg]").each(function(){try{n.setOptions(e(this).data("polyfillCfg"))}catch(t){n.warn("error parsing polyfill cfg: "+t)}}).end().filter("[data-polyfill]").each(function(){n.polyfill(e.trim(e(this).data("polyfill")||""))}),l&&(l.cfg&&(l.cfg.length||(l.cfg=[[l.cfg]]),e.each(l.cfg,function(e,t){n.setOptions.apply(n,t)})),l.ready&&e.each(l.ready,function(e,t){n.ready.apply(n,t)}),l.lang&&n.activeLang(l.lang),"polyfill"in l&&n.polyfill(l.polyfill)),n.isReady("jquery",!0)},n.callAsync(),n}),function(e,t,i){"use strict";function n(e,i,n,a){for(var r=[],o=0;o<e.length;o++){var s=e[o];if(s){var l=tinycolor(s),c=l.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(i,s)?" sp-thumb-active":"";var d=l.toString(a.preferredFormat||"rgb"),u=g?"background-color:"+l.toRgbString():"filter:"+l.toFilter();r.push('<span title="'+d+'" data-color="'+l.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+u+';" /></span>')}else{var f="sp-clear-display";r.push(t("<div />").append(t('<span data-color="" style="background-color:transparent;" class="'+f+'"></span>').attr("title",a.noColorSelectedText)).html())}}return"<div class='sp-cf "+n+"'>"+r.join("")+"</div>"}function a(){for(var e=0;e<h.length;e++)h[e]&&h[e].hide()}function r(e,i){var n=t.extend({},p,e);return n.callbacks={move:d(n.move,i),change:d(n.change,i),show:d(n.show,i),hide:d(n.hide,i),beforeShow:d(n.beforeShow,i)},n}function o(o,l){function d(){if(G.showPaletteOnly&&(G.showPalette=!0),Mt.text(G.showPaletteOnly?G.togglePaletteMoreText:G.togglePaletteLessText),G.palette){dt=G.palette.slice(0),ut=t.isArray(dt[0])?dt:[dt],ft={};for(var e=0;e<ut.length;e++)for(var i=0;i<ut[e].length;i++){var n=tinycolor(ut[e][i]).toRgbString();ft[n]=!0}}wt.toggleClass("sp-flat",B),wt.toggleClass("sp-input-disabled",!G.showInput),wt.toggleClass("sp-alpha-enabled",G.showAlpha),wt.toggleClass("sp-clear-enabled",Jt),wt.toggleClass("sp-buttons-disabled",!G.showButtons),wt.toggleClass("sp-palette-buttons-disabled",!G.togglePaletteOnly),wt.toggleClass("sp-palette-disabled",!G.showPalette),wt.toggleClass("sp-palette-only",G.showPaletteOnly),wt.toggleClass("sp-initial-disabled",!G.showInitial),wt.addClass(G.className).addClass(G.containerClassName),W()}function p(){function e(e){return e.data&&e.data.ignore?(A(t(e.target).closest(".sp-thumb-el").data("color")),M()):(A(t(e.target).closest(".sp-thumb-el").data("color")),M(),j(!0),G.hideAfterPaletteSelect&&I()),!1}if(m&&wt.find("*:not(input)").attr("unselectable","on"),d(),jt&&yt.after(Wt).hide(),Jt||Rt.hide(),B)yt.after(wt).hide();else{var i="parent"===G.appendTo?yt.parent():t(G.appendTo);1!==i.length&&(i=t("body")),i.append(wt)}w(),Ut.bind("click.spectrum touchstart.spectrum",function(e){bt||C(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(yt.is(":disabled")||G.disabled===!0)&&H(),wt.click(c),Pt.change(k),Pt.bind("paste",function(){setTimeout(k,1)}),Pt.keydown(function(e){13==e.keyCode&&k()}),At.text(G.cancelText),At.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),I("cancel")}),Rt.attr("title",G.clearText),Rt.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),qt=!0,M(),B&&j(!0)}),Ft.text(G.chooseText),Ft.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),F()&&(j(!0),I())}),Mt.text(G.showPaletteOnly?G.togglePaletteMoreText:G.togglePaletteLessText),Mt.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),G.showPaletteOnly=!G.showPaletteOnly,G.showPaletteOnly||B||wt.css("left","-="+(St.outerWidth(!0)+5)),d()}),u(kt,function(e,t,i){ct=e/nt,qt=!1,i.shiftKey&&(ct=Math.round(10*ct)/10),M()},E,T),u(xt,function(e,t){ot=parseFloat(t/tt),qt=!1,G.showAlpha||(ct=1),M()},E,T),u($t,function(e,t,i){if(i.shiftKey){if(!gt){var n=st*K,a=Z-lt*Z,r=Math.abs(e-n)>Math.abs(t-a);gt=r?"x":"y"}}else gt=null;var o=!gt||"x"===gt,s=!gt||"y"===gt;o&&(st=parseFloat(e/K)),s&&(lt=parseFloat((Z-t)/Z)),qt=!1,G.showAlpha||(ct=1),M()},E,T),Lt?(A(Lt),D(),Bt=Gt||tinycolor(Lt).format,S(Lt)):D(),B&&P();var n=m?"mousedown.spectrum":"click.spectrum touchstart.spectrum";It.delegate(".sp-thumb-el",n,e),Ot.delegate(".sp-thumb-el:nth-child(1)",n,{ignore:!0},e)}function w(){if(q&&e.localStorage){try{var i=e.localStorage[q].split(",#");i.length>1&&(delete e.localStorage[q],t.each(i,function(e,t){S(t)}))}catch(n){}try{pt=e.localStorage[q].split(";")}catch(n){}}}function S(i){if(V){var n=tinycolor(i).toRgbString();if(!ft[n]&&-1===t.inArray(n,pt))for(pt.push(n);pt.length>ht;)pt.shift();if(q&&e.localStorage)try{e.localStorage[q]=pt.join(";")}catch(a){}}}function $(){var e=[];if(G.showPalette)for(var t=0;t<pt.length;t++){var i=tinycolor(pt[t]).toRgbString();ft[i]||e.push(pt[t])}return e.reverse().slice(0,G.maxSelectionSize)}function _(){var e=R(),i=t.map(ut,function(t,i){return n(t,e,"sp-palette-row sp-palette-row-"+i,G)});w(),pt&&i.push(n($(),e,"sp-palette-row sp-palette-row-selection",G)),It.html(i.join(""))}function x(){if(G.showInitial){var e=Ht,t=R();Ot.html(n([e,t],t,"sp-palette-row-initial",G))}}function E(){(0>=Z||0>=K||0>=tt)&&W(),wt.addClass(mt),gt=null,yt.trigger("dragstart.spectrum",[R()])}function T(){wt.removeClass(mt),yt.trigger("dragstop.spectrum",[R()])}function k(){var e=Pt.val();if(null!==e&&""!==e||!Jt){var t=tinycolor(e);t.isValid()?(A(t),j(!0)):Pt.addClass("sp-validation-error")}else A(null),j(!0)}function C(){Y?I():P()}function P(){var i=t.Event("beforeShow.spectrum");return Y?void W():(yt.trigger(i,[R()]),void(X.beforeShow(R())===!1||i.isDefaultPrevented()||(a(),Y=!0,t(vt).bind("click.spectrum",I),t(e).bind("resize.spectrum",Q),Wt.addClass("sp-active"),wt.removeClass("sp-hidden"),W(),D(),Ht=R(),x(),X.show(Ht),yt.trigger("show.spectrum",[Ht]))))}function I(i){if((!i||"click"!=i.type||2!=i.button)&&Y&&!B){Y=!1,t(vt).unbind("click.spectrum",I),t(e).unbind("resize.spectrum",Q),Wt.removeClass("sp-active"),wt.addClass("sp-hidden");var n=!tinycolor.equals(R(),Ht);n&&(Vt&&"cancel"!==i?j(!0):O()),X.hide(R()),yt.trigger("hide.spectrum",[R()])}}function O(){A(Ht,!0)}function A(e,t){if(tinycolor.equals(e,R()))return void D();var i,n;!e&&Jt?qt=!0:(qt=!1,i=tinycolor(e),n=i.toHsv(),ot=n.h%360/360,st=n.s,lt=n.v,ct=n.a),D(),i&&i.isValid()&&!t&&(Bt=Gt||i.getFormat())}function R(e){return e=e||{},Jt&&qt?null:tinycolor.fromRatio({h:ot,s:st,v:lt,a:Math.round(100*ct)/100},{format:e.format||Bt})}function F(){return!Pt.hasClass("sp-validation-error")}function M(){D(),X.move(R()),yt.trigger("move.spectrum",[R()])}function D(){Pt.removeClass("sp-validation-error"),N();var e=tinycolor.fromRatio({h:ot,s:1,v:1});$t.css("background-color",e.toHexString());var t=Bt;1>ct&&(0!==ct||"name"!==t)&&("hex"===t||"hex3"===t||"hex6"===t||"name"===t)&&(t="rgb");var i=R({format:t}),n="";if(zt.removeClass("sp-clear-display"),zt.css("background-color","transparent"),!i&&Jt)zt.addClass("sp-clear-display");else{var a=i.toHexString(),r=i.toRgbString();if(g||1===i.alpha?zt.css("background-color",r):(zt.css("background-color","transparent"),zt.css("filter",i.toFilter())),G.showAlpha){var o=i.toRgb();o.a=0;var s=tinycolor(o).toRgbString(),l="linear-gradient(left, "+s+", "+a+")";
m?Tt.css("filter",tinycolor(s).toFilter({gradientType:1},a)):(Tt.css("background","-webkit-"+l),Tt.css("background","-moz-"+l),Tt.css("background","-ms-"+l),Tt.css("background","linear-gradient(to right, "+s+", "+a+")"))}n=i.toString(t)}G.showInput&&Pt.val(n),G.showPalette&&_(),x()}function N(){var e=st,t=lt;if(Jt&&qt)Ct.hide(),Et.hide(),_t.hide();else{Ct.show(),Et.show(),_t.show();var i=e*K,n=Z-t*Z;i=Math.max(-et,Math.min(K-et,i-et)),n=Math.max(-et,Math.min(Z-et,n-et)),_t.css({top:n+"px",left:i+"px"});var a=ct*nt;Ct.css({left:a-at/2+"px"});var r=ot*tt;Et.css({top:r-rt+"px"})}}function j(e){var t=R(),i="",n=!tinycolor.equals(t,Ht);t&&(i=t.toString(Bt),S(t)),Dt&&yt.val(i),Ht=t,e&&n&&(X.change(t),yt.trigger("change",[t]))}function W(){K=$t.width(),Z=$t.height(),et=_t.height(),it=xt.width(),tt=xt.height(),rt=Et.height(),nt=kt.width(),at=Ct.width(),B||(wt.css("position","absolute"),wt.offset(s(wt,Ut))),N(),G.showPalette&&_(),yt.trigger("reflow.spectrum")}function U(){yt.show(),Ut.unbind("click.spectrum touchstart.spectrum"),wt.remove(),Wt.remove(),h[Xt.id]=null}function z(e,n){return e===i?t.extend({},G):n===i?G[e]:(G[e]=n,void d())}function L(){bt=!1,yt.attr("disabled",!1),Ut.removeClass("sp-disabled")}function H(){I(),bt=!0,yt.attr("disabled",!0),Ut.addClass("sp-disabled")}var G=r(l,o),B=G.flat,V=G.showSelectionPalette,q=G.localStorageKey,J=G.theme,X=G.callbacks,Q=f(W,10),Y=!1,K=0,Z=0,et=0,tt=0,it=0,nt=0,at=0,rt=0,ot=0,st=0,lt=0,ct=1,dt=[],ut=[],ft={},pt=G.selectionPalette.slice(0),ht=G.maxSelectionSize,mt="sp-dragging",gt=null,vt=o.ownerDocument,yt=(vt.body,t(o)),bt=!1,wt=t(b,vt).addClass(J),St=wt.find(".sp-picker-container"),$t=wt.find(".sp-color"),_t=wt.find(".sp-dragger"),xt=wt.find(".sp-hue"),Et=wt.find(".sp-slider"),Tt=wt.find(".sp-alpha-inner"),kt=wt.find(".sp-alpha"),Ct=wt.find(".sp-alpha-handle"),Pt=wt.find(".sp-input"),It=wt.find(".sp-palette"),Ot=wt.find(".sp-initial"),At=wt.find(".sp-cancel"),Rt=wt.find(".sp-clear"),Ft=wt.find(".sp-choose"),Mt=wt.find(".sp-palette-toggle"),Dt=yt.is("input"),Nt=Dt&&v&&"color"===yt.attr("type"),jt=Dt&&!B,Wt=jt?t(y).addClass(J).addClass(G.className).addClass(G.replacerClassName):t([]),Ut=jt?Wt:yt,zt=Wt.find(".sp-preview-inner"),Lt=G.color||Dt&&yt.val(),Ht=!1,Gt=G.preferredFormat,Bt=Gt,Vt=!G.showButtons||G.clickoutFiresChange,qt=!Lt,Jt=G.allowEmpty&&!Nt;p();var Xt={show:P,hide:I,toggle:C,reflow:W,option:z,enable:L,disable:H,set:function(e){A(e),j()},get:R,destroy:U,container:wt};return Xt.id=h.push(Xt)-1,Xt}function s(e,i){var n=0,a=e.outerWidth(),r=e.outerHeight(),o=i.outerHeight(),s=e[0].ownerDocument,l=s.documentElement,c=l.clientWidth+t(s).scrollLeft(),d=l.clientHeight+t(s).scrollTop(),u=i.offset();return u.top+=o,u.left-=Math.min(u.left,u.left+a>c&&c>a?Math.abs(u.left+a-c):0),u.top-=Math.min(u.top,u.top+r>d&&d>r?Math.abs(r+o-n):n),u}function l(){}function c(e){e.stopPropagation()}function d(e,t){var i=Array.prototype.slice,n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}function u(i,n,a,r){function o(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function s(e){if(u){if(m&&document.documentMode<9&&!e.button)return c();var t=e.originalEvent.touches,a=t?t[0].pageX:e.pageX,r=t?t[0].pageY:e.pageY,s=Math.max(0,Math.min(a-f.left,h)),l=Math.max(0,Math.min(r-f.top,p));g&&o(e),n.apply(i,[s,l,e])}}function l(e){{var n=e.which?3==e.which:2==e.button;e.originalEvent.touches}n||u||a.apply(i,arguments)!==!1&&(u=!0,p=t(i).height(),h=t(i).width(),f=t(i).offset(),t(d).bind(v),t(d.body).addClass("sp-dragging"),g||s(e),o(e))}function c(){u&&(t(d).unbind(v),t(d.body).removeClass("sp-dragging"),r.apply(i,arguments)),u=!1}n=n||function(){},a=a||function(){},r=r||function(){};var d=i.ownerDocument||document,u=!1,f={},p=0,h=0,g="ontouchstart"in e,v={};v.selectstart=o,v.dragstart=o,v["touchmove mousemove"]=s,v["touchend mouseup"]=c,t(i).bind("touchstart mousedown",l)}function f(e,t,i){var n;return function(){var a=this,r=arguments,o=function(){n=null,e.apply(a,r)};i&&clearTimeout(n),(i||!n)&&(n=setTimeout(o,t))}}var p={beforeShow:l,move:l,change:l,show:l,hide:l,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1},h=[],m=!!/msie/i.exec(e.navigator.userAgent),g=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div"),i=t.style;return i.cssText="background-color:rgba(0,0,0,.5)",e(i.backgroundColor,"rgba")||e(i.backgroundColor,"hsla")}(),v=function(){var e=t("<input type='color' value='!' />")[0];return"color"===e.type&&"!"!==e.value}(),y=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),b=function(){var e="";if(m)for(var t=1;6>=t;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),w="spectrum.id";t.fn.spectrum=function(e){if("string"==typeof e){var i=this,n=Array.prototype.slice.call(arguments,1);return this.each(function(){var a=h[t(this).data(w)];if(a){var r=a[e];if(!r)throw new Error("Spectrum: no such method: '"+e+"'");"get"==e?i=a.get():"container"==e?i=a.container:"option"==e?i=a.option.apply(a,n):"destroy"==e?(a.destroy(),t(this).removeData(w)):r.apply(a,n)}}),i}return this.spectrum("destroy").each(function(){var i=t.extend({},e,t(this).data()),n=o(this,i);t(this).data(w,n.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=u,t.fn.spectrum.defaults=p,t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){v||t("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function t(e){var t={r:0,g:0,b:0},n=1,r=!1,s=!1;return"string"==typeof e&&(e=R(e)),"object"==typeof e&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(t=i(e.r,e.g,e.b),r=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=I(e.s),e.v=I(e.v),t=o(e.h,e.s,e.v),r=!0,s="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=I(e.s),e.l=I(e.l),t=a(e.h,e.s,e.l),r=!0,s="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=_(n),{ok:r,format:e.format||s,r:W(255,U(t.r,0)),g:W(255,U(t.g,0)),b:W(255,U(t.b,0)),a:n}}function i(e,t,i){return{r:255*x(e,255),g:255*x(t,255),b:255*x(i,255)}}function n(e,t,i){e=x(e,255),t=x(t,255),i=x(i,255);var n,a,r=U(e,t,i),o=W(e,t,i),s=(r+o)/2;if(r==o)n=a=0;else{var l=r-o;switch(a=s>.5?l/(2-r-o):l/(r+o),r){case e:n=(t-i)/l+(i>t?6:0);break;case t:n=(i-e)/l+2;break;case i:n=(e-t)/l+4}n/=6}return{h:n,s:a,l:s}}function a(e,t,i){function n(e,t,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?e+6*(t-e)*i:.5>i?t:2/3>i?e+(t-e)*(2/3-i)*6:e}var a,r,o;if(e=x(e,360),t=x(t,100),i=x(i,100),0===t)a=r=o=i;else{var s=.5>i?i*(1+t):i+t-i*t,l=2*i-s;a=n(l,s,e+1/3),r=n(l,s,e),o=n(l,s,e-1/3)}return{r:255*a,g:255*r,b:255*o}}function r(e,t,i){e=x(e,255),t=x(t,255),i=x(i,255);var n,a,r=U(e,t,i),o=W(e,t,i),s=r,l=r-o;if(a=0===r?0:l/r,r==o)n=0;else{switch(r){case e:n=(t-i)/l+(i>t?6:0);break;case t:n=(i-e)/l+2;break;case i:n=(e-t)/l+4}n/=6}return{h:n,s:a,v:s}}function o(e,t,i){e=6*x(e,360),t=x(t,100),i=x(i,100);var n=N.floor(e),a=e-n,r=i*(1-t),o=i*(1-a*t),s=i*(1-(1-a)*t),l=n%6,c=[i,o,r,r,s,i][l],d=[s,i,i,o,r,r][l],u=[r,r,s,i,i,o][l];return{r:255*c,g:255*d,b:255*u}}function s(e,t,i,n){var a=[P(j(e).toString(16)),P(j(t).toString(16)),P(j(i).toString(16))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function l(e,t,i,n){var a=[P(O(n)),P(j(e).toString(16)),P(j(t).toString(16)),P(j(i).toString(16))];return a.join("")}function c(e,t){t=0===t?0:t||10;var i=L(e).toHsl();return i.s-=t/100,i.s=E(i.s),L(i)}function d(e,t){t=0===t?0:t||10;var i=L(e).toHsl();return i.s+=t/100,i.s=E(i.s),L(i)}function u(e){return L(e).desaturate(100)}function f(e,t){t=0===t?0:t||10;var i=L(e).toHsl();return i.l+=t/100,i.l=E(i.l),L(i)}function p(e,t){t=0===t?0:t||10;var i=L(e).toRgb();return i.r=U(0,W(255,i.r-j(255*-(t/100)))),i.g=U(0,W(255,i.g-j(255*-(t/100)))),i.b=U(0,W(255,i.b-j(255*-(t/100)))),L(i)}function h(e,t){t=0===t?0:t||10;var i=L(e).toHsl();return i.l-=t/100,i.l=E(i.l),L(i)}function m(e,t){var i=L(e).toHsl(),n=(j(i.h)+t)%360;return i.h=0>n?360+n:n,L(i)}function g(e){var t=L(e).toHsl();return t.h=(t.h+180)%360,L(t)}function v(e){var t=L(e).toHsl(),i=t.h;return[L(e),L({h:(i+120)%360,s:t.s,l:t.l}),L({h:(i+240)%360,s:t.s,l:t.l})]}function y(e){var t=L(e).toHsl(),i=t.h;return[L(e),L({h:(i+90)%360,s:t.s,l:t.l}),L({h:(i+180)%360,s:t.s,l:t.l}),L({h:(i+270)%360,s:t.s,l:t.l})]}function b(e){var t=L(e).toHsl(),i=t.h;return[L(e),L({h:(i+72)%360,s:t.s,l:t.l}),L({h:(i+216)%360,s:t.s,l:t.l})]}function w(e,t,i){t=t||6,i=i||30;var n=L(e).toHsl(),a=360/i,r=[L(e)];for(n.h=(n.h-(a*t>>1)+720)%360;--t;)n.h=(n.h+a)%360,r.push(L(n));return r}function S(e,t){t=t||6;for(var i=L(e).toHsv(),n=i.h,a=i.s,r=i.v,o=[],s=1/t;t--;)o.push(L({h:n,s:a,v:r})),r=(r+s)%1;return o}function $(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t}function _(e){return e=parseFloat(e),(isNaN(e)||0>e||e>1)&&(e=1),e}function x(e,t){k(e)&&(e="100%");var i=C(e);return e=W(t,U(0,parseFloat(e))),i&&(e=parseInt(e*t,10)/100),N.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function E(e){return W(1,U(0,e))}function T(e){return parseInt(e,16)}function k(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)}function C(e){return"string"==typeof e&&-1!=e.indexOf("%")}function P(e){return 1==e.length?"0"+e:""+e}function I(e){return 1>=e&&(e=100*e+"%"),e}function O(e){return Math.round(255*parseFloat(e)).toString(16)}function A(e){return T(e)/255}function R(e){e=e.replace(F,"").replace(M,"").toLowerCase();var t=!1;if(H[e])e=H[e],t=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};var i;return(i=B.rgb.exec(e))?{r:i[1],g:i[2],b:i[3]}:(i=B.rgba.exec(e))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=B.hsl.exec(e))?{h:i[1],s:i[2],l:i[3]}:(i=B.hsla.exec(e))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=B.hsv.exec(e))?{h:i[1],s:i[2],v:i[3]}:(i=B.hex8.exec(e))?{a:A(i[1]),r:T(i[2]),g:T(i[3]),b:T(i[4]),format:t?"name":"hex8"}:(i=B.hex6.exec(e))?{r:T(i[1]),g:T(i[2]),b:T(i[3]),format:t?"name":"hex"}:(i=B.hex3.exec(e))?{r:T(i[1]+""+i[1]),g:T(i[2]+""+i[2]),b:T(i[3]+""+i[3]),format:t?"name":"hex"}:!1}var F=/^[\s,#]+/,M=/\s+$/,D=0,N=Math,j=N.round,W=N.min,U=N.max,z=N.random,L=function V(e,i){if(e=e?e:"",i=i||{},e instanceof V)return e;if(!(this instanceof V))return new V(e,i);var n=t(e);this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=j(100*this._a)/100,this._format=i.format||n.format,this._gradientType=i.gradientType,this._r<1&&(this._r=j(this._r)),this._g<1&&(this._g=j(this._g)),this._b<1&&(this._b=j(this._b)),this._ok=n.ok,this._tc_id=D++};L.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},setAlpha:function(e){return this._a=_(e),this._roundA=j(100*this._a)/100,this},toHsv:function(){var e=r(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=r(this._r,this._g,this._b),t=j(360*e.h),i=j(100*e.s),n=j(100*e.v);return 1==this._a?"hsv("+t+", "+i+"%, "+n+"%)":"hsva("+t+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=n(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=n(this._r,this._g,this._b),t=j(360*e.h),i=j(100*e.s),a=j(100*e.l);return 1==this._a?"hsl("+t+", "+i+"%, "+a+"%)":"hsla("+t+", "+i+"%, "+a+"%, "+this._roundA+")"},toHex:function(e){return s(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return l(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:j(this._r),g:j(this._g),b:j(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+j(this._r)+", "+j(this._g)+", "+j(this._b)+")":"rgba("+j(this._r)+", "+j(this._g)+", "+j(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:j(100*x(this._r,255))+"%",g:j(100*x(this._g,255))+"%",b:j(100*x(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+j(100*x(this._r,255))+"%, "+j(100*x(this._g,255))+"%, "+j(100*x(this._b,255))+"%)":"rgba("+j(100*x(this._r,255))+"%, "+j(100*x(this._g,255))+"%, "+j(100*x(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:G[s(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+l(this._r,this._g,this._b,this._a),i=t,n=this._gradientType?"GradientType = 1, ":"";if(e){var a=L(e);i=a.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=!1,n=this._a<1&&this._a>=0,a=!t&&n&&("hex"===e||"hex6"===e||"hex3"===e||"name"===e);return a?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(i=this.toRgbString()),"prgb"===e&&(i=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(i=this.toHexString()),"hex3"===e&&(i=this.toHexString(!0)),"hex8"===e&&(i=this.toHex8String()),"name"===e&&(i=this.toName()),"hsl"===e&&(i=this.toHslString()),"hsv"===e&&(i=this.toHsvString()),i||this.toHexString())},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(f,arguments)},brighten:function(){return this._applyModification(p,arguments)},darken:function(){return this._applyModification(h,arguments)},desaturate:function(){return this._applyModification(c,arguments)},saturate:function(){return this._applyModification(d,arguments)},greyscale:function(){return this._applyModification(u,arguments)},spin:function(){return this._applyModification(m,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(w,arguments)},complement:function(){return this._applyCombination(g,arguments)},monochromatic:function(){return this._applyCombination(S,arguments)},splitcomplement:function(){return this._applyCombination(b,arguments)},triad:function(){return this._applyCombination(v,arguments)},tetrad:function(){return this._applyCombination(y,arguments)}},L.fromRatio=function(e,t){if("object"==typeof e){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]="a"===n?e[n]:I(e[n]));e=i}return L(e,t)},L.equals=function(e,t){return e&&t?L(e).toRgbString()==L(t).toRgbString():!1},L.random=function(){return L.fromRatio({r:z(),g:z(),b:z()})},L.mix=function(e,t,i){i=0===i?0:i||50;var n,a=L(e).toRgb(),r=L(t).toRgb(),o=i/100,s=2*o-1,l=r.a-a.a;n=s*l==-1?s:(s+l)/(1+s*l),n=(n+1)/2;var c=1-n,d={r:r.r*n+a.r*c,g:r.g*n+a.g*c,b:r.b*n+a.b*c,a:r.a*o+a.a*(1-o)};return L(d)},L.readability=function(e,t){var i=L(e),n=L(t),a=i.toRgb(),r=n.toRgb(),o=i.getBrightness(),s=n.getBrightness(),l=Math.max(a.r,r.r)-Math.min(a.r,r.r)+Math.max(a.g,r.g)-Math.min(a.g,r.g)+Math.max(a.b,r.b)-Math.min(a.b,r.b);return{brightness:Math.abs(o-s),color:l}},L.isReadable=function(e,t){var i=L.readability(e,t);return i.brightness>125&&i.color>500},L.mostReadable=function(e,t){for(var i=null,n=0,a=!1,r=0;r<t.length;r++){var o=L.readability(e,t[r]),s=o.brightness>125&&o.color>500,l=3*(o.brightness/125)+o.color/500;(s&&!a||s&&a&&l>n||!s&&!a&&l>n)&&(a=s,n=l,i=L(t[r]))}return i};var H=L.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},G=L.hexNames=$(H),B=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",i="(?:"+t+")|(?:"+e+")",n="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?",a="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";return{rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+n),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();e.tinycolor=L}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})}(window,jQuery);var appModel=new Object,appSettings=new Object,appView=new Object;$(function(){appModel=Backbone.Model.extend({defaults:function(){return{}},urlRoot:"/apps/",initialize:function(){this.hasOwnProperty("isPreset")||this.set({isPreset:!0},{silent:!0}),this.setLocals({render_style_only:null})},triggerChange:function(){var e=this;debug("TriggerChange called"),"wix"==HOST&&"undefined"!=typeof APP_SETTINGS?(Wix.Settings.triggerSettingsUpdatedEvent(this.attributes,Wix.Utils.getOrigCompId()),this.setLocals({render_style_only:null})):"undefined"!=typeof INPAGE&&INPAGE&&"undefined"!=typeof FRAME_ORIGIN?(debug("Posting powr:update from base.js. Parent:",parent,"Frame origin: "+FRAME_ORIGIN),parent.postMessage({message:"update",data:{content:this.attributes,meta:this.meta}},FRAME_ORIGIN)):"weebly"==HOST?localStorage.setItem("powr_data_"+e.meta.id,JSON.stringify({content:e.attributes,meta:e.meta})):e.trigger("change")},updateWixStyles:function(){var e=this;"undefined"==typeof WIX_COLOR_CHANGE_TIMER?(e._updateWixStyles(),WIX_COLOR_CHANGE_TIMER=setTimeout(function(){},0)):(clearTimeout(WIX_COLOR_CHANGE_TIMER),WIX_COLOR_CHANGE_TIMER=setTimeout(function(){e._updateWixStyles()},500))},_updateWixStyles:function(){var e=this;for(var t in e.attributes)if(t.search("ColorWix")>-1){var i=e.attributes[t];if(null==i||0==i.length)continue;i=i.replace("/","-");var n=t.replace("Wix",""),a=$(".wix-style-reference ."+i).css("color");void 0!=a&&a.length>0&&(e.attributes[n]=a)}"undefined"!=typeof APP_VIEW&&(debug("Rendering view from _updateWixStyles"),APP_VIEW.render())},setLocals:function(e){var t=this.get("locals");void 0==t&&(t={});for(var i in e)t[i]=e[i];this.set({locals:t},{silent:!0})},setPresets:function(e,t){debug("Model setting presets");var i=this.presets(),n={};for(var a in i){var r=a,o=i[a];if(o.search("font")>-1)var s=t[this.get("fontPreset")];else var s=e[this.get("colorPreset")];if(void 0!=s){var l=s[o];n[r]=l}}this.set(n,{silent:!0})},doSave:function(e){function t(){("wix"==HOST||"weebly"==HOST)&&(debug("Save fail. Trying to save again in "+AUTO_SAVE_TIME),"undefined"==typeof AUTO_RESAVE?null:clearTimeout(AUTO_RESAVE),AUTO_RESAVE=setTimeout(function(){i.doSave()},AUTO_SAVE_TIME))}var i=this;if("undefined"!=typeof e&&e.settings)var n=e.settings;else var n="undefined"==typeof APP_SETTINGS?null:APP_SETTINGS;if(n){debug("Saving with settings");{var a=n.$el.find(".saveButton"),r=(n.$el.find(".saveSuccess"),n.$el.find(".saveFailure"));n.$el.find(".saving")}a.toggleButton();var o=new errorHandler(r);o.clearErrors()}("wix"==HOST||"weebly"==HOST)&&(AUTO_SAVE_TIME="undefined"==typeof AUTO_SAVE_TIME?1e3:1.1*AUTO_SAVE_TIME);var s=jQuery.extend(!0,{},i.attributes);delete s.locals,delete s.isPreset,delete s.colorPreset,delete s.fontPreset,delete s.designPreset,delete s.designPresetCategory,delete s.passwords;var l={content:JSON.stringify(s),passwords:JSON.stringify(i.get("passwords")),original_query:originalQuery(),app_type:i.meta.app_type,view_mode:i.meta.view_mode,alias:i.meta.alias};if("undefined"!=typeof e&&void 0!=e.post_params)for(var c in e.post_params)l[c]=e.post_params[c];var d="/apps/"+i.meta.true_id;debug("posting to url "+d),ajaxController({url:d,data:l,type:"PUT"},function(e){if(debug("Save response: ",e),e.success)i.meta.saved=!0,debug("Update success! Model:",i,"Response:",e),i.setLocals({isDirty:!1}),n&&(a.toggleButton(),n.animateSaveButton(),n.updateSaveStatus(),n.updateEmbedCode(),("wix"==HOST||"weebly"==HOST)&&(n.$el.find(".saveStatus .savingStatus").hide(),n.$el.find(".saveStatus .savedStatus").show(),setTimeout(function(){n.$el.find(".saveStatus .savedStatus").fadeOut("fast")},1e3))),location.pathname.search("/standalone")>-1&&window.history.pushState("object or string","Title","?id="+i.meta.true_id);else{if(debug("UH OH...trouble saving!"),n){for(var r in e.errors)o.addError(e.errors[r]);a.toggleButton(),o.displayErrors()}t()}})}}),appView=Backbone.View.extend({beforeInitialize:function(){},initialize:function(){_.bindAll(this,"template","render","beforeInitialize","afterInitialize","beforeRender","afterRender"),this.beforeInitialize(),debug("Initializing app view, model: ",this.model.attributes);var e=this;this.setMetaContent(),void 0!=$(window).konami&&($(window).konami({code:[80,38],cheat:function(){debug("P up detected"),$("#editMe, .adminAppInfo").fadeIn()}}),$(window).konami({code:[80,40],cheat:function(){debug("P down detected"),$("#editMe, .adminAppInfo").fadeOut()}})),this.turnOnCssWatch(),this.$el.on("click","a",function(){var t=e.model.get("linkBehavior");t&&"none"!=t?$(this).data("overwrite-link-behavior")||""==($(this).attr("target")||"")?(debug("Setting link behavior for "+t),$(this).attr("target",t),$(this).data("overwrite-link-behavior",!0)):debug("Link behavior",$(this).data("overwrite-link-behavior"),$(this).attr("target")):debug("No link behavior found")}),this.$el.on("keyup",'.passwordProtection [name="password"]',function(){"undefined"!=typeof PASSWORD_PROTECT_TIMER&&clearTimeout(PASSWORD_PROTECT_TIMER),PASSWORD_PROTECT_TIMER=setTimeout(function(){e.checkPassword()},500)}),$(window).on("orientationchange",function(){window.ORIENTATION_TIMEOUT&&clearTimeout(ORIENTATION_TIMEOUT),ORIENTATION_TIMEOUT=setTimeout(function(){debug("Orientation change detected"),e.render()},10)}),"wix"==HOST&&(e.model.updateWixStyles(),$(".wix-style-reference div").on("css-change",function(){debug("Wix view detects new colors"),e.model.updateWixStyles()}),$(".wix-style-reference div").csswatch({props:"color"}),setTimeout(function(){debug("Deciding whether to update url"),"site"==VIEW_MODE&&(debug("View mode is site"),0==e.model.meta.last_viewed_url.length||(new Date).getTime()/1e3-e.model.meta.updated_at>21600?(debug("Checking for URL update"),Wix.getSiteInfo(function(t){var i=t.url;if(i!=e.model.meta.last_viewed_url){debug("New URL, posting to server "+i);var n={url:"/apps/"+e.model.meta.id+"/update_url.json",data:{url:i},type:"PUT"};ajaxController(n,function(){})}else debug("Not a new url, not posting")})):debug("Not time to update url"))},5e3),META.wix_demo&&e.$el.on("click","a",function(){return!1}),e.$el.on("submit",".paypalForm",function(){try{debug("Posting payment information to PayPal");var t=$(this),i={type:Wix.Activities.Type.ECOMMERCE_CART_CHECKOUT,info:{cartId:e.model.meta.id+"",storeId:e.model.meta.id+"",storeName:t.find('[name="item_name"]').val(),items:[{id:e.model.meta.id,title:t.find('[name="item_name"]').val(),quantity:t.find('[name="quantity"]').val(),price:t.find('[name="amount"]').val(),currency:t.find('[name="currency_code"]').val(),variants:[]}]}},n=function(e){debug("Wix Posting Activity success: "+e.activityId+", Contact ID: "+e.contactId)},a=function(e){debug("Wix Posting activity failure:",e)};debug("Posting wix activity:",i),Wix.Activities.postActivity(i,n,a)}catch(r){debug("Posting Wix activity failed:",r)}return!0}));var t=0;setTimeout(function(){debug("about to hide loading wrapper"),e.$el.find(".loadingWrapper").fadeOut("fast",function(){debug("loading wrapper hidden"),e.render()})},t);var i=(new Date).getTime();if(e.model.on("change",function(){(new Date).getTime()-i>=t&&e.render()}),$("#app-settings").length>0&&e.model.get("passwordProtectOn")&&!e.model.get("locals").passwordProtectSuccess){var n={url:"/apps/"+e.model.meta.id+"/content.json",data:{id:e.model.meta.id,method:"owner"},type:"POST"};ajaxController(n,function(t){if(t.success)for(var i in t.content)"undefined"!=t.content[i]&&e.model.set(i,t.content[i]);e.render()})}if("undefined"!=typeof BLOGGER_ADS&&"ads"==BLOGGER_ADS){debug("Creating Ad");var a=document.getElementsByTagName("script")[0],r=document.createElement("script");r.async=!0,r.src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",a.parentNode.insertBefore(r,a);var o='<div class="adWrapper"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5690009271255401" data-ad-slot="4973314779" data-ad-format="auto"></ins></div>';$("body").append(o),(adsbygoogle=window.adsbygoogle||[]).push({})}setTimeout(function(){(CURRENT_USER||"formBuilder"==e.model.meta.app_namespace||"ecommerce"==e.model.meta.app_namespace)&&loadCrypto()},2e3),this.afterInitialize()},afterInitialize:function(){},turnOnCssWatch:function(){var e=this;this.$el.csswatch({props:"width, height"}),this.$el.on("css-change",function(){"undefined"!=typeof CSS_CHANGE_TIMER&&clearTimeout(CSS_CHANGE_TIMER),CSS_CHANGE_TIMER=setTimeout(function(){debug("Css change called"),e.fitText(),e.postSizeToSocket()},200)})},turnOffCssWatch:function(){this.$el.off("css-change")},setMetaContent:function(){var e=this.model.meta.app_common_name+" by POWr",t=this.model.meta.app_common_name;this.writeMetaContent(e,t)},writeMetaContent:function(e,t,i){e="undefined"!=typeof e&&e.length>0?truncate($("<i>"+e+"</i>").text(),160):this.model.meta.app_common_name,t="undefined"!=typeof t&&t.length>0?truncate($("</i>"+t+"</i>").text(),60):this.model.meta.app_common_name,i="undefined"!=typeof i&&i.length>0?i:pluginIcon(this.model.meta.app_type);var n=document.location.href,a="<title>"+t+"</title>";a+='<meta content="'+e+'" name="description">',a+='<meta content="'+t+'" property="og:title">',a+='<meta content="website" property="og:type">',a+='<meta content="'+n+'" property="og:url">',a+='<meta content="'+i+'" property="og:image">',a+='<meta content="'+e+'" property="og:description">',a+='<meta content="summary" name="twitter:card">',a+='<meta content="'+t+'" name="twitter:title">',a+='<meta content="'+e+'" name="twitter:description">',a+='<meta content="'+i+'" name="twitter:image">',$("head").append(a)},template:function(){var e=this,t="#"+this.model.meta.app_namespace+"Template";if(this.model.get("passwordProtectOn")&&!e.model.get("locals").passwordProtectSuccess)if(e.model.get("locals").skipPassword)e.model.get("locals").afterPasswordCalled||(e.model.setLocals({afterPasswordCalled:!0}),e.afterCorrectPassword());else if($("#passwordProtectionTemplate").length>0)t="#passwordProtectionTemplate";else{var i={url:"/password-modal",type:"GET"};ajaxController(i,function(t){t.success&&0==$("#passwordProtectionTemplate").length&&($("body").append(t.html),e.model.trigger("change"))}),debug("Please save and reload this app")}var n=$(t).html();return n},styleTemplate:function(){var e="#"+this.model.meta.app_namespace+"StyleTemplate",t=$(e).html();return t},updateInputFields:function(){this.$el.find("input,textarea,select").length>0&&($.webshims.polyfill("forms"),this.$el.find("input,textarea,select").updatePolyfill("forms"))},beforeRender:function(){},render:function(){this.beforeRender();var e=this,t=this.model;debug("App view rendering; Model is ",t),this.$el.toggleClass("noTransition",!0),setTimeout(function(){e.$el.toggleClass("noTransition",!1)},500);var i=this.styleTemplate();if(void 0!=i){var n=_.template(i,{m:t.attributes});$("#dynamicStyle").html(n),void 0!=t.get("customCSS")&&t.get("customCSS").length>0&&$("#dynamicStyle").append("<style>"+t.get("customCSS")+"</style>"),void 0!=t.get("customJS")&&t.get("customJS").length>0&&$("#dynamicStyle").append("<script>"+t.get("customJS")+"</script>")}if(debug("Rendering, render style local: "+this.model.get("locals").render_style_only),1!=this.model.get("locals").render_style_only){debug("Full render");var a=this.template(),r=_.template(a,{m:t.attributes});this.$el[0].innerHTML=r,this.loadFonts(),this.afterRender(),this.updateInputFields(),this.loadNodeImages(),1==this.model.meta.premium&&this.$el.find(".powrMark").hide(),this.model.meta.user_has_app&&this.$el.find(".userHasApp").show(),isWebview()&&this.$el.find('form[target="_blank"]').attr("target","_top"),e.fitText(),e.postSizeToSocket()}else debug("Rendering style only. Locals value is: "+this.model.get("locals").render_style_only),this.loadFonts(),e.$el.find(".fitText").css("font-size","").removeData("orig-font-size"),e.fitText(),e.postSizeToSocket();this.model.get("passwordProtectOn")&&!e.model.get("locals").passwordProtectSuccess&&(this.applyPasswordStyle(),e.postSizeToSocket()),this.model.setLocals({render_style_only:null}),$('[data-toggle="tooltip"]').tooltip(),$("[name=notify_url]").val("https://"+document.location.host+"/payment_notification/"+this.model.meta.id)
},loadNodeImages:function(){loadNodeImages(this.$el)},checkPassword:function(){debug("Checking password");var e=this;if(e.model.get("passwordProtectOn")){var t=$(".passwordProtection"),i=$(t).find('input[name="password"]').val(),n=t.find(".checking"),a=t.find(".incorrect"),r=t.find(".correct");if(n.hide(),r.hide(),a.hide(),0==i.length)return;n.show();var o=!window.APP_SETTINGS;debug("Need to check password with server: "+o);var s=function(){if(debug("Password is correct"),n.hide(),a.hide(),r.fadeIn(),e.model.setLocals({passwordProtectSuccess:!0}),e.render(),window.APP_SETTINGS){var t=APP_SETTINGS.$el.find(".previewPassword");t.find(".showPasswordPreview").show(),t.find(".hidePasswordPreview").hide()}},l=function(){debug("Password is incorrect"),n.hide(),a.fadeIn()};if(o){var c={url:"/apps/"+e.model.meta.id+"/content.json",data:{id:e.model.meta.id,password:i,view_mode:"undefined"==typeof VIEW_MODE?"":VIEW_MODE},type:"POST"};ajaxController(c,function(t){if(t.success)if(t.correct){s();for(var i in t.content)"undefined"!=t.content[i]&&e.model.set(i,t.content[i]);e.afterCorrectPassword()}else l();else l()})}else-1!=e.model.get("passwords").map(function(e){return e.password}).indexOf(i)?s():l()}},afterCorrectPassword:function(){},postSizeToSocket:function(){var e=this;if(debug("Trying to post view size to socket"),"wix"==HOST)debug("Setting wix height"),"undefined"!=typeof WIX_HEIGHT_TIMER&&clearTimeout(WIX_HEIGHT_TIMER),WIX_HEIGHT_TIMER=setTimeout(function(){var t=e.$el.outerHeight(!0);Wix.setHeight(t)},200);else if(void 0!=e.model.get("locals").parent_origin){var t=this.$el.outerWidth(!0),i=this.$el.outerHeight(!0);$(".adWrapper").length>0&&(i+=$(".adWrapper").outerHeight(!0));var n={width:t,height:i,iframe_index:e.model.get("locals").iframe_index};void 0!=e.model.get("locals").postCss&&(n.postCss=e.model.get("locals").postCss);var a={message:"updateSize",data:n};parent.postMessage(JSON.stringify(a),e.model.get("locals").parent_origin)}else if("undefined"!=typeof APP_SOCKET){debug("App socket exists");var t=this.$el.outerWidth(!0),i=this.$el.outerHeight(!0);APP_SOCKET.postMessage(JSON.stringify({action:"updateSize",width:t,height:i}))}},loadFonts:function(){var e=[];for(var t in this.model.attributes){var i=this.model.attributes[t];if(t.search("FontFamily")>-1&&e.push(i),"object"==typeof i)for(var n in i){var a=i[n];if(n.search("FontFamily")>-1&&e.push(a),"object"==typeof a)for(var r in a)r.search("FontFamily")>-1&&e.push(a[r])}}e.length>0&&loadFonts(e)},afterRender:function(){},applyPasswordStyle:function(){this.setStandardBackground($(".passwordProtection"))},setStandardBackground:function(e){if("undefined"==typeof e)var t=this.$el.children();else var t=e;var i=this.model;"none"!=i.get("backgroundShadow")&&t.toggleClass(i.get("backgroundShadow"),!0),t.css(1==i.get("backgroundGradient")?{background:"-webkit-linear-gradient("+i.get("backgroundStartColor")+","+i.get("backgroundEndColor")+")",background:"-o-linear-gradient("+i.get("backgroundStartColor")+","+i.get("backgroundEndColor")+")",background:"-moz-linear-gradient("+i.get("backgroundStartColor")+","+i.get("backgroundEndColor")+")",background:"linear-gradient("+i.get("backgroundStartColor")+","+i.get("backgroundEndColor")+")","border-color":i.get("backgroundBorderColor"),"border-radius":i.get("backgroundBorderRadius"),"border-width":i.get("backgroundBorderWidth"),"border-style":"solid"}:{background:i.get("backgroundColor"),"border-color":i.get("backgroundBorderColor"),"border-radius":i.get("backgroundBorderRadius"),"border-width":i.get("backgroundBorderWidth"),"border-style":"solid"})},setStandardWidth:function(e){e.css("1000px"===this.model.get("pluginWidth")?{maxWidth:"100%"}:{maxWidth:this.model.get("pluginWidth")})},fitText:function(){fitText(this.$el.find(".fitText")),this.afterFitText()},afterFitText:function(){}}),appSettings=Backbone.View.extend({el:"#appSettings",beforeInitialize:function(){},initialize:function(){function e(){a.model.updateWixStyles(),a.handleEvents(),a.render(),a.afterInitialize()}function t(){$(".wix-style-reference .color-1").css("color")==$(".wix-style-reference .color-2").css("color")&&$(".wix-style-reference .color-2").css("color")==$(".wix-style-reference .primery-1").css("color")&&$(".wix-style-reference .primery-2").css("color")==$(".wix-style-reference .primery-3").css("color")?setTimeout(function(){t()},100):e()}function i(){ajaxController({url:"/embed_template.json",data:{user_label:a.model.meta.user_label,app_type:a.model.meta.app_type,app_id:a.model.meta.id,original_query:location.search},type:"GET"},function(e){e.success&&(EMBED_TEMPLATE=e.html,n())})}function n(){if(debug("Rendering embed section"),"undefined"==typeof EMBED_TEMPLATE)return void i();var e=$("#platform").val();debug("type is "+e);var t=_.template(EMBED_TEMPLATE,{type:e});$(".embedContent").removeClass("enter"),setTimeout(function(){$(".embedContent").html(t).addClass("enter"),sign_in_update(),update_embed_codes(),$('.embedSection [data-toggle="popover"]').popover({html:!0,trigger:"hover"})},200)}_.bindAll(this,"template","render","saveModel","handleEvents","beforeRender","afterRender","update","afterUpdate","beforeInitialize","afterInitialize","initializeColorPickers","initializeFontPickers","initializeFontSizePickers","initializeSliders","initializeImagePickers"),this.beforeInitialize();var a=this;"wix"==HOST?"dashboard"==VIEW_MODE?e():t():(this.handleEvents(),this.render(),this.afterInitialize()),this.$el.on("click",".showTemplateInstall",function(){a.$el.find(".templateInstall").fadeIn()}),this.$el.on("click",".hideTemplateInstall",function(){a.$el.find(".templateInstall").fadeOut()}),this.$el.on("click",".toggleSpace",function(){debug("Toggle space clicked");var e=$(this).parents(".prototype-element").first();e.find(".panel-collapse").slideToggle("fast")}),a.model.meta.importable&&!a.model.meta.saved&&"wix"!=HOST&&(a.$el.find(".importNewWrapper").show(),a.$el.find("#importModal").modal("show")),this.$el.on("click",".importApp",function(){function e(){a.model.setLocals({renderSettings:!0});var e=jQuery.extend(!0,{},IMPORT_CONTENT[t]);for(var n in e)"undefined"!=typeof a.model.defaults()[n]&&a.model.set(n,e[n]);a.model.triggerChange(),a.$el.find(".importNewWrapper").hide(),flashMessage(i,3e3)}var t=$(this).data("import"),i=($(this).data("app-id"),$(this).siblings(".success"));a.model.get("locals").isDirty||a.model.meta.saved?(confirmModal=$("#confirmModal"),confirmModal.find(".modal-body").html("This will overwrite your current content. Continue?"),confirmModal.modal("show"),confirmModal.find("#okBtn").click(e)):e()}),this.$el.on("click",".syncApp",function(){function e(){a.model.setLocals({renderSettings:!0}),a.model.meta.alias=i;var e=jQuery.extend(!0,{},IMPORT_CONTENT[t]);for(var n in e)"undefined"!=typeof a.model.defaults()[n]&&a.model.set(n,e[n]);a.model.triggerChange(),a.initializeSync(),a.$el.find(".importNewWrapper").hide()}var t=$(this).data("import"),i=$(this).data("app-id");a.model.get("locals").isDirty||a.model.meta.saved?(confirmModal=$("#confirmModal"),confirmModal.find(".modal-body").html("This will overwrite your current content. Continue?"),confirmModal.modal("show"),confirmModal.find("#okBtn").click(e)):e()}),this.$el.on("click",".unSync",function(){a.model.meta.alias=null,a.initializeSync(),a.model.setLocals({isDirty:!0}),a.updateSaveStatus()}),this.$el.on("hide.bs.modal","#importModal",function(){a.model.get("locals").renderSettings&&(a.render(),a.update(),$(".modal-backdrop").hide(),a.$el.find(".importNewWrapper").hide(),a.model.setLocals({renderSettings:!1}))}),$("#joyride").length>0&&($("#joyride").joyride({postStepCallback:function(e,t){debug("Callback!",e,t);var i=e+1,n=$($("#joyride li")[i]).data("click-target");debug("click target is ",n),void 0!=n&&$(n).click()}}),$(window).load(function(){$("#joyride").joyride({postStepCallback:function(e,t){debug("Callback!",e,t);var i=e+1,n=$($("#joyride li")[i]).data("click-target");debug("click target is ",n),void 0!=n&&$(n).click()}})})),this.$el.on("click",".nav-tabs a",function(){return debug("Nav tabs click detected"),$(".nav-tabs a, .section").removeClass("active"),$(this).addClass("active"),$(this).prevAll().addClass("active"),$(this).nextAll().removeClass("active"),$(".section").eq($(".nav-tabs a").index(this)).addClass("active"),$(".section").css("left","-"+$(".nav-tabs a").index(this)+"00%"),!1}),this.$el.on("click",".removePowrLogo",function(){a.$el.find(".navPlans").click(),$(this).find(".uilib-checkbox").removeClass("checked")}),this.$el.on("click",".nextSection, .prevSection",function(){var e=parseInt($(this).data("target-index"));return $(a.$el.find(".nav-tabs a")[e]).click(),!1}),!a.model.meta.saved&&("weebly"==HOST||"undefined"!=typeof INPAGE&&INPAGE)&&a.saveModel(),$("#apps-standalone").length>0&&($('.embedSection [name="platform"]').on("change",function(){n()}),$(".embedTab").click(function(){null==CURRENT_USER?(SAVE_ON_SIGN_IN=!0,$("#sign-in-modal").modal("show")):(APP_MODEL.get("locals").isDirty&&!$(".embedSection").hasClass("activated")?$(".saveModal").modal("show"):$(".embedSection").toggleClass("activated"),n())}))},loadNodeImages:function(){loadNodeImages(this.$el)},validateInput:function(e){var t=new errorHandler(e.siblings(".validateErrors"));t.clearErrors();var i=e.val();if(0!=i.length){if(e.hasClass("validateInteger")&&(isNaN(i)||parseInt(Number(i))!=i||isNaN(parseInt(i,10)))&&t.addError("Please enter a valid number."),e.hasClass("validateFloat")&&0==$.isNumeric(i)&&t.addError("Please enter a valid number."),e.hasClass("validatePrice")){var n=e[0].selectionStart,a=e[0].selectionEnd,i=e.val();"."==i[0]&&(i="0"+i),i=(i.match(/[\d\,]+\.?[\d]*/g,"")||[])[0]||"",e.val(i),e[0].setSelectionRange(n,a)}if(e.hasClass("validatePriceWithSign")){var n=e[0].selectionStart,a=e[0].selectionEnd;i=(e.val().match(/-?[\d\,]+\.?[\d]*/g,"")||[])[0]||"",e.val(i),e[0].setSelectionRange(n,a)}if(e.hasClass("validatePercent")&&0==$.isNumeric(i)&&0==$.isNumeric(replaceAll("%","",i))&&t.addError("Please enter a valid percent."),e.hasClass("validateMax")&&i>parseInt(e.data("validateMax"))&&t.addError("Please enter a number less than "+parseInt(e.data("validateMax")).toLocaleString()),e.hasClass("validateMin")&&i<parseFloat(e.data("validateMin"))&&e.val(parseFloat(e.data("validateMin"))),e.hasClass("validateLengthMax")&&i.length>parseInt(e.data("validateLengthMax"))&&t.addError("Please enter less than "+parseInt(e.data("validateLengthMax")).toLocaleString()+" characters."),e.hasClass("validateUrl")&&(isValidUrl(i)||t.addError("Please enter a valid URL")),e.hasClass("validateEmail")){var n=e[0].selectionStart,a=e[0].selectionEnd;i=$.trim(e.val()),e.val(i),e[0].setSelectionRange(n,a);var r=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;1!=r.test(i)&&t.addError("Please enter a valid email.")}t.errors.length>0&&t.displayErrors()}},validateExternalFields:function(e){var t=this,i=function(e){var t=new RegExp(e.data("regex"),"").test(e.find(".actualInput").find("input").val());t?e.find(".exportFieldErrors").slideUp():e.find(".exportFieldErrors").slideDown()};return e?void e.each(function(){i($(this))}):void t.$el.find(".exportField").each(function(){$(this).data("export-listening")||($(this).on("keyup",function(){i($(this))}),$(this).data("export-listening",!0))})},makeSortable:function(e,t,i,n,a){var r=this,o={containment:"parent",appendTo:r.$el,handle:t||".sort",start:function(e,t){if(i){debug("Sorted start, UI is",t);var a=n||"50px",r=t.item.height(),o=$(this);t.item.height(r).css({overflow:"hidden"}).animate({height:a},"fast",function(){o.sortable("refreshPositions")}),t.item.siblings(".ui-sortable-placeholder").height(r).animate({height:a},"fast",function(){o.sortable("refreshPositions")})}},stop:function(e,t){if(i){debug("Sorted start, UI is",t);var a=n||"50px",r=t.item.height("auto").innerHeight();parseInt(a)>r?(debug("Animating from "+a+" to "+r),t.item.height(parseInt(a)).animate({height:r+"px"},"fast",function(){$(this).height("auto"),$(this).css({overflow:"visible"})})):t.item.css({height:"auto",overflow:"visible"})}},update:function(){r.update(),r.initializeTextControls(!0)}};null==a||(o.axis=a||"y"),this.$el.find(e).sortable(o)},handleEvents:function(){var e=this;$(".makePremium").on("click",function(){ajaxController({url:"/apps/"+e.model.meta.id+"/make-premium",data:{value:!e.model.meta.premium},type:"PUT"},function(e){e.success&&alert("Success! Reload to apply")})}),this.$el.on("click",".openAnalyticsModal",function(){setTimeout(function(){loadAnalytics()},250)}),this.$el.on("click",".reloadAnalytics",function(){debug("Reload analytics click detected"),loadAnalytics()}),this.$el.on("click",".trialSize",function(){$(".callToAction").click()}),this.$el.on("click",".accessHeader .powrBtn",function(){$(".accessHeader .powrBtn").removeClass("activated"),$(this).addClass("activated"),$(this).hasClass("clickToEditTrigger")?(e.$el.find(".inviteToEdit").removeClass("hid"),e.$el.find(".inviteToView").addClass("hid")):(e.$el.find(".inviteToEdit").addClass("hid"),e.$el.find(".inviteToView").removeClass("hid"))}),this.$el.on("click",".signIn",function(){$("#sign-in-modal").modal("show"),$("#user_external_query").val(document.location.search.replace("?","")+"&appType="+e.model.meta.app_type)}),this.$el.on("click",".saveButton",function(){debug("Save button clicked"),"undefined"!=typeof UPDATE_TIMER&&clearTimeout(UPDATE_TIMER),null==CURRENT_USER?(SAVE_ON_SIGN_IN=!0,$("#sign-in-modal").modal("show"),$("#user_external_query").val(document.location.search.replace("?","")+"&appType="+e.model.meta.app_type),$(".signInTab").addClass("active")):e.saveModel()}),this.$el.on("click",".socialLinks li",function(){var t=encodeURIComponent("https://www.powr.io?r="+CURRENT_USER.id+"&p=10free"),i=encodeURIComponent("https://www.powr.io/share?r="+CURRENT_USER.id+"&p=10free"),n="www.powr.io/plugins/"+e.model.meta.app_slug+"/view?id="+e.model.meta.id+"&mode=page";if($(this).hasClass("facebook"))var a="https://www.facebook.com/sharer/sharer.php?u="+i;if($(this).hasClass("twitter"))var r=encodeURIComponent(n+" I just built my own "+e.model.meta.app_common_name+" app @POWrPlugins. Try it and we both upgrade for free!"),a="https://twitter.com/home?status="+r+"%20"+t;if($(this).hasClass("linkedin"))var a=(encodeURIComponent("I just built a sweet "+e.model.meta.app_common_name+" Plugin with POWr.io"),encodeURIComponent("Try it out and we\u2019ll both upgrade for free!"),"https://www.linkedin.com/shareArticle?mini=true&url="+i+"&title=Free%20POWr%20Plugins!&summary=I%20just%20tried%20out%20POWr%20Plugins%20on%20my%20site!%20%20Free,%20fast,%20and%20fully-customizable%20website%20ingredients%20with%20zero%20code%20required!&source=www.powr.io");if($(this).hasClass("email"))var o=encodeURIComponent("This worked really well"),a=(encodeURIComponent("Hey,")+"%0D%0A%0D%0A"+encodeURIComponent("I just built a sweet "+e.model.meta.app_common_name+" plugin with POWr.io. And I didn\u2019t have to write any code! \xa0They\u2019ve got tons of free plugins for any website.")+"%0D%0A%0D%0A"+encodeURIComponent("Give it a try, and we\u2019ll both upgrade for free!")+"%0D%0A%0D%0A"+t+"%0D%0A%0D%0A"+encodeURIComponent("Cheers!"),"mailto:?subject="+o+"&body=I%20just%20built%20a%20sweet%20Comments%20app%20with%20%40POWrPlugins.%20Try%20it%20out%20and%20we%20will%20both%20upgrade%20for%20free%21%20"+i+"&source=www.powr.io");window.open(a)}),this.$el.on("click",".inviteToView li",function(){var t=encodeURIComponent("www.powr.io/plugins/"+e.model.meta.app_slug+"/view?id="+e.model.meta.id+"&mode=page");if($(this).hasClass("facebook"))var i="https://www.facebook.com/sharer/sharer.php?u="+t;if($(this).hasClass("twitter"))var n="Check this out -",i="https://twitter.com/home?status="+n+"%20"+t;if($(this).hasClass("linkedin"))var i="https://www.linkedin.com/shareArticle?mini=true&url="+t;if($(this).hasClass("google"))var i="https://plus.google.com/share?url="+t;if($(this).hasClass("email"))var a=encodeURIComponent("Check this out"),i="mailto:?subject="+a+"&body="+t;window.open(i)}),this.$el.on("submit",".feedbackForm",function(){var t=$(this),i={url:"/feedback.json",data:{feedback:{feedback_type:t.parents(".feedbackWrapper").find('[name="feedbackType"]').val(),feedback:t.find('[name="feedback"]').val(),email:t.find('[name="email"]').val(),app_type:e.model.meta.app_type,app_id:e.model.meta.id,platform:HOST,free_10:!0}},type:"POST",buttonElement:t.find(".feedbackSubmit"),successElement:t.find(".feedbackSuccess"),errorsElement:t.find(".feedbackErrors"),flashSuccess:!1};return ajaxController(i,function(e){e.success&&t.find('[name="feedback"]').val("")}),!1}),this.$el.on("click",".nav-tabs a",function(){e.$el.scrollTop(0)}),this.$el.on("keyup",".validate",function(){var t=$(this),i=new errorHandler(t.siblings(".validateErrors"));i.clearErrors(),"undefined"!=typeof VALIDATION_TIMER&&clearTimeout(VALIDATION_TIMER),debug("Validation called"),VALIDATION_TIMER=setTimeout(function(){e.validateInput(t)},500)}),this.$el.on("keyup",".standardSearch",function(){debug("Keyup clicked");var e=$(this),t=$(this).parents(".standardSearchWrapper"),i=t.find(".standardSearchResults");return e.val().length<3?(i.html(""),!0):("undefined"!=typeof SEARCH_TIMER&&clearTimeout(SEARCH_TIMER),void(SEARCH_TIMER=setTimeout(function(){var t={url:"/standard-search.json",type:"get",data:{q:e.val(),display_style:"app",host:HOST}};ajaxController(t,function(e){debug("Standard search response: ",e),i.html(e.html)})},250)))}),this.$el.on("blur change keyup",'input:not(.preset, .ignore, [name="designPreset"], [name="colorPreset"], [name="fontPreset"]), select:not(.preset,.ignore,[name="designPreset"], [name="colorPreset"], [name="fontPreset"]), textarea:not(.ignore)',function(){if(e.model.get("locals").render_style_only!==!1&&$(this).data("render-style-only")){debug("Setting render style only to true"),e.model.setLocals({render_style_only:!0});var t=0}else if(e.model.setLocals({render_style_only:!1}),$.inArray($(this).attr("type"),["text","textarea","email"])>-1)var t=1e3;else if("weebly"==HOST)var t=100;else var t=250;"undefined"!=typeof UPDATE_TIMER&&clearTimeout(UPDATE_TIMER),UPDATE_TIMER=setTimeout(function(){debug("Change detected"),e.update()},t)}),this.$el.on("click",".add",function(){if("false"==$(this).attr("active"))return!1;if($(this).hasClass("premium"))return!1;var t=$(this);if(t.parents(".multiAdd").length>0){var i=t.parents(".multiAdd").prev(".prototype-wrapper");debug("Multi Add detected. Prototype wrapper is",i)}else var i=t.prev(".prototype-wrapper");i.addPrototype(function(i){i.find(".innerPanelToggle, .toggleSpace").click(),e.afterAdd(i,t),e.update()})}),this.deleteHandler(),this.$el.on("click",".duplicate",function(){var t=$(this).parents(".prototype-wrapper").first(),i=$(this).parents(".prototype-element").first(),n=t.siblings(".add");if("wix"==HOST)var a=$(this).parents(".wixSection").first();else var a=$(this).parents(".section").first();if(n.hasClass("premium"))return!1;i.find("input, select, textarea").each(function(){$(this).attr("value",$(this).val())}),t.append(i[0].outerHTML);var r=t.children(".prototype-element").last();r.find("input, select, textarea").each(function(){$(this).val($(this).attr("value"))});var o=t.outerHeight()-150;debug("New El is ",r,"Scroll el is ",a,"position Top is : "+r.position().top+"; offset is: "+r.offset().top),a.animate({scrollTop:o+"px"}),e.update()}),this.$el.on("click",".panel",function(){$(this).find(".panel-collapse.collapse").length>0?$(this).find(".panel-title:not(.upgradePanelTitle) .fa").toggleClass("fa-minus-square",!0).toggleClass("fa-plus-square",!1):$(this).find(".panel-title:not(.upgradePanelTitle) .fa").toggleClass("fa-plus-square",!0).toggleClass("fa-minus-square",!1)}),this.$el.on("click",".innerPanelToggle",function(){var e=$(this).parents(".innerPanel").first(),t=e.find(".innerPanelContent").first(),i=e.find(".innerPanelText").first(),n=$(this).find(".fa");t.slideToggle(),"open"==i.html()?(i.html("close"),n.toggleClass("fa-minus-square",!0).toggleClass("fa-plus-square",!1)):(i.html("open"),n.toggleClass("fa-plus-square",!0).toggleClass("fa-minus-square",!1))}),0==$("#apps-standalone").length&&("wix"==HOST?this.$el.on("click",".uilib-tabs li",function(){"tab3"==$(this).data("tab")?$("#clickdesk_popup, .cd-bubble").toggleClass("show",!0):$("#clickdesk_popup, .cd-bubble").toggleClass("show",!1)}):this.$el.on("click",".nav-tabs a",function(){"helpTab"==$(this).attr("id")?$("#clickdesk_popup, .cd-bubble").toggleClass("show",!0):$("#clickdesk_popup, .cd-bubble").toggleClass("show",!1)})),this.$el.on("click",".triggerPremium",function(){"wix"==HOST?Wix.Settings.openBillingPage():e.$el.find(".callToAction").click()}),this.$el.on("click",".makeNoticeable",function(){$(this).removeClass("makeNoticeable")}),this.$el.on("click",".colorSelectionContainer .gradientToggle",function(){var e=$(this).parents(".colorSelectionContainer");0==e.find(".gradientToggle input:checked").length?(e.find(".gradientColor").hide(),e.find(".solidColor").show()):(e.find(".gradientColor").show(),e.find(".solidColor").hide())}),this.$el.on("click",".colorSelectionContainer .transparentToggle",function(){var e=$(this).parents(".colorSelectionContainer");e.find(".colorSelector").each(0==e.find(".transparentToggle input:checked").length?function(){var e=$(this).val(),t=tinycolor(e).setAlpha(1).toRgbString();$(this).spectrum("set",t),$(this).val(t)}:function(){var e=$(this).val(),t=tinycolor(e).setAlpha(0).toRgbString();$(this).spectrum("set",t),$(this).val(t)})}),this.$el.on("click",".ratePowr .choice",function(){$(this).addClass("picked").siblings(".choice").addClass("notPicked"),e.$el.find(".feedbackSection").fadeIn()}),this.$el.on("click",".resetRatePowr",function(){e.$el.find(".ratePowr .choice").removeClass("picked").removeClass("notPicked"),e.$el.find(".feedbackSection").fadeOut(),e.$el.find(".laterBox").fadeIn()}),this.$el.on("change",".powrCheckbox",function(){$(this).parents(".powrToggle").hasClass("premium")&&0==e.model.meta.premium||($(this).prop("checked")?$(this).siblings(".switch").toggleClass("on",!0).toggleClass("off",!1):$(this).siblings(".switch").toggleClass("on",!1).toggleClass("off",!0))}),$(document).on("click",function(t){var i=$(t.target);i.hasClass("mCSB_dragger_bar")||i.hasClass("mCSB_draggerRail")||(i.hasClass("powrSelected")||i.parents(".powrSelected").length>0?(i.parents(".powrSelected").length>0&&(i=i.parents(".powrSelected")),debug("Has powr selected class"),i.next(".powrDropdown").hasClass("hid")?(e.$el.find(".powrDropdown").toggleClass("hid",!0),i.next(".powrDropdown").toggleClass("hid",!1)):e.$el.find(".powrDropdown").addClass("hid",!1)):e.$el.find(".powrDropdown").addClass("hid",!1))}),this.$el.on("click","#tutorialWidget .app",function(){var t=$(this).find("input").val(),i=$(this).find("input").data("app-slug"),n="<i class='powrIcon icon-"+t+"' data-app-slug='"+i+"'></i>";$(this).parents(".powrOptions").find(".text").html(n),e.$el.find(".powrDropdown").toggleClass("hid",!0)}),this.$el.on("click","#tutorialWidget .platform",function(){var t=$(this).find("input").val(),i="<img src='//s3-us-west-1.amazonaws.com/powr/platforms/"+t+"/logo_70x70.jpg' data-platform='"+t+"'>";$(this).parents(".powrOptions").find(".text").html(i),e.$el.find(".powrDropdown").toggleClass("hid",!0)}),"wix"==HOST?this.$el.on("click",".visitTutorial",function(){var t=e.$el.find("#tutorial_app_type").val(),i="/tutorials/how-to-add-"+t+"-plugin-to-your-wix-site",n=Math.round(screen.width/3),a=screen.height;window.open(i,"","width="+n+",height="+a+",scrollbars=1")}):this.$el.on("click",".visitTutorial",function(){var t=e.$el.find("#tutorialWidget .powrSelected i").data("app-slug"),i=e.$el.find("#tutorialWidget .powrSelected img").data("platform");if(void 0!=t&&void 0!=i){var n="/tutorials/how-to-add-"+t+"-plugin-to-your-"+i+"-site",a=Math.round(screen.width/2),r=screen.height;window.open(n,"","width="+a+",height="+r+",scrollbars=1")}}),this.$el.on("click",".categoryPreset",function(){var t=$(this).find("input").val(),i=DESIGN_PRESET_CATEGORIES[t].display_name;$(this).parents(".powrOptions").find(".text").html(i);var n=null;for(var a in DESIGN_PRESETS)if(DESIGN_PRESETS[a].category==i&&DESIGN_PRESETS[a].id==e.model.get("designPreset")){n=DESIGN_PRESETS[a].id;break}if(null==n)for(var a in DESIGN_PRESETS)if(DESIGN_PRESETS[a].category==i){var n=DESIGN_PRESETS[a].id;break}e.model.set({designPresetCategory:t,designPreset:n},{silent:!0}),e.$el.find(".powrDropdown").toggleClass("hid",!0),e.createPresetCarousel()}),this.$el.on("click",".colorPreset",function(){var t=$(this).find("input").val(),i=COLOR_PRESETS[t],n=["text-color-1","text-color-2","background-color-1","background-color-2","accent-color"],a="";for(var r in n){var o=i[n[r]];a+="<span class='colorLabel' style='background:"+o+";'></span>"}a+=i.display_name,$(this).parents(".powrOptions").find(".text").html(a),e.$el.find(".powrDropdown").toggleClass("hid",!0),e.model.set({colorPreset:t},{silent:!0}),e.createPresetCarousel()}),this.$el.on("click",".fontPreset",function(){var t=$(this).find("input").val();$(this).parents(".powrOptions").find(".text").html(FONT_PRESETS[t].display_name);var i="";for(var n in FONT_PRESETS)i+=n+"Select ";$(this).parents(".powrOptions").find(".fontPresets").removeClass(i),$(this).parents(".powrOptions").find(".fontPresets").addClass(t+"Select"),e.$el.find(".powrDropdown").toggleClass("hid",!0),e.model.set({fontPreset:t},{silent:!0}),e.createPresetCarousel()}),this.$el.on("slide.bs.carousel",".templateCarousel",function(e){var t=$(this);$(this).height(t.height());var i=$(e.relatedTarget).find("img");(null==i.attr("src")||0==i.attr("src").length)&&i.attr("src",i.data("url"));var n=$(e.relatedTarget).next().find("img");n.length>0&&0==n.attr("src").length&&n.attr("src",n.data("url"))}),this.$el.on("slid.bs.carousel",".templateCarousel",function(){var t=$(this),i=t.height(),n=t.css("height","auto").height();t.height(i).animate({height:n},function(){t.css("height","auto")});var a=t.find(".item.active").data("preset-id");e.model.set({designPreset:parseInt(a)},{silent:!0})}),"wix"==HOST&&$("body").on("click",".x-close-popup",function(){debug("close wix popup clicked"),$(".popup-modal, .uilib-popup").remove()}),this.$el.on("click",".applyPreset",function(){if(debug("Design preset change"),0==e.model.get("isPreset"))if("wix"==HOST){var t=Wix.UI.create({ctrl:"Popup",options:{modal:!0,buttonSet:"okCancel",title:"Confirm",content:"This will overwrite your current content. Continue?",fixed:!0,onclose:function(){e.setDesignPresets(),$(".popup-modal, .uilib-popup").remove()}}});$(".uilib-popup .uilib-btn").addClass("ignore"),t.getCtrl().open()}else confirmModal=$("#confirmModal"),confirmModal.find(".modal-body").html("This will overwrite your current content. Continue?"),confirmModal.modal("show"),confirmModal.find("#okBtn").click(function(){e.setDesignPresets()});else e.setDesignPresets()}),this.$el.on("click",".embed",function(){select_all($(this))}),this.$el.on("click",".triggerPremiumFeatures",function(){e.$el.find(".premiumUpgradeOption .panel-title").trigger("click")}),this.$el.on("click",'#premium [name="selectPackage"]',function(){e.updatePackagePrice()}),this.$el.on("shown.bs.collapse",".selectPackageAccordion",function(){debug("Accordion opened"),e.updatePackagePrice()}),this.$el.on("click","#premium .upgradeSection .panel-title",function(){$(this).hasClass("active")?e.$el.find("#premium .upgradeSection .upgradePanelTitle").removeClass("active"):(e.$el.find("#premium .upgradeSection .upgradePanelTitle").removeClass("active"),$(this).addClass("active")),e.$el.find("#premium .upgradeSection .panel-title .icon").html('<i class="fa fa-circle-o"></i>'),$(this).find(".icon").html('<i class="fa fa-dot-circle-o"></i>'),e.$el.find(".upgradePanel .panel-collapse.in").collapse("hide"),$(this).parents(".upgradePanel").find(".panel-collapse").collapse("toggle")}),this.$el.on("click",".choosePlan .thisPlan, .checkoutContainer .goBack",function(){e.$el.find(".checkoutContainer, .upgradeSection").toggleClass("hide"),e.$el.find(".thePlanName").html($(this).html()+" - "+e.$el.find(".upgradePanelTitle.active .powrplan").html())}),this.$el.on("click",".upgradeSubmit",function(){if(e.$el.find(".upgradeSubmitLoading").show(),null==CURRENT_USER)return $("#sign-in-modal").modal("show"),void $("#user_external_query").val(document.location.search.replace("?","")+"&appType="+META.app_type);var t=e.$el.find(".upgradePanelTitle.active").parents(".upgradePanel").find('[name="selectPackage"]:checked'),i=t.data("level"),n=t.data("frequency"),a=e.$el.find(".totalVal").html(),r=e.$el.find(".creditCardForm"),o=t.data("discount-id");if("premium"==i)var s="/app-subscriptions.json";else if("pro"==i||"enterprise"==i)var s="/pro-subscriptions.json";var l={url:s,data:{app_id:e.model.meta.id,credit_card_number:r.find("#creditCardNumber").val(),exp_month:r.find("#expMonth").val(),exp_year:r.find("#expYear").val(),cvv:r.find("#cvv").val(),price:a,level:i,frequency:n,discount_id:o},type:"POST",buttonElement:$(this),errorsElement:e.$el.find(".upgradeErrors")};ajaxController(l,function(t){e.$el.find(".upgradeSubmitLoading").hide(),t.success&&(analyticsEvent("goals","upgrade",i),e.model.meta.premium=!0,e.model.meta.active_trial=!1,e.$el.find(".saveButton, #premium").addClass("upgradeSuccessful"),e.$el.find(".upgradeText").removeClass("activeHide"),e.$el.find(".upgradeText").html("<span class='noAction'><i class='fa fa-check-circle'></i> Upgraded</span>"),e.$el.find(".upgradeContent").hide(),e.$el.find(".successfulPayment").show(),e.updatePremiumContent())})}),this.$el.on("click",".creditCardSubmit",function(){var t=$("#creditCardModal"),i={url:"/credit-cards.json",data:{credit_card_number:t.find("#creditCardNumber").val(),exp_month:t.find("#expMonth").val(),exp_year:t.find("#expYear").val(),cvv:t.find("#cvv").val()},type:"POST",buttonElement:$(this),errorsElement:e.$el.find(".creditCardErrors")};ajaxController(i,function(e){e.success&&($("#creditCardModal").modal("hide"),CURRENT_USER=e.user)})}),this.$el.on("click",".promoCodeBtn",function(){if(null==CURRENT_USER)return $("#sign-in-modal").modal("show"),$("#user_external_query").val(document.location.search.replace("?","")+"&appType="+META.app_type),!1;var t=e.$el.find('[name="promoCode"]').val(),i={url:"/promo_codes.json",data:{code:t},type:"POST",buttonElement:$(this),errorsElement:e.$el.find(".promoCodeErrors"),successElement:e.$el.find(".promoCodeSuccess")};ajaxController(i,function(t){t.success&&(e.$el.find('[name="promoCode"]').val(""),e.model.set({premium:!0,active_trial:!0}),setTimeout(function(){e.updatePremiumContent(),e.$el.animate({scrollTop:"0px"})},3e3))})}),this.$el.on("click",".shareThisTrigger",function(){null==CURRENT_USER?($("#sign-in-modal").modal("show"),$("#user_external_query").val(document.location.search.replace("?","")+"&appType="+META.app_type)):$("#shareThis").modal("show")}),this.$el.on("click",".reviewThisTrigger",function(){e.showReviewModal()}),this.$el.on("click",".reviewLater",function(){e.$el.find("#pleaseReview").modal("hide")}),this.$el.on("click",".reviewNo",function(){e.model.set({reviewStatus:"done"}),setCookie("reviewStatus","done",365),e.update(),e.$el.find("#pleaseReview").modal("hide")}),setTimeout(function(){if($("#userNotification").length>0)return void $("#userNotification").modal("show");if(!e.model.meta.demo_mode){var t=e.model.get("reviewStatus"),i=e.model.get("reviewPopupTime"),n=!1,a=parseInt(new Date(e.model.meta.created_at).getTime()/1e3),r=parseInt((new Date).getTime()/1e3);a>r-259200?(debug("App was recently created, not showing modal"),n=!1):"done"==getCookie("reviewStatus")||"later"==getCookie("reviewStatus")?(debug("Review status cookie set, not showing review modal"),n=!1):"shopify"==e.model.meta.external_id_type&&"popup"==e.model.app_type?(debug("Review modal not shown on this platform and app"),n=!1):void 0==t?(debug("Review status not defined, showing review modal"),n=!0):"later"==t&&void 0!=i&&parseInt(i)<r-432e3&&(debug("Time to show review popup again, showing modal"),n=!0),n&&e.showReviewModal()}},1e4),this.$el.on("change",'[name="pluginRating"]',function(){debug("Plugin change detected");var t=parseInt($(this).val());e.updateFeedbackType(1==t?"terrible":3==t?"praise":""),e.model.set("pluginRating",t),e.$el.find(".laterBox").hide(),sign_in_update()}),"wix"==HOST&&(this.$el.on("click",".premiumButton",function(){Wix.Settings.openBillingPage()}),this.$el.on("click",".uilib-checkbox",function(){if($(this).parents(".wixCheckbox").hasClass("premium")&&0==e.model.meta.premium);else{$(this).toggleClass("checked");var t=$(this).parents(".wixSetting").find(".checkboxValue");
t.prop("checked",$(this).hasClass("checked")),t.trigger("change")}}),setTimeout(function(){var t=parseInt(new Date(e.model.meta.created_at).getTime()/1e3),i=parseInt((new Date).getTime()/1e3);t>i-60?(debug("App created in last minute, opening chat"),$(".click-desk-closed").click()):debug("App created over a minute ago, not showing chat")},5e3)),"wix"==HOST&&this.$el.on("click",".wixLink",function(){var e=$(this).attr("href");if(void 0==$(this).data("width"))var t=Math.round(screen.width/3);else var t=Math.round(screen.width*parseInt($(this).data("width"))/100);var i=screen.height;return window.open(e,"","width="+t+",height="+i+",scrollbars=1,resizable=1"),!1}),this.$el.on("keyup paste",".parsedVideoWrapper .videoUrl",function(){var t=$(this).parents(".parsedVideoWrapper"),i=$(this).val(),n=parseVideo(i),a="";debug("Video change detected. Video data is",n),n.valid?(t.find(".videoError").hide(),t.find(".videoId").val(n.id),t.find(".videoProvider").val(n.type),t.find(".videoValid").val(!0),"youtube"==n.type?(a="//img.youtube.com/vi/"+n.id+"/hqdefault.jpg",t.find(".previewUrl").val(a),t.find(".previewImage").attr("src",a),e.update()):"vimeo"==n.type&&$.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+n.id+".json",jsonp:"callback",timeout:1e4,dataType:"jsonp",success:function(e){debug("Vimeo response:",e),a=e[0].thumbnail_large},error:function(){debug("Vimeo fail response:"),a="//img.youtube.com/vi/0/0.jpg"},complete:function(){t.find(".previewUrl").val(a),t.find(".previewImage").attr("src",a),e.update()}})):(t.find(".videoError").html("<i class='fa fa-warning'></i> Invalid video url").fadeIn(),t.find(".videoValid").val(!1),t.find(".videoId").val(""),t.find(".videoProvider").val(""),t.find(".previewUrl").val(""),t.find(".previewImage").val(""),e.update())}),this.$el.on("keyup",".urlValidationWrapper",function(){var e=$(this);validateUrl(e)}),this.$el.on("click",".callToAction",function(){e.$el.find(".navPlans").click()}),this.$el.on("click","#adminTab",function(){e.$el.find(".fitText").removeAttr("style"),setTimeout(function(){e.fitText()},200)}),this.$el.on("click",".openAccessModal",function(){if(debug("Open access modal clicked"),$("#accessModal").modal("show"),null==CURRENT_USER)return void $("#sign-in-modal").modal("show");if(e.$el.find("#accessModal .fa-refresh").length>0){var t={url:"/powr_token_access.json",data:{powr_token:e.model.meta.powr_token},type:"GET"};ajaxController(t,function(t){t.success&&(e.$el.find("#accessModal .modal-body").html(t.access_content),e.updateEmbedCode())})}}),this.$el.on("click",".grantAccess",function(){var t={url:"/powr_token_access.json",data:{powr_token:e.model.meta.powr_token,email:e.$el.find(".clientInviteEmail").val(),url:e.$el.find(".clientInviteUrl").val(),note:e.$el.find(".clientInviteNote").val(),app_id:e.model.meta.id},type:"POST",buttonElement:$(this),errorsElement:e.$el.find(".grantAccessErrors"),successElement:e.$el.find(".grantAccessSuccess")};ajaxController(t,function(t){t.success&&(e.$el.find("#accessModal .modal-body").html(t.access_content),e.updateEmbedCode(),setTimeout(function(){e.$el.find(".notification").fadeOut("slow")},3e3))})}),this.$el.on("click",".deleteAccess",function(){var t=confirm("Are you sure you want to revoke this member's access?");if(0==t)return!1;var i={url:"/powr_token_access.json",data:{powr_token:e.model.meta.powr_token,user_id:$(this).data("user_id")},type:"DELETE",buttonElement:$(this)};ajaxController(i,function(t){t.success&&(e.$el.find("#accessModal .modal-body").html(t.access_content),e.updateEmbedCode(),setTimeout(function(){e.$el.find(".notification").fadeOut("slow")},3e3))})}),this.$el.on("click",".templateCarousel .item img",function(){e.$el.find(".applyPreset").click()})},initializeFlashSales:function(){$(".flashSaleCountdown").each(function(e){function t(e,n,a){if(0!=e.width()&&0!=e.find(".currentNumber .value").filter(function(){return 0!=$(this).html()}).length){var r=$(i.find(".counterElement")[n]),o=r.find(".currentNumberWrapper"),s=r.find(".nextNumberWrapper"),l="swing",d=parseInt(o.find(".value").html()),u=r.closest(".counterParent").data("max");if(!(0==n&&0>d-1)){if(0>d-1){var f=u;t(e,n-1,a)}else var f=d-1;"slideDown"==a?(s.find(".value").html(f),o.animate({top:"-100%"},c,l),s.animate({top:"-100%"},c,l,function(){o.find(".value").html(f),r.find(".currentNumberWrapper, .nextNumberWrapper").css({top:0})})):"countDown"==a&&(o.animate({opacity:.5},c),setTimeout(function(){o.find(".value").html(f),o.animate({opacity:1},c)},c))}}}for(var i=$(this),n=1e3,a=Math.round(parseFloat(i.data("end-time"))-(new Date).valueOf()/1e3),r=function(e){var t=convertSecondsToComponents(e),i=2-t.hours.toString().length,n=Array(i+1).join("0")+t.hours,a=2-t.minutes.toString().length,r=Array(a+1).join("0")+t.minutes,o=2-t.seconds.toString().length,s=Array(o+1).join("0")+t.seconds;return n+r+s}(a),o=r.split(""),s=0;s<o.length;s++){var l=$(i.find(".counterElement")[s]);l.find(".currentNumber .value").html(o[s])}var c=100;"undefined"!=typeof window["FLASH_SALE_INTERVAL"+e]&&clearInterval(window["FLASH_SALE_INTERVAL"+e]),window["FLASH_SALE_INTERVAL"+e]=setInterval(function(){t(i,o.length-1,"countDown")},n)})},initializePasswordProtection:function(){var e=this,t=e.$el.find('input[name="passwordProtectOn"]'),i=e.$el.find(".previewPassword");e.model.get("passwordProtectOn")?t.parents(".password-protection").find(".password-list").show():t.parents(".password-protection").find(".password-list").hide();var n=function(){var i=t.prop("checked");e.model.get("passwordProtectOn")!=i&&e.model.set("passwordProtectOn",i),i?e.$el.find(".password-list").slideDown():e.$el.find(".password-list").slideUp()},a=function(t){var n="none"==i.find(".showPasswordPreview").css("display"),a=!0;a="boolean"==typeof t?t:!n,a?(i.find(".showPasswordPreview").hide(),i.find(".hidePasswordPreview").show()):(i.find(".showPasswordPreview").show(),i.find(".hidePasswordPreview").hide()),e.model.setLocals({skipPassword:!a,passwordProtectSuccess:!1}),e.model.triggerChange()};e.initializePasswordProtection.afterChange=n,e.initializePasswordProtection.previewChange=a,t.on("change",function(){n()}),i.on("change",a),n(),e.model.get("locals").skipPassword?(i.find(".showPasswordPreview").show(),i.find(".hidePasswordPreview").hide()):(i.find(".showPasswordPreview").hide(),i.find(".hidePasswordPreview").show()),i.on("click",function(){a()});for(var r in this.model.get("passwords"))if(this.model.get("passwords").hasOwnProperty(r)){var o=this.$el.find(".passwordsWrapper").addPrototype(null,{speed:"instant"}),s=this.model.get("passwords")[r];o.objectToForm(s)}},showReviewModal:function(){var e=this,t=parseInt((new Date).getTime()/1e3);e.$el.find("#pleaseReview").modal("show"),e.$el.on("change","[name=pluginRating]",function(){e.model.set({reviewStatus:"done",reviewPopupTime:t}),setCookie("reviewStatus","done",365),e.update(),e.saveModel()}),e.$el.find("#pleaseReview").on("hide.bs.modal",function(){debug("Close review modal detected"),"done"!=e.model.get("reviewStatus")&&(e.model.set({reviewStatus:"later",reviewPopupTime:t}),setCookie("reviewStatus","later",5),e.update())})},savePasswordData:function(){var e=[];this.$el.find(".passwords:not(.prototype)").each(function(){var t=$(this).formToObject();e.push(t)}),this.model.attributes.passwords=e},deleteHandler:function(){var e=this;this.$el.on("click",".delete",function(){if($(this).parents(".prototype-element.slim").length>0)var t=$(this).parents(".prototype-element.slim");else var t=$(this).parents();t.deleteAnimate(function(){e.update()})})},updatePackagePrice:function(){var e=this.$el.find(".upgradePanelTitle.active").parents(".upgradePanel").find('[name="selectPackage"]:checked').data("discount-summary");if(debug("Discount summary: "+e),e){var t=e.split(" ")[0];this.$el.find(".totalVal").html(t),this.$el.find(".totalSummary").html(t!=e?e:"")}},initializePaypalSettings:function(e){var t=function(t){var i=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},n=function(e){return e.charAt(0).toLowerCase()+e.slice(1)};return""==e?n(t):e+i(t)},i=".innerPanel, .panel, .acc-pane, .slim.prototype-element",n='[name="'+t("TrialOn")+'"]',a='[name="'+t("PurchaseType")+'"]',r='[name="'+t("SubscriptionDuration")+'"]',o='[name="'+t("TrialDuration")+'"]',s='[name="'+t("SubscriptionDurationUnits")+'"]',l='[name="'+t("TrialDurationUnits")+'"]',c=function(e){var t=e.parents(i).find(".trialOn");e.prop("checked")?t.slideDown():t.slideUp();var n,a=e.parents(i).find(l).val();switch(a){case"D":n=90;break;case"W":n=52;break;case"M":n=24;break;case"Y":n=5}e.parents(i).find(o).toggleClass("validate validateMax",!0).data("validate-max",n)},d=function(e){var t,n=e.parents(i).find(l).val();switch(n){case"D":t=90;break;case"W":t=52;break;case"M":t=24;break;case"Y":t=5}e.parents(i).find(o).toggleClass("validate validateMax",!0).data("validate-max",t)};this.$el.on("change",n,function(){c($(this))}),this.$el.find(n).each(function(){c($(this))}),this.$el.on("change",l,function(){d($(this))}),this.$el.find(l).each(function(){d($(this))});var u=function(e){"Recurring"==e.val()?(e.closest(i).find(".recurringOn").slideDown(),e.closest(i).find(".recurringOff").hide()):(e.closest(i).find(".recurringOn").hide(),e.closest(i).find(".recurringOff").slideDown())},f=function(e){var t,n=e.parents(i).find(s).val();switch(n){case"D":t=90;break;case"W":t=52;break;case"M":t=24;break;case"Y":t=5}e.parents(i).find(r).toggleClass("validate validateMax",!0).data("validate-max",t)};this.$el.find(a).each(function(){u($(this))}),this.$el.on("change",a,function(){u($(this))}),this.$el.on("change",s,function(){f($(this))}),this.$el.find(s).each(function(){f($(this))})},createPresetCarousel:function(){},afterAdd:function(){},createConfirmModal:function(e,t){if("wix"==HOST){var i=Wix.UI.create({ctrl:"Popup",options:{modal:!0,buttonSet:"okCancel",title:"Confirm",content:e,fixed:!0,onclose:function(){t(),$(".popup-modal, .uilib-popup").remove()}}});$(".uilib-popup .uilib-btn").addClass("ignore"),i.getCtrl().open()}else{var n=$("#confirmModal");n.find(".modal-body").html(e),n.modal("show"),n.find("#okBtn").click(function(){t()})}},updateFeedbackType:function(e){var t=this,i=$("#feedbackTemplate").html(),n=_.template(i,{feedback_type:e});this.$el.find(".feedbackDetails").html(n).hide().fadeIn("fast",function(){t.updateInputFields()})},updatePremiumContent:function(){1==this.model.meta.premium?(this.$el.find(".premium").tooltip("destroy"),this.$el.find(".premium").removeClass("premium"),this.$el.find(".premiumContent").show(),this.$el.find(".nonpremiumContent").hide(),this.model.meta.active_trial?(this.$el.find(".trialContent").show(),this.$el.find(".premiumOnlyContent").hide(),this.$el.find(".trialAndNonpremiumContent").show()):(this.$el.find(".trialContent").hide(),this.$el.find(".premiumOnlyContent").show(),this.$el.find(".trialAndNonpremiumContent").hide())):(this.$el.find(".premium").find("input, textarea, select").toggleClass("ignore",!0),this.$el.find(".premium select option").prop("disabled","disabled"),this.$el.find('.premium input[type="checkbox"]').prop("disabled","disabled"),this.$el.find(".premiumContent").hide(),this.$el.find(".nonpremiumContent").show(),this.$el.find(".trialAndNonpremiumContent").show(),this.$el.find(".trialContent").hide());var e=this,t=["<i class='fa fa-star'></i> Do you like fancy features? Us too! <span class='triggerPremium'>upgrade this plugin</span>","<i class='fa fa-star'></i> This is a Premium feature, why not <span class='triggerPremium' >upgrade</span>","<i class='fa fa-star'></i> Get this feature by <span class='triggerPremium'>upgrading</span>"];e.$el.find(".premium").each(function(){if($(this).data("upgrade-text"))var e=$(this).data("upgrade-text");else var e=t[Math.floor(Math.random()*t.length)];if("wix"==HOST)if($(this).hasClass("add"))var i="right";else var i="top";else var i="bottom";$(this).attr("title",e),$(this).tooltip({title:e,html:!0,placement:i,delay:{hide:100}})}),e.$el.find(".triggerPremium").each(function(){$(this).on("click",function(){$(".navPlans").trigger("click")})})},cycleThroughFeatures:function(){var e=$(".listFeature").hide(),t=0;!function i(){e.eq(t).fadeIn(400).delay(5e3).fadeOut(400,i),t=++t%e.length}()},setDesignPresets:function(){var e=this,t=e.model.get("designPreset");for(var i in DESIGN_PRESETS)if(DESIGN_PRESETS[i].id==t){var n=jQuery.extend(!0,{},DESIGN_PRESETS[i].content);break}debug("Design preset data",n);for(var a in n)this.model.get(a)!=n[a]&&"undefined"!=typeof this.model.defaults()[a]&&(this.model.attributes[a]=n[a],"wix"==HOST&&this.model.has(a+"Wix")&&(this.model.attributes[a+"Wix"]=""));e.model.setPresets(COLOR_PRESETS,FONT_PRESETS),e.render(),e.update(),e.model.trigger("change"),e.model.set({isPreset:!0},{silent:!0}),"wix"==HOST?e.$el.find('[data-tab="tab0"]').click():(e.$el.find("#contentTab").parent("li").toggleClass("active",!1),e.$el.find("#content").toggleClass("active in",!1),e.$el.find("#quickSetupTab").parent("li").toggleClass("active",!0),e.$el.find("#quickSetup").toggleClass("active in",!0)),e.afterSetDesignPresets()},afterSetDesignPresets:function(){},initializeGradientSettings:function(){this.$el.find(".colorSelectionContainer").each(function(){0==$(this).find(".gradientToggle input:checked").length?($(this).find(".gradientColor").hide(),$(this).find(".solidColor").show()):($(this).find(".gradientColor").show(),$(this).find(".solidColor").hide())})},saveModel:function(){this.model.doSave({settings:this})},animateSaveButton:function(){{var e=this,t=e.$el.find(".saveButton");e.$el.find(".saveSuccess"),e.$el.find(".saveError"),e.$el.find(".saving")}t.removeClass("unsaved"),t.addClass("saving"),t.animate({},1e3,function(){t.removeClass("saving")})},updateEmbedCode:function(){var e=this;if(this.model.meta.saved?(debug("Model is saved"),e.$el.find(".appUnsaved").fadeOut("fast",function(){e.$el.find(".appSaved").fadeIn("fast")})):(debug("Model is not saved"),e.$el.find(".appSaved").fadeOut("fast",function(){e.$el.find(".appUnsaved").fadeIn("fast")})),"wix"!=HOST){var t=this.model.meta.id,i=this.model.meta.app_slug,n=this.model.meta.powr_token,a="<script src='"+baseUri()+"/powr.js' powr-token='"+n+"'></script>",r='<div class="powr-'+i+'" label="'+t+'"></div>',o=baseUri()+"/plugins/"+i+"/view?powr_token="+n+"&user_label="+t,s=baseUri()+"/plugins/"+i+"/view?id="+t,l=s+"&mode=page";if("undefined"!=typeof APP_VIEW){var c=APP_VIEW.$el.height()+"px",d='<iframe src="'+o+'" style="width:100%;" height="'+c+'" frameborder="0"></iframe>';$(".embedIframe").val(d)}$(".embedScript").val(a),$(".embedDiv").val(r),$(".embedUrl").val(s),$(".pageEmbedUrl").val(l)}},initializeColorPickers:function(e){var t=this;if("undefined"==typeof e)var e={};var i=setDefault(e.liveUpdate,!0);this.$el.find(".colorSelector").each(function(){var e=$(this);e.spectrum({appendTo:"parent",showAlpha:e.data("alpha"),showInitial:!0,showPalette:!0,showInput:!0,preferredFormat:"hex",clickoutFiresChange:!0,move:function(t){i&&(e.val(t.toRgbString()),e.trigger("change"))},change:function(t){debug("Change detected in spectrum!"),e.val(t.toRgbString()),e.trigger("change")},hide:function(t){e.val(t.toRgbString()),e.hasClass("solidColorSelector")&&e.data("alpha")&&(0==t.getAlpha()?e.parents(".colorSelectionContainer").find(".transparentToggle input").prop("checked",!0):e.parents(".colorSelectionContainer").find(".transparentToggle input").prop("checked",!1)),e.trigger("change")}}),e.hasClass("solidColorSelector")&&e.data("alpha")&&(0==tinycolor(e.val()).getAlpha()?e.parents(".colorSelectionContainer").find(".transparentToggle input").prop("checked",!0):e.parents(".colorSelectionContainer").find(".transparentToggle input").prop("checked",!1))}),"wix"==HOST&&t.$el.find(".wixColorSelectorWrapper").each(function(){var e=$(this),i=$(this).find(".colorSelectorValue"),n=$(this).find(".colorSelectorValueWix");if(!($(this).find(".uilib-color-box").length>0)){var a=i.attr("name"),r=a;if(t.$el.find("[name='"+a+"']").each(function(e){return $(this)[0]==i[0]?(r=a+"_"+e,!1):void 0}),1==i.data("alpha"))var o=!0,s="ColorPickerWithOpacity";else var o=!1,s="ColorPickerWithOpacity";Wix.UI.create({id:r,ctrl:s,param:!1,model:r,html:"",appendTo:e,options:{startWithColor:i.val()}}),o?e.find(".color-box").after("<span class='opacityLabel'>Opacity</span>"):e.find(".uilib-slider").hide(),Wix.UI.onChange(r,function(e){if(debug("Wix color picker change detected: ",e),e.color===!1?n.val(""):e.color&&e.color.reference&&n.val(e.color.reference),e.cssColor){var t=tinycolor(e.cssColor).toRgbString();i.val(t),debug("Css color:",t)}else if(e.rgba){debug("rgba color:",e.rgba);var t=tinycolor(e.rgba).toRgb();void 0!=e.opacity&&(t.a=e.opacity),t=tinycolor(t).toRgbString(),i.val(t),debug("computed rgba color:",t)}i.change()})}})},initializePresets:function(){if(!(_.isEmpty(COLOR_PRESETS)&&_.isEmpty(FONT_PRESETS)&&_.isEmpty(DESIGN_PRESETS))){var e=this.model.get("colorPreset")||Object.keys(COLOR_PRESETS)[0],t=this.model.get("fontPreset")||Object.keys(FONT_PRESETS)[0],i=this.model.get("designPresetCategory")||Object.keys(DESIGN_PRESET_CATEGORIES)[0],n=this.model.get("designPreset");if(void 0==n)if(void 0==i&&DESIGN_PRESETS.length>0)n=DESIGN_PRESETS[0].id;else for(var a in DESIGN_PRESETS)if(DESIGN_PRESETS[a].category==DESIGN_PRESET_CATEGORIES[i].displayName){n=DESIGN_PRESETS[a].id;break}this.model.set({designPreset:n,fontPreset:t,colorPreset:e},{silent:!0}),i&&this.model.set({designPresetCategory:i},{silent:!0}),e&&this.$el.find(".standardTemplates ."+e+"Select").click(),t&&this.$el.find(".standardTemplates ."+t+"Select").click(),i&&this.$el.find(".standardTemplates ."+i+"Select").click(),0==this.$el.find(".standardTemplates .styleSelect, .standardTemplates .paletteSelect").length&&this.createPresetCarousel()}},initializeFontPickers:function(){var e=this,t="https://s3-us-west-1.amazonaws.com/powr/images/blank.png",i=[{value:"Basic",x:0,y:-53},{value:"Caudex",x:0,y:-80},{value:"Chelsea Market",x:0,y:-105},{value:"Corben",x:0,y:-128},{value:"Courier New",x:0,y:-157},{value:"EB Garamond",x:0,y:-183},{value:"Enriqueta",x:0,y:-211},{value:"Forum",x:0,y:-239},{value:"Fredericka the Great",x:0,y:-268},{value:"Georgia",x:0,y:-294},{value:"Impact",x:0,y:-320},{value:"Jockey One",x:0,y:-345},{value:"Josefin Slab",x:0,y:-370},{value:"Jura",x:0,y:-394},{value:"Kelly Slab",x:0,y:-420},{value:"Lobster",x:0,y:-444},{value:"Lucida Console",x:0,y:-467},{value:"Lucida Sans Unicode",x:0,y:-493},{value:"Marck Script",x:0,y:-513},{value:"Mr De Haviland",x:0,y:-538},{value:"Niconne",x:0,y:-558},{value:"Noticia Text",x:0,y:-583},{value:"Open Sans",x:0,y:-604},{value:"Overlock",x:0,y:-628},{value:"Palatino Linotype",x:0,y:-648},{value:"Patrick Hand",x:0,y:-668},{value:"Play",x:0,y:-696},{value:"Sarina",x:0,y:-716},{value:"Signika",x:0,y:-742},{value:"Spinnaker",x:0,y:-766},{value:"Times New Roman",x:0,y:-786},{value:"Verdana",x:0,y:-808}];this.$el.find(".fontSelector").each(function(){$(this).autocomplete({appendTo:e.$el,source:i,minLength:0,select:function(e,t){debug("Font select"),$(e.target).val(t.item.value),$(e.target).blur()},open:function(){$(".ui-autocomplete").append('<a href="//www.powr.io/knowledge-base/using-google-fonts-in-powr-plugins" target="_blank"><li class="googleFontsLink">700 Google Fonts</li></a>')}}).data("uiAutocomplete")._renderItem=function(e,i){return $("<li />").data("item.autocomplete",i).append('<a><img class="fontSprite" src="'+t+'" style="background-position:'+i.x+"px "+i.y+'px;"/></a>').appendTo(e)}}),this.$el.find(".fontSelector").focus(function(){debug("Focused on selector, searching"),$(this).autocomplete("search","")}),"wix"==HOST&&(this.$el.find(".fontSelector").each(function(){void 0!=$(this).val()&&$(this).val(capitalizeFirstLetter($(this).val().split(",")[0]))}),e.$el.find(".wixFontSelectorWrapper").each(function(){var t=$(this),i=$(this).find(".fontSelector"),n=$(this).find(".fontSelectorWix");if(!(t.find(".dropdown").length>0)){var a=i.attr("name"),r=a;e.$el.find("[name='"+a+"']").each(function(e){return $(this)[0]==i[0]?(r=a+"_"+e,!1):void 0}),Wix.UI.create({id:r,ctrl:"FontPicker",param:!1,model:r,html:"",appendTo:t,options:{}});var o=$(this).find('[data-value-extended = "'+i.val()+'"]');if(o.length>0){var s=o.data("index");Wix.UI.set(r,{value:s})}else $(this).find(".dropdown .selected").html('<div class="option selected">'+i.val()+"</div>");Wix.UI.onChange(r,function(e){debug("Wix font selector change detected: ",e);var t=e.index,a=e.cssFontFamily;n.val(t),i.val(a),i.change()})}}))},initializeFontSizePickers:function(){var e=this,t=["8px","10px","12px","14px","16px","18px","20px","22px","24px","26px","28px","30px","32px","34px","36px","38px","40px","44px","48px","52px","56px","60px","70px","80px","90px","100px"];this.$el.find(".fontSizeSelector").each(function(){for(var i=parseInt($(this).data("max-size"))||100,n=0;n<t.length;n++)if(parseInt(t[n])>=i){var a=t.slice(0,n+1);break}$(this).autocomplete({appendTo:e.$el,source:a,minLength:0,focus:function(e,t){$(e.target).val(t.item.value),$(e.target).trigger("change")},select:function(e){$(e.target).blur()}})}),this.$el.find(".fontSizeSelector").focus(function(){debug("Focused on selector, searching"),$(this).autocomplete("search","")}),"wix"==HOST&&e.$el.find(".wixSettingSection .fontSizeWrapper").each(function(){function t(e){debug("Spinner input change detected. Val: "+e),isNaN(e)&&(e=12),parseInt(e)!=parseInt(n.val())&&(n.val(e+"px"),n.change())}var i=$(this),n=$(this).find(".fontSizeValue"),a=$(this).find(".fontSizeSelectorWix");if(!(a.find("input").length>0)){var r=n.attr("name"),o=r;e.$el.find("[name='"+r+"']").each(function(e){return $(this)[0]==n[0]?(o=r+"_"+e,!1):void 0}),Wix.UI.create({id:o,ctrl:"Spinner",param:!1,model:o,html:"",appendTo:i,options:{value:parseInt(n.val()),minValue:8,maxValue:parseInt(n.data("max-size"))||100,size:"default"}}),i.find(".uilib-spinner input").on("keyup",function(e){var i=e.target.value;t(i)}),Wix.UI.onChange(o,function(e){debug("Font size change detected: ",e),t(e)})}})},initializeVideoPickers:function(){this.$el.find(".parsedVideoWrapper").each(function(){var e=$(this).find(".previewUrl").val();$(this).find(".previewImage").attr("src",e)})},initializeDateTimePickers:function(){var e=this,t=$.datepicker._gotoToday;$.datepicker._gotoToday=function(e){t.call(this,e),this._selectDate(e),$(e).blur()},this.$el.find(".datetimeWrapper").each(function(){function t(){var t=i.find(".dateSelector").datepicker("getDate"),n=i.find(".timeSelector").val(),a=new Date;a.setFullYear($.datepicker.formatDate("yy",t)),a.setDate(1),a.setMonth(parseInt($.datepicker.formatDate("m",t))-1),a.setDate($.datepicker.formatDate("d",t)),a.setHours(n.substr(0,2)),a.setMinutes(n.substr(3,2)),a.setSeconds(0);var r=i.find(".datetime").data("use-local-time");if(r)var o=a.toLocaleString();else var o=a.toString();i.find(".datetime").val(o),debug("Datetime string is "+o),e.update()}var i=$(this),n=i.find(".datetime").val();if(0==n.length)var a=new Date;else var a=new Date(n);var r=a.getHours(),o=a.getMinutes();r=Array(3-r.toString().length).join("0")+r,o=Array(3-o.toString().length).join("0")+o;var s=r+":"+o;debug("Parsed time is "+s+"; datetime obj is",a),$(this).find(".dateSelector").datepicker({onSelect:function(){t()},showButtonPanel:!0}),$(this).find(".dateSelector").change(function(){t()}),$(this).find(".dateSelector").datepicker("setDate",a);var l=[{label:"0:00 (12 am)",value:"00:00"},{label:"1:00 (1 am)",value:"01:00"},{label:"2:00 (2 am)",value:"02:00"},{label:"3:00 (3 am)",value:"03:00"},{label:"4:00 (4 am)",value:"04:00"},{label:"5:00 (5 am)",value:"05:00"},{label:"6:00 (6 am)",value:"06:00"},{label:"7:00 (7 am)",value:"07:00"},{label:"8:00 (8 am)",value:"08:00"},{label:"9:00 (9 am)",value:"09:00"},{label:"10:00 (10 am)",value:"10:00"},{label:"11:00 (11 am)",value:"11:00"},{label:"12:00 (12 pm)",value:"12:00"},{label:"13:00 (1 pm)",value:"13:00"},{label:"14:00 (2 pm)",value:"14:00"},{label:"15:00 (3 pm)",value:"15:00"},{label:"16:00 (4 pm)",value:"16:00"},{label:"17:00 (5 pm)",value:"17:00"},{label:"18:00 (6 pm)",value:"18:00"},{label:"19:00 (7 pm)",value:"19:00"},{label:"20:00 (8 pm)",value:"20:00"},{label:"21:00 (9 pm)",value:"21:00"},{label:"22:00 (10 pm)",value:"22:00"},{label:"23:00 (11 pm)",value:"23:00"}];$(this).find(".timeSelector").autocomplete({appendTo:e.$el,source:l,minLength:0,change:function(){t()}}),$(this).find(".timeSelector").val(s),$(this).find(".timeSelector").focus(function(){debug("Focused on selector, searching"),$(this).autocomplete("search","")})})},initializeSliders:function(){this.$el.find(".sliderWrapper").each(function(){var e=$(this).find(".slider"),t=$(this).find(".rangeValue"),i=$(this).find(".rangeDisplay"),n=e.data("measure"),a=e.data("min"),r=e.data("max"),o=e.data("step"),s=e.data("update-on-slide");e.slider({value:$.trim(t.val().replace(n,"")),min:a,max:r,step:o,animate:!0,range:"min",change:function(e,o){debug("Change called, ui: ",o);var s=parseInt(t.val());debug("UI value is "+o.value+"; type is "+typeof o.value),debug("Max is "+r+"; type is "+typeof r),debug("Currentval is "+s+"; type is "+typeof s),debug("Current value is greater than max: "+s>r),o.value==r&&s>r||o.value==a&&a>s||(i.val("pluginWidth"==t.attr("name")&&1e3==o.value?"100%":o.value+n),t.val(o.value+n)),debug("Display el val: "+i.val()+"; input el val: "+t.val()),e.originalEvent&&t.change()},slide:function(e,o){var l=parseInt(t.val());o.value==r&&l>r||o.value==a&&a>l||(i.val("pluginWidth"==t.attr("name")&&1e3==o.value?"100%":o.value+n),t.val(o.value+n)),s&&t.change()},create:function(){}}),i.on("blur",function(){var a=$.trim(i.val());if("pluginWidth"==t.attr("name")&&"100%"==a){a="1000px";var r=1e3}else var r=a.replace(n,"");t.val(a);var o=e.data("step");e.slider("option","step",1e-4),e.slider("value",r),e.slider("option","step",o),t.trigger("change")})}),"wix"==HOST&&this.$el.find(".wixSlider").each(function(){var e=$(this).find("input"),t=parseFloat(e.data("max"))>3?!0:!1;$(this).find(".wixSliderElement").remove(),$(this).append('<div class="wixSliderElement"></div>'),$(this).find(".wixSliderElement").Slider({value:parseFloat(e.val()),minValue:parseFloat(e.data("min")),maxValue:parseFloat(e.data("max")),toolTip:t,width:250,preLabel:"-",postLabel:"+",slide:function(t){isNaN(t)||(e.data("update-on-slide")?(e.val(parseFloat(t)+e.data("measure")),e.change()):("undefined"!=typeof WIX_SLIDER_TIMEOUT&&clearTimeout(WIX_SLIDER_TIMEOUT),WIX_SLIDER_TIMEOUT=setTimeout(function(){e.val(parseFloat(t)+e.data("measure")),e.change()},200)))}})})},afterInitialize:function(){},update:function(){var e=this,t=this.$el.formToObject({ignoreWithParent:".prototype-wrapper",ignoreWithClass:"ignore"});for(var i in t)this.model.get(i)!=t[i]&&("undefined"!=typeof this.model.defaults()[i]||"undefined"!=typeof this.model.defaults()[i.replace("Wix","")])&&(debug("Setting key "+i+" to "+t[i]),this.model.attributes[i]=t[i]);if(this.savePasswordData(),this.afterUpdate(),this.model.set({isPreset:!1},{silent:!0}),this.model.setLocals({isDirty:!0}),this.updateSaveStatus(),debug("App settings updated; model is ",this.model),"wix"==HOST||"weebly"==HOST){this.$el.find(".saveStatus .savingStatus").show(),this.$el.find(".saveStatus .savedStatus").hide(),"undefined"==typeof LAST_AUTO_SAVE&&(LAST_AUTO_SAVE=0);var n=(new Date).getTime();n-LAST_AUTO_SAVE>1e3?(LAST_AUTO_SAVE=n,e.saveModel()):("undefined"!=typeof AUTO_SAVE_TIMER&&clearTimeout(AUTO_SAVE_TIMER),AUTOSAVE_TIMER=setTimeout(function(){e.saveModel()},1e3))}},updateSaveStatus:function(){1==this.model.get("locals").isDirty?this.$el.find(".saveButton").addClass("unsaved"):this.$el.find(".saveButton").removeClass("unsaved")},afterUpdate:function(){},template:function(){var e="#"+this.model.meta.app_namespace+"SettingsTemplate",t=$(e).html();return t},beforeRender:function(){},render:function(){"wix"==HOST&&this.$el.find("*[wix-ctrl]").each(function(){var e=$(this);try{Wix.UI.destroy(e,!0)}catch(t){}});var e=this.model.attributes;debug("App settings rendering; Model is ",e);var t=this.template();this.$el.html(_.template(t,{m:e})),this.$el.objectToForm(e),this.model.meta.alias&&this.$el.find('[name="syncImport"]').prop("checked",!0),this.initializePickers(),this.updateEmbedCode(),this.initializePasswordProtection(),this.initializeFlashSales(),this.afterRender(),this.updateInputFields(),sign_in_update(),this.updatePremiumContent(),this.cycleThroughFeatures(),this.fitText(),this.premiumHoverEffect(),this.initializeInnerTabs(),this.initializeNav(),"wix"==HOST&&this.$el.find('[data-tab="admin"]').on("click",function(){loadAnalytics()})},afterRender:function(){},fitText:function(){fitText(this.$el.find(".fitText"))},initializeSync:function(){var e=this;if(e.model.meta.alias){var t=e.$el.find(".appSummary"+e.model.meta.alias).html();e.$el.find(".syncContent").html("Currently syncing with "+t),e.$el.find(".importSync").slideDown(),e.$el.find(".importExisting").hide()}else e.$el.find(".syncContent").html(""),e.$el.find(".importSync").hide(),e.$el.find(".importExisting").show()},initializeNav:function(){var e=this,t="";if("wix"==HOST);else{this.$el.find(".section").each(function(){var e=$(this).data("label");t+='<a class="tab nav'+e+'" href="#"><span class="hide-sm">'+e+"</span></a>"}),this.$el.find(".nav-tabs").html(t),setTimeout(function(){var t=getURLParameter("tab");if(t){var i=".nav"+capitalizeFirstLetter(t);e.$el.find(".nav-tabs "+i).click()}else e.$el.find(".nav-tabs .tab").first().click()},500);var i=0,n=this.$el.find(".section").length;this.$el.find(".section").each(function(){if(i>0&&$(this).find(".prevSection").css("display","inline-block").data("target-index",i-1),n-1>i){$(this).find(".nextSection").css("display","inline-block").data("target-index",i+1);var t=$(e.$el.find(".section")[i+1]).data("label");$(this).find(".nextSectionText").html(t)}i++}),this.$el.find(".section .nextSection").last().show().toggleClass("openAccessModal",!0).find(".nextSectionText").html("Share")}},initializePickers:function(){this.initializeColorPickers(),this.initializeFontPickers(),this.initializeFontSizePickers(),this.initializeSliders(),this.initializeColorPresets(),this.initializeGradientSettings(),this.initializeTextControls(),this.initializePopovers(),this.initializeDateTimePickers(),this.initializeImagePickers(),this.initializeVideoPickers(),this.initializeValidators(),this.initializeSaveButton(),this.initializeCheckboxes(),this.initializePresets(),this.updatePackagePrice(),this.initializeSync(),"wix"==HOST&&(this.initializeWixDropdowns(),this.initializeWixTabs(),this.initializeWixAccordions(),this.initializeWixCheckboxes(),this.initializeWixAdmin())},initializeWixAdmin:function(){this.$el.find("#admin .acc-pane").hasClass("acc-active")&&(this.$el.find("#admin .acc-pane").removeClass("acc-active"),this.$el.find("#admin .acc-content").css({display:"none",overflow:"visible"}))},updateInputFields:function(){var e=this;$.webshims.polyfill("forms"),this.$el.find("input,textarea,select").updatePolyfill("forms"),this.$el.find(".validate").each(function(){e.validateInput($(this))})},initializeCheckboxes:function(){this.$el.find(".powrCheckbox").each(function(){$(this).prop("checked")?$(this).siblings(".switch").toggleClass("on",!0).toggleClass("off",!1):$(this).siblings(".switch").toggleClass("on",!1).toggleClass("off",!0)})},initializeTextControls:function(e){var t=this;this.$el.find(".textControls").each(function(){if(!($(this).parents(".prototype").length>0||("undefined"==typeof e||0==e)&&$(this).attr("id"))){var i=$(this).parent();i.height(i.height()),setTimeout(function(){i.css({height:"auto"})},1e3),$(this).siblings(".mce-tinymce").remove(),$(this).show();var n=Math.floor(1e7*Math.random()+1);$(this).attr("id",n);var a=$(this).data("height")?parseInt($(this).data("height")):300;if("small"==$(this).data("controls-style"))var r=["formatselect forecolor bold italic underline removeformat alignleft aligncenter alignright alignjustify link powrImage"],o=!1;else var r=["undo redo formatselect forecolor bold italic underline removeformat alignleft aligncenter alignright alignjustify bullist numlist outdent indent link powrImage code"],o=!0;tinymce_editor=tinymce.init({selector:"#"+n,height:a,statusbar:o,toolbar:r,content_css:"/public-assets/tinymce.css",valid_elements:"+*[*]",setup:function(e){e.on("change keyup",function(){"undefined"!=typeof TINYMCE_TIMER&&clearTimeout(TINYMCE_TIMER),TINYMCE_TIMER=setTimeout(function(){debug("change event. content: ",i),$(e.targetElm).trigger("change");var i=e.getContent(),n=$(e.targetElm);n.val(i),t.update()},1e3)}),e.addButton("powrImage",{title:"Image",tooltip:"Insert Image",icon:"mce-ico mce-i-image",onclick:function(){if("wix"==HOST){Wix.Settings.openMediaDialog(Wix.Settings.MediaType.IMAGE,!1,function(t){if(debug("Wix image data from tinymce: ",t),"undefined"==typeof WIX_IMAGE_RESPONSE_LIMITER||!WIX_IMAGE_RESPONSE_LIMITER){WIX_IMAGE_RESPONSE_LIMITER=!0,setTimeout(function(){WIX_IMAGE_RESPONSE_LIMITER=!1
},5e3);var i=t.relativeUri,n=Wix.Utils.Media.getResizedImageUrl(i,800,800);e.focus(),e.selection.setContent('<img src="'+n+'">');var a=e.getContent(),r=$(e.targetElm);r.val(a),r.trigger("change")}})}else{if("undefined"==typeof IMAGE_MANAGER){var i=$("#file-manager-template"),n=_.template(i.html(),{opts:{name:"image",capitalName:"Image",accept:"image/*"}});i.after(n),IMAGE_MANAGER=new imageManager({app_id:t.model.meta.id,el:$("#imageManager")})}IMAGE_MANAGER.show(function(t){if(debug("Response from image manager:",t),t.success){var i=t.images[0].medium_url;e.focus(),e.selection.setContent('<img data-node-image="'+i+'" src="'+i+'">');var n=e.getContent(),a=$(e.targetElm);a.val(n),a.trigger("change")}})}}})},menubar:!1,plugins:"powrLink colorpicker textcolor code"})}})},initializeInnerTabs:function(){},initializeValidators:function(){this.$el.find(".urlValidationWrapper").each(function(){var e=$(this);validateUrl(e)})},initializeWixCheckboxes:function(){var e=this;e.$el.find(".wixCheckbox").each(function(){$(this).find(".checkboxValue").prop("checked")?$(this).find(".uilib-checkbox").toggleClass("checked",!0):$(this).find(".uilib-checkbox").toggleClass("checked",!1)})},initializeWixDropdowns:function(){var e=this;e.$el.find(".wixDropdownWrapper").each(function(){if(!($(this).parents(".prototype").length>0)){var e=($(this),$(this).find(".dropdownValue")),t=$(this).find(".wixElement"),i=e.attr("name"),n=e.data("height")||"auto",a=e.val().length>0?e.val():0;$(this).parents(".prototype-element").length>0&&(i=i+"_"+Math.floor(999999*Math.random()),t.attr("wix-model",i)),Wix.UI.initializePlugin(t[0],{slideTime:50,value:a,height:n}),e.hasClass("ignore")||Wix.UI.onChange(i,function(t){debug("Wix dropdown change detected: ",t),e.val(t.value),e.trigger("change")})}})},initializeWixTabs:function(){this.$el.find(".uilib-tabs").each(function(){Wix.UI.initializePlugin($(this))})},initializeWixAccordions:function(){this.$el.find("[wix-ctrl='Accordion']").each(function(){Wix.UI.initializePlugin($(this))}),this.$el.find(".acc-active.closed").click()},initializeColorPresets:function(){},initializeImagePickers:function(){var e=this,t=$("#file-manager-template"),i=function(){if("undefined"==typeof IMAGE_MANAGER){var i=_.template(t.html(),{opts:{name:"image",capitalName:"Image",accept:"image/*"}});t.after(i),IMAGE_MANAGER=new imageManager({app_id:e.model.meta.id,el:$("#imageManager")})}},n=function(){if("undefined"==typeof FILE_MANAGER){var i=_.template(t.html(),{opts:{name:"file",capitalName:"File",accept:"*",hideUrl:!0}});t.after(i),FILE_MANAGER=createFileManager({app_id:e.model.meta.id,el:$("#fileManager")})}};this.$el.find(".imageInput").each(function(){var e=$(this).find("input").val();e.length>0?($(this).find(".imagePreview").attr("src",imageThumbUrl(e)),$(this).parent(".images").css("background-image","url("+imageThumbUrl(e)+")"),$(this).find(".imagePreview").css("background-image","url("+imageThumbUrl(e)+")"),$(this).find(".addImage i").html(" Replace"),$(this).find(".imageWrapper").show(),$(this).find(".noImage").addClass("hid")):($(this).find(".addImage i").html(" Add Image"),$(this).find(".noImage").removeClass("hid"))}),this.$el.find(".fileInput").each(function(){var e=$(this).find(".fileName").val();e?($(this).find(".existingTitle").html("Current file: "+e),$(this).find(".addFile i").html(" Replace File"),$(this).find(".noImage").addClass("hid")):($(this).find(".addFile i").html(" Add File"),$(this).find(".noImage").removeClass("hid"))}),this.$el.on("click",".addImage, .noImage",function(){if(!$(this).parents(".imageInput").hasClass("premium")){i();var t=$(this),n=t.parents(".imageInput");if("wix"==HOST){var a=t.hasClass("innerImage");Wix.Settings.openMediaDialog(Wix.Settings.MediaType.IMAGE,a,function(i){if(debug("Wix image data: ",i),"undefined"==typeof WIX_IMAGE_RESPONSE_LIMITER||!WIX_IMAGE_RESPONSE_LIMITER)if(WIX_IMAGE_RESPONSE_LIMITER=!0,setTimeout(function(){WIX_IMAGE_RESPONSE_LIMITER=!1},5e3),t.hasClass("innerImage")){debug("Handling inner image");for(var a=0;a<i.length;a++){var r=t.data("free-limit");if(debug("Image el is ",t),debug("Free limit is "+r+"; count is "+t.parents(".imagesWrapper").find(".images:not(.prototype)").length),a>0&&r&&!e.model.meta.premium&&t.parents(".imagesWrapper").find(".images:not(.prototype)").length>=parseInt(r))debug("Skipping for ",i[a]);else{if(a>0){var o=t.parents(".imagesWrapper").addPrototype(null,{speed:"instant"});debug("Wrapperel is ",o),t=o.find(".addImage"),n=o.find(".imageInput")}var s=i[a].relativeUri,l=Wix.Utils.Media.getResizedImageUrl(s,1200,1200);n.find("img").attr("src",l),t.parent(".images").css("background-image","url("+l+")"),t.find("input").val(l),n.find(".imageWrapper input").val(l),n.find(".imageWrapper").fadeIn("fast"),n.find(".addImage i").html(" Replace"),n.find(".noImage").addClass("hid")}}e.update()}else{var s=i.relativeUri,c=Wix.Utils.Media.getResizedImageUrl(s,1200,1200);n.find("img").attr("src",c),n.find("input").val(c),n.find(".imageWrapper").fadeIn("fast"),n.find(".addImage i").html(" Replace"),n.find(".noImage").addClass("hid"),e.update()}})}else IMAGE_MANAGER.show(function(i){if(debug("Response from image manager:",i),i.success)if(t.hasClass("innerImage")){for(var a=0;a<i.images.length;a++){if(a>0){debug("Image count is "+a);var r=t.parents(".imagesWrapper").addPrototype(null,{speed:"instant"});debug("Wrapperel is ",r),t=r.find(".addImage"),n=r.find(".imageInput")}var o=i.images[a].medium_url;n.find("img").attr("src",o),t.parent(".images").css("background-image","url("+o+")"),t.find("input").val(o),n.find(".imageWrapper input").val(o),n.find(".imageWrapper").fadeIn("fast"),n.find(".addImage i").html(" Replace"),n.find(".noImage").addClass("hid")}e.update()}else{var o=i.images[0].medium_url;n.find("img").attr("src",o),t.parent(".images").css("background-image","url("+o+")"),t.find("input").val(o),n.find(".imageWrapper input").val(o),n.find(".imageWrapper").fadeIn("fast"),n.find(".addImage i").html(" Replace"),n.find(".noImage").addClass("hid"),e.update()}})}}),this.$el.on("click",".addFile",function(){if(CURRENT_USER){"wix"==HOST&&e.update(),n();var t=$(this).closest(".fileInput");FILE_MANAGER.show(function(i){if(debug("Response from file manager:",i),i.success){t.find(".fileUrl").val(i.images[0].external_url);var n=i.images[0].file_file_name||i.images[0].external_url.substring(i.images[0].external_url.lastIndexOf("%2F")+3);t.find(".fileName").val(n),t.find(".existingTitle").html("Current file: "+n),t.find(".addFile i").html(" Replace File"),t.find(".noImage").addClass("hid"),e.update()}})}else"wix"==HOST?e.$el.find(".signIn").first().click():$("#sign-in-modal").modal("show")}),this.$el.on("click",".deleteImage",function(){$(this).parents(".imageWrapper").slideUp("fast"),$(this).parents(".imageInput").find("input").val(""),$(this).parents(".imageInput").find(".addImage i").html(" Add Image"),$(this).parents(".imageInput").find(".noImage").removeClass("hid"),e.update()})},initializePopovers:function(){var e=this;return void 0==$(window).popover?void setTimeout(function(){e.initializePopovers()},2e3):(this.$el.find('[data-toggle="tooltip"]').tooltip({html:!0,trigger:"hover"}),this.$el.find('[data-toggle="popover"]:not(.admin)').popover({html:!0,trigger:"hover",delay:{hide:750}}),this.$el.find(".settingsFooter .admin").popover({html:!0,trigger:"click"}),void this.$el.find(".signInPopover").popover({html:!0,trigger:"hover",delay:{hide:750}}))},premiumHoverEffect:function(){var e=this,t=$(".callToAction").css("background-color");e.model.meta.premium||this.$el.find(".premium").hover(function(){$(".callToAction").css("background","#FFF")},function(){$(".callToAction").css("background",t)})},initializeSaveButton:function(){var e=this.$el.find("button.progress-button")[0];void 0!=e&&new ProgressButton(e,{callback:function(e){var t=0,i=setInterval(function(){t=Math.min(t+.1*Math.random(),1),e._setProgress(t),1===t&&(e._stop(1),clearInterval(i))},50)}})}}),_.templateSettings={interpolate:/\{\{=(.+?)\}\}/g,escape:/\{\{-(.+?)\}\}/g,evaluate:/\{\{(.+?)\}\}/g},$(".showCode").prop("readonly",!0),$.webshims.setOptions("basePath","/shims/"),$.webshims.setOptions("waitReady",!1)}),FONT_FUDGE_FACTOR=.012,$(window).load(function(){replaceAffiliates()});